<!DOCTYPE html>
<html lang="zh-CN">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="ctfer" />
  <meta name="author" content="slug01sh" />
  <meta name="description" content="" />
  
  
  <title>
    
      【计算机基础】Java审计基础学习 
      
      
      |
    
     slug01sh
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">


  <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WTRCMZDFLE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WTRCMZDFLE');
    </script>
  

<meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="slug01sh" type="application/atom+xml">
</head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">Oranges</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/categories/">
          <a href="/categories/">Categories</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">Friends</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->

<!-- LaTex Display -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>



  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">【计算机基础】Java审计基础学习</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime" title="更新时间"></i>
          2021-03-25 16:25:00
        </span>
        
              <span class="post-categories">
                <i class="iconfont icon-bookmark" title="分类"></i>
                
                <span class="span--category">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" title="计算机基础">
                    <b>#</b> 计算机基础
                  </a>
                </span>
                
              </span>
          
              <span class="post-tags">
                <i class="iconfont icon-tags" title="标签"></i>
                
                <span class="span--tag">
                  <a href="/tags/Java/" title="Java">
                    <b>#</b> Java
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <p>最近开始尝试进行 Java 代码审计，但是很多 Java 方面的基础概念不太够。开始逐渐补一补 Java 的基础。</p>
<p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210325162534.png"></p>
<h1 id="1-Java-基础"><a href="#1-Java-基础" class="headerlink" title="1 Java 基础"></a>1 Java 基础</h1><h2 id="0x01-Java-SE、Java-EE、Java-ME有何关系？"><a href="#0x01-Java-SE、Java-EE、Java-ME有何关系？" class="headerlink" title="0x01 Java SE、Java EE、Java ME有何关系？"></a>0x01 Java SE、Java EE、Java ME有何关系？</h2><p>简单来说，Java SE就是标准版，包含标准的JVM和标准库，而Java EE是企业版，它只是在Java SE的基础上加上了大量的API和库，以便方便开发Web应用、数据库、消息服务等，Java EE的应用使用的虚拟机和Java SE完全相同。</p>
<p>Java ME就和Java SE不同，它是一个针对嵌入式设备的“瘦身版”，Java SE的标准库无法在Java ME上使用，Java ME的虚拟机也是“瘦身版”。</p>
<p>根本区别：</p>
<ol>
<li>标准库不同</li>
<li>出发点不同。</li>
</ol>
<p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210325192543.png"><br>（图片说明：Java EE&gt;Java SE&gt;Java ME）</p>
<h2 id="0x02-如何寻找合适的-Java-版本？"><a href="#0x02-如何寻找合适的-Java-版本？" class="headerlink" title="0x02 如何寻找合适的 Java 版本？"></a>0x02 如何寻找合适的 Java 版本？</h2><p>有些人说 Java 1.8，有些人说 Java 8.0。如果想要正确的下载 Java 版本，就需要使用到下面的表格：<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210325192952.png"></p>
<h2 id="0x03-JDK-和-JRE-是什么？"><a href="#0x03-JDK-和-JRE-是什么？" class="headerlink" title="0x03 JDK 和 JRE 是什么？"></a>0x03 JDK 和 JRE 是什么？</h2><ul>
<li>JDK：Java Development Kit</li>
<li>JRE：Java Runtime Environment</li>
</ul>
<p>简单地说，JRE就是运行Java字节码的虚拟机（运行 Java 程序的必须条件）。但是，如果只有Java源码，要编译成Java字节码，就需要JDK，因为JDK除了包含JRE，还提供了编译器、调试器等开发工具。</p>
<p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210325193819.png"><br>（图片说明：JDK&gt;JRE&gt;JVM）</p>
<h2 id="0x04-JDK-中可用的命令行工具有哪些？"><a href="#0x04-JDK-中可用的命令行工具有哪些？" class="headerlink" title="0x04 JDK 中可用的命令行工具有哪些？"></a>0x04 JDK 中可用的命令行工具有哪些？</h2><ul>
<li>java：这个可执行程序其实就是JVM，运行Java程序，就是启动JVM，然后让JVM执行指定的编译后的代码；</li>
<li>javac：这是Java的编译器，它用于把Java源码文件（以.java后缀结尾）编译为Java字节码文件（以.class后缀结尾）；</li>
<li>jar：用于把一组.class文件打包成一个.jar文件，便于发布；</li>
<li>javadoc：用于从Java源码中自动提取注释并生成文档；</li>
<li>jdb：Java调试器，用于开发阶段的运行调试。</li>
</ul>
<h2 id="0x05-main-方法为什么那么丑？"><a href="#0x05-main-方法为什么那么丑？" class="headerlink" title="0x05 main 方法为什么那么丑？"></a>0x05 main 方法为什么那么丑？</h2><p> C 语言的 Hello World<br> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// printf() 中字符串需要引号</span></span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p> Java 的 Hello World<br> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>从上面可以看出，Java 的 main 方法前缀太长了。</p>
<p>Java 的一切皆对象的思想贯穿 Java 的整个语言生态，Hello world 也必须要使用类相关的思想。</p>
<p>在面向对象中，所有的函数都必须要使用访问修饰符来进行修饰，这里的 main 必须是共有才能被外部所调用。</p>
<p>如果把函数成员声明为静态的，就可以把函数与类的任何特定对象独立开来。也就是 <code>static</code> 修饰符可以让 main 函数不用创建对象就能被调用（不会违反类的基本特性）。</p>
<p><code>string[] args</code> 就是 Java 中规定的，必须要遵守的，都需要传参。</p>
<h2 id="0x06-Java-如何反序列化？"><a href="#0x06-Java-如何反序列化？" class="headerlink" title="0x06 Java 如何反序列化？"></a>0x06 Java 如何反序列化？</h2><p>对象序列化是指将「内存中保存的对象」以二进制数据流的形式进行处理以便实现对象的传输或储存。摘录一段廖雪峰对于序列化的描述：</p>
<blockquote>
<p>序列化是指把一个 <strong>Java 对象变成二进制内容</strong>，二进制本质上就是一个 byte[] 数组。<br>为什么要把Java对象序列化呢？因为序列化后可以把byte[]保存到文件中，或者把byte[]通过网络传输到远程，这样，就相当于把Java对象存储到文件或者通过网络传输出去了。</p>
</blockquote>
<p>Java 的序列化机制仅适用于 Java，如果需要与其它语言交换数据，必须使用通用的序列化方法，例如 JSON。不过，JSON只输出基本类型（包括String）的内容，而不存储任何与代码相关的信息。</p>
<p>序列化步骤：</p>
<ol>
<li>基本类型，如int，boolean，String（以UTF-8编码）可以使用 <code>ObjectOutputStream.writeObject</code> 函数直接序列化。</li>
<li>Java 类需要实现 Serializable 接口</li>
</ol>
<p>反序列化步骤：</p>
<ol>
<li>使用 <code>ObjectInputStream.readObject</code> 函数进行反序列化</li>
</ol>
<p>下面是一段简单的代码演示如何进行Java对象的序列化以及反序列化。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;serial&quot;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;		<span class="comment">//可以被序列化的Person类</span></span><br><span class="line">	<span class="comment">//如果加上transient关键字的话序列化时会忽略这个属性</span></span><br><span class="line">	<span class="keyword">private</span> String name;		</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**   </span></span><br><span class="line"><span class="comment">	* 创建人的对象</span></span><br><span class="line"><span class="comment">	* <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">	* <span class="doctag">@param</span> age  </span></span><br><span class="line"><span class="comment">	*/</span>  </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;姓名: &quot;</span> + name + <span class="string">&quot;、年龄: &quot;</span> + age;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 所谓的序列化就是二进制数据流的处理</span></span><br><span class="line"><span class="comment">* <span class="doctag">@ClassName</span>: Baby_Serializable  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Author</span>: flo@t</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Baby_Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> File SAVE_FILE = <span class="keyword">new</span> File(<span class="string">&quot;serial.Person&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**  </span></span><br><span class="line"><span class="comment">	* <span class="doctag">@Title</span>: main  </span></span><br><span class="line"><span class="comment">	* <span class="doctag">@Description</span>: 序列化和反序列化的操作可由ObjectOutputStream和ObjectInputStream两个类来实现</span></span><br><span class="line"><span class="comment">	* ObjectOutputStream: 是OutputStream子类，接受一个OutputStream类对象</span></span><br><span class="line"><span class="comment">	* ObjectInputStream: 是InputStream子类，接受一个InputStream类对象</span></span><br><span class="line"><span class="comment">	* 序列化方法：writeObject()</span></span><br><span class="line"><span class="comment">	* 反序列化方法：readObject()</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		saveObject(<span class="keyword">new</span> Person(<span class="string">&quot;小米&quot;</span>, <span class="number">18</span>));			<span class="comment">//序列化</span></span><br><span class="line">		System.out.println(loadObject());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span>  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">saveObject</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ObjectOutputStream os = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(SAVE_FILE));</span><br><span class="line">		os.writeObject(obj);  		<span class="comment">//序列化</span></span><br><span class="line">		os.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">loadObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(SAVE_FILE));</span><br><span class="line">		Object obj = ois.readObject();		<span class="comment">//反序列化</span></span><br><span class="line">		ois.close();</span><br><span class="line">		<span class="keyword">return</span> obj;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x07-如何利用-Java-反序列化进行攻击？"><a href="#0x07-如何利用-Java-反序列化进行攻击？" class="headerlink" title="0x07 如何利用 Java 反序列化进行攻击？"></a>0x07 如何利用 Java 反序列化进行攻击？</h2><p>在 PHP 和 Python 中在反序列化和序列化时都会有魔法方法进行调用。那 Java 中有哪些“魔法方法”？</p>
<ul>
<li><strong>writeObject</strong>：序列化时调用。</li>
<li>writeReplace：允许开发者提供一个替代对象来取代原来将被序列化的对象。</li>
<li>readObjectNoData：如果我们希望当接到的序列化流不满足我们想反序列化的类的时候，能自动进行一些状态初始化，那么我们就要提供 readObjectNoData 方法</li>
<li><strong>readObject</strong>：反序列化时调用。</li>
<li>readResolve：用来在反序列化的时候用你选择的对象来替代原本反序列化出来的对象。</li>
<li>validateObject：对某些字段进行校验，validateObject 方法会在我们在 readObject 方法里调用。</li>
</ul>
<p>常见的魔法方法为 writeObject 和 readObject，如果黑客将恶意代码嵌入 readObject 方法中，再将序列化后的代码发送给服务器，就会导致服务器在反序列化的过程中执行恶意代码。</p>
<blockquote>
<p>注意⚠️：反序列化时，由JVM直接构造出Java对象，不调用构造方法，构造方法内部的代码，在反序列化时根本不可能执行。  </p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 自定义的序列化与反序列化操作</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span> Defined_Serializable.java  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Package</span> io_Opt  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> flo@t</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019年9月3日  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="keyword">package</span> io_Opt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;serial&quot;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String brand;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> cost;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**   </span></span><br><span class="line"><span class="comment">	* <span class="doctag">@param</span> brand</span></span><br><span class="line"><span class="comment">	* <span class="doctag">@param</span> cost</span></span><br><span class="line"><span class="comment">	*/</span>  </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">(String brand, <span class="keyword">int</span> cost)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.brand = brand;</span><br><span class="line">		<span class="keyword">this</span>.cost = cost;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;品牌: &quot;</span> + brand + <span class="string">&quot;、售价: &quot;</span> + cost;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(ObjectInputStream in)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			in.defaultReadObject();</span><br><span class="line">			System.out.println(<span class="string">&quot;Read Object Over&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(ObjectOutputStream out)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			out.defaultWriteObject();</span><br><span class="line">			System.out.println(<span class="string">&quot;Write Object Over&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 进行自定义的Java序列化与反序列化</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: Baby_Serializable  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: flo@t</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Defined_Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> File SAVE_FILE = <span class="keyword">new</span> File(<span class="string">&quot;serial.Car&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**  </span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Title</span>: main  </span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Car car = <span class="keyword">new</span> Car(<span class="string">&quot;奔驰&quot;</span>, <span class="number">200000</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(car.toString());</span><br><span class="line">		</span><br><span class="line">		saveObject(car);</span><br><span class="line">		</span><br><span class="line">		Car myCar = (Car) loadObject();</span><br><span class="line">		System.out.println(myCar.toString());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">saveObject</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ObjectOutputStream os = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(SAVE_FILE));</span><br><span class="line">		os.writeObject(obj);  		<span class="comment">//序列化</span></span><br><span class="line">		os.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">loadObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(SAVE_FILE));</span><br><span class="line">		Object obj = ois.readObject();		<span class="comment">//反序列化</span></span><br><span class="line">		ois.close();</span><br><span class="line">		<span class="keyword">return</span> obj;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x08-File-对象和-ByteArrayOutputStream-对象的区别与联系"><a href="#0x08-File-对象和-ByteArrayOutputStream-对象的区别与联系" class="headerlink" title="0x08 File 对象和 ByteArrayOutputStream 对象的区别与联系"></a>0x08 File 对象和 ByteArrayOutputStream 对象的区别与联系</h2><p>在反序列化前，通常会创建 ByteArrayOutputStream 类或者 File 类来存储序列化后的数据。</p>
<p>ByteArrayOutputStream 是一种 Java 字节型输出流。<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210327173652.png"><br>（图片说明：Java 中的 IO 流思维导图）</p>
<p>ByteArrayOutputStream 既然是输出流，为什么在运行时没有创建文件呢？我查看了一下这个类的源码，原来这个类在初始化时，创建了一个长度为 32 的 byte[] 数组。<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210327174709.png"><br>（图片说明：ByteArrayOutputStream 的构造函数）</p>
<p>OutputStream 并非像文章《<a target="_blank" rel="noopener" href="https://www.javazhiyin.com/46874.html">你真的会用Java io流吗？</a>》所说的那样：</p>
<blockquote>
<p>将数据从外存中读取到内存中的称为输入流，将数据从内存写入外存中的称为输出流。</p>
</blockquote>
<p>我认为输入流和输出流只相当于一个通道，输入流堵住了出口，输出流堵住了入口，和存储方式没有关系。（那篇文章挺通熟易懂的，建议阅读）输出流类可以作为一个二进制数组保存相关的数据作为中转。</p>
<p>File类是用来操作文件和目录的，主要是将二进制数据写入文件，真正保存二进制数据的是FileOutputStream类和ByteArrayOutputStream类。</p>
<h2 id="0x09-java中extends和implements的区别"><a href="#0x09-java中extends和implements的区别" class="headerlink" title="0x09 java中extends和implements的区别"></a>0x09 java中extends和implements的区别</h2><p>一个是继承，一个是实现接口。</p>
<p>继承这个可以理解为继承父类的方法，父类中的方法可以在子类中用到，super()。</p>
<p>实现接口就是在接口中定义了方法，这个方法要你自己去实现，接口可以看作一个标准，比如定义了一个动物的接口，它里面有吃（eat()）这个方法，你就可以实现这个方法implements，这个方法是自己写，可以是吃苹果，吃梨子，香蕉，或者其他的。IMPLEMENTS就是具体实现这个接口。</p>
<h1 id="2-网络编程"><a href="#2-网络编程" class="headerlink" title="2 网络编程"></a>2 网络编程</h1><h2 id="0x01-RMI-是什么？"><a href="#0x01-RMI-是什么？" class="headerlink" title="0x01 RMI 是什么？"></a>0x01 RMI 是什么？</h2><p>RMI 是 Remote Method Invocation 的缩写，也就是远程方法调用，是一种运行机制。</p>
<p>远程方法调用 RMI（Remote Method Invocation），是允许运行在一个Java 虚拟机的对象调用运行在另一个 Java 虚拟机上的对象的方法。 这两个虚拟机可以是运行在相同计算机上的不同进程中，也可以是运行在网络上的不同计算机中。</p>
<p>与 RMI 非常相似的还有 RPC（Remote Process Call），即远程过程调用。</p>
<ul>
<li>RMI：调用另一台计算机上 JVM 中的方法。只适用于 Java，无法跨语言。<strong>是 JDK 1.2 引入的一套 Java 自带 RPC 实现方案。</strong>。（简而言之，RMI 是一种 RPC）</li>
<li>RPC：调用另一台计算机上的服务（具体的程序）。是网络服务协议，与操作系统和语言无关。</li>
</ul>
<p>执行流程：<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210325170241.png"></p>
<ul>
<li>Registry（注册表）是放置所有服务器对象的命名空间。 每次服务端创建一个对象时，它都会使用 bind() 或 rebind() 方法注册该对象。 这些是使用称为绑定名称的唯一名称注册的。</li>
<li>要调用远程对象，客户端需要该对象的引用。即通过服务端绑定的名称从注册表中获取对象（lookup() 方法。</li>
</ul>
<p>实现RMI：</p>
<ol>
<li>Warehouse.java<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span>: Warehouse.java</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Package</span> warehouse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 仓库的远程接口。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> flo@t</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019年8月25日</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: Warehouse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: flo@t</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 远程服务的接口定义中必须要继承Remote接口。这个接口中啥方法都没定义，应该是表示一种能力</span></span><br><span class="line"><span class="comment"> * 官方描述：</span></span><br><span class="line"><span class="comment"> *  ......Any object that is a remote object must directly or indirectly implement this interface.....</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Warehouse</span> <span class="keyword">extends</span> <span class="title">Remote</span> </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 用于查询指定商品的价格</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Title</span>: getPrice</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@author</span>: flo@t</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> description</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@throws</span> RemoteException</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getPrice</span><span class="params">(String description)</span> <span class="keyword">throws</span> RemoteException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>WarehouseImpl.java<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span>: WarehouseImpl.java</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Package</span> warehouse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 服务器端来实现在远程接口中声明的工作。该类是远程方法调用的目标，因为扩展了UnicastRemoteObject类。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> flo@t</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019年8月25日</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> V1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.*;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实现 remote Warehouse的接口。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: WarehouseImpl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: flo@t</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 补充：RMI的一个特点是服务的接口定义和其实现是分开的</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * UnicastRemoteObject类的定义：</span></span><br><span class="line"><span class="comment"> * public class UnicastRemoteObject extends RemoteServer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * public abstract class RemoteServer extends RemoteObject</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * public abstract class RemoteObject implements Remote, java.io.Serializable</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;serial&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarehouseImpl</span> <span class="keyword">extends</span> <span class="title">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title">Warehouse</span> </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 定义一个键值对集合用于存放商品价格及其他信息</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Double&gt; prices;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 构造方法</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@author</span> flo@t</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">WarehouseImpl</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">    <span class="comment">//创建一个Map对象并存入存入数据</span></span><br><span class="line">    prices = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    prices.put(<span class="string">&quot;Toaster&quot;</span>, <span class="number">24.5</span>);</span><br><span class="line">    prices.put(<span class="string">&quot;water&quot;</span>, <span class="number">2.0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 接受用户要查询的商品的名称，返回商品的价格</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">(String description)</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">    Double price = prices.get(description);</span><br><span class="line">    <span class="keyword">return</span> price == <span class="keyword">null</span> ? <span class="number">0</span> : price;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>WarehouseServer.java<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Title</span>: WarehouseServer.java  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Package</span> warehouse  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Description</span>: 直接构造并且注册一个WarehouseImpl对象</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> flo@t</span></span><br><span class="line"><span class="comment">* <span class="doctag">@date</span> 2019年8月25日  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@version</span> V1.0  </span></span><br><span class="line"><span class="comment">*/</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@ClassName</span>: WarehouseServer  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Description</span>: 实例化WarehouseImpl对象，并用naming service来将它注册，并等待客户端来调用</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span>: flo@t</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarehouseServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**  </span></span><br><span class="line"><span class="comment">	 * 使用LocateRegistry和Naming两个类来完成一个简单的RMI Demo</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Title</span>: main  </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Description</span>: </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@author</span> flo@t</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RemoteException </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> NamingException </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.print(<span class="string">&quot;Constructing server implemention...&quot;</span>);</span><br><span class="line">			WarehouseImpl centralWarehouse = <span class="keyword">new</span> WarehouseImpl();</span><br><span class="line">			System.out.println(<span class="string">&quot;Ok&quot;</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment">			 * LocateRegistry is used to obtain a reference to a bootstrap</span></span><br><span class="line"><span class="comment">			 * remote object registry on a particular host (including the local host), or</span></span><br><span class="line"><span class="comment">			 * to create a remote object registry that accepts calls on a specific port.</span></span><br><span class="line"><span class="comment">			 */</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">//创建远程对象的注册表，指明其服务的端口。</span></span><br><span class="line">			LocateRegistry.createRegistry(<span class="number">8888</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//Sets the system property indicated by the specified key.设置系统属性</span></span><br><span class="line">			System.setProperty(<span class="string">&quot;rmi:central_warehouse&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);		</span><br><span class="line">			<span class="comment">//这里前面的键值对的键名可以去掉&quot;rmi&quot;(实测)，为了区别还是加上吧</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">//绑定远程对象到注册表，这里的&quot;rmi://&quot;必须要加上，提供一个URL来访问你的远程对象</span></span><br><span class="line">			System.out.print(<span class="string">&quot;Binding server implemention to registry...&quot;</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//The Naming class provides methods for storing and obtaining references to remote objects in a remote object registry. </span></span><br><span class="line">			Naming.bind(<span class="string">&quot;rmi://localhost:8888/central_warehouse&quot;</span>, centralWarehouse);</span><br><span class="line">			System.out.println(<span class="string">&quot;Ok&quot;</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//等待客户端的连接</span></span><br><span class="line">			System.out.println(<span class="string">&quot;waiting for invocations from clients&quot;</span>);		</span><br><span class="line">		</span><br><span class="line">		&#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;创建远程对象发生异常&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (AlreadyBoundException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;发生重复绑定对象异常&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;发生URL畸形异常&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>WarehouseClient.java<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Title</span>: WarehouseClient.java  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Package</span> warehouse  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@Description</span>: 客户端获取指定服务器和远程对象的名字</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> flo@t</span></span><br><span class="line"><span class="comment">* <span class="doctag">@date</span> 2019年8月25日  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@version</span> V1.0  </span></span><br><span class="line"><span class="comment">*/</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.NotBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@ClassName</span>: WarehouseClient  </span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span>: flo@t</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Description</span>: 客户端实现远程调用方法</span></span><br><span class="line"><span class="comment">*    </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarehouseClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**  </span></span><br><span class="line"><span class="comment">	* <span class="doctag">@Title</span>: main  </span></span><br><span class="line"><span class="comment">	* <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment">	* <span class="doctag">@author</span>: flo@t</span></span><br><span class="line"><span class="comment">	* <span class="doctag">@param</span> args </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> NamingException </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RemoteException </span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//获得指定主机和指定端口上的注册表对象</span></span><br><span class="line">			Registry registry = LocateRegistry.getRegistry(<span class="string">&quot;localhost&quot;</span>,<span class="number">8888</span>);</span><br><span class="line">			<span class="comment">//Returns a reference to the remote object Registry on the specified host and port.</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">//返回的是Remote接口类型，这里进行一个向下的转型</span></span><br><span class="line">			Warehouse centralWarehouse = (Warehouse) registry.lookup(<span class="string">&quot;central_warehouse&quot;</span>);	</span><br><span class="line">			String descr = <span class="string">&quot;Toaster&quot;</span>;</span><br><span class="line">			<span class="keyword">double</span> price = centralWarehouse.getPrice(descr);</span><br><span class="line">			System.out.println(descr + <span class="string">&quot;: &quot;</span> + price);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (NotBoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
使用 WarehouseClient.java 的运行结果：<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210401143757.png"><br>成功调用 getPrice 方法获取到 24.5。</li>
</ol>
<p>下面给出RMI工作的流程图:<br><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210401143901.png"></p>
<ul>
<li>服务器：将实例化后的对象绑定在注册表中，并等待客户端的调用。</li>
<li>客户端：使用lookup方法获取对象的引用，<strong>客户端所得到的结果实际上是在服务端那里执行完成的，服务端只是将这个结果返回给了请求者</strong>。<blockquote>
<p>疑问🤔️：那恶意代码挂载在自己服务器，是怎么反弹shell的呢？迷惑</p>
</blockquote>
</li>
</ul>
<h2 id="0x02-LDAP-是什么？"><a href="#0x02-LDAP-是什么？" class="headerlink" title="0x02 LDAP 是什么？"></a>0x02 LDAP 是什么？</h2><p>LDAP 是 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%9B%AE%E5%BD%95%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE">轻量目录访问协议</a>，英文全称是 Lightweight Directory Access Protocol。简单来说， 是一个为查询、浏览和搜索而优化的专业分布式数据库，它成树状结构组织数据，就好像 Linux/Unix 系统中的文件目录一样。</p>
<p>LDAP以树结构标识所以不能像表格一样用SQL语句查询，它“读”性能很强，但“写”性能较差，并且没有事务处理、回滚等复杂功能，不适于存储修改频繁的数据。</p>
<p>LDAP可以绑定对象，实现远程方法调用。</p>
<h2 id="0x03-RMI-和-LDAP-的区别和联系"><a href="#0x03-RMI-和-LDAP-的区别和联系" class="headerlink" title="0x03 RMI 和 LDAP 的区别和联系"></a>0x03 RMI 和 LDAP 的区别和联系</h2><p>在使用 marshalsec 时，需要选择不同的协议 RMI 或 LDAP，但是又不太理解这两种方法的区别。这里摘录一下其他大佬博客对于这个的理解：<a target="_blank" rel="noopener" href="https://lzwgiter.github.io/Java%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E4%B8%8EJNDI%E6%B3%A8%E5%85%A5(%E4%B8%8A)/#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8EJNDI%E6%B3%A8%E5%85%A5%E5%92%8CRMI">传送门</a></p>
<blockquote>
<p>简单来说的话，大家应该都清楚RPC(Remote Procedure Call)的作用，RMI相当于就是Java版本的RPC，可以实现远程对一个实例化的对象的使用；而JNDI的作用提供了一组通用的接口可供应用很方便地去访问不同的后端服务，例如 LDAP、RMI、CORBA等。在Java中为了能够更方便的管理、访问和调用远程的资源对象，常常会使用 LDAP和RMI等服务来将资源对象或方法绑定在固定的远程服务端，供应用程序来进行访问和调用。</p>
</blockquote>
<p>简而言之，LDAP和RMI都可以绑定对象，进而实现远程方法调用。</p>
<h2 id="0x04-RMP-是什么？"><a href="#0x04-RMP-是什么？" class="headerlink" title="0x04 RMP 是什么？"></a>0x04 RMP 是什么？</h2><h2 id="0x05-JDNI-是什么？"><a href="#0x05-JDNI-是什么？" class="headerlink" title="0x05 JDNI 是什么？"></a>0x05 JDNI 是什么？</h2><p>JNDI即Java Naming and Directory Interface，就是一组在Java应用中访问命名与服务的API。为开发人员查找和访问资源提供了统一的通用接口，可以用来定位网络 机器 用户 对象等各种资源。JNDI底层提供了很多实现方式，有RMI LDAP CORBA等，这些服务器注册的服务可以通过JNDI提供的一个统一外部接口去访问调用。</p>
<ul>
<li>Java Naming：键值对的绑定，应用程序可通过键检索值</li>
<li>Java Directory：是对Java Naming的补充扩张。差别为Java Directory可以根据属性搜索对象。在目录服务中，JNDI允许访问文件系统中的文件，绑定在RMI服务器的对象，LDAP服务与其他组件。</li>
</ul>
<p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210401125932.png"></p>
<p>JNDI将名字与对象绑定，可以通过名字检索存储在RMI、LDAP服务器上的对象，所以提供了绑定与检索方法。</p>
<p>JNDI与RMI的关系可以理解为，JDBC和MySQL Driver的关系。</p>
<h2 id="0x07-SPI是什么？"><a href="#0x07-SPI是什么？" class="headerlink" title="0x07 SPI是什么？"></a>0x07 SPI是什么？</h2><p>SPI是Service Provider Interface的缩写，是JDK内置的服务发现协议。</p>
<p>SPI是一种动态替换发现的机制， 比如有个接口，想运行时动态的给它添加实现，你只需要添加一个实现。我们经常遇到的就是java.sql.Driver接口，其他不同厂商可以针对同一接口做出不同的实现，mysql和postgresql都有不同的实现提供给用户，而Java的SPI机制可以为某个接口寻找服务实现。</p>
<p><img src="https://blog-1256032382.cos.ap-nanjing.myqcloud.com/img/20210401131153.png"></p>
<p>也就是一种典型的面向接口编程，让程序的鲁棒性和可拓展性更高。</p>
<p>问题6中的JDNI SPI也就是一个接口，可以连接LDAP和RMI等服务。</p>
<h2 id="0x06-为什么-Java-反序列化时和上面的各种协议紧密关联？"><a href="#0x06-为什么-Java-反序列化时和上面的各种协议紧密关联？" class="headerlink" title="0x06 为什么 Java 反序列化时和上面的各种协议紧密关联？"></a>0x06 为什么 Java 反序列化时和上面的各种协议紧密关联？</h2><h2 id="0x04-marshalsec-的原理是什么？"><a href="#0x04-marshalsec-的原理是什么？" class="headerlink" title="0x04 marshalsec 的原理是什么？"></a>0x04 marshalsec 的原理是什么？</h2><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="附录"><a href="#附录" class="headerlink" title="#附录"></a>#附录</h1><p>参考教程：</p>
<ol>
<li>Java RMI远程方法调用详解：<a target="_blank" rel="noopener" href="https://blog.csdn.net/guyuealian/article/details/51992182">https://blog.csdn.net/guyuealian/article/details/51992182</a></li>
<li>总结：详解RMI与RPC的区别：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/50678735">https://zhuanlan.zhihu.com/p/50678735</a></li>
<li>RMI实现RPC：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u014565127/article/details/113583536">https://blog.csdn.net/u014565127/article/details/113583536</a></li>
<li>java ldap：<a target="_blank" rel="noopener" href="https://blog.csdn.net/bobbykey/article/details/88966040">https://blog.csdn.net/bobbykey/article/details/88966040</a></li>
<li>系统工具 | LDAP 使用教程篇：<a target="_blank" rel="noopener" href="https://aiden-dong.github.io/2019/05/08/Ldap%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">https://aiden-dong.github.io/2019/05/08/Ldap%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</a></li>
<li>Java教程 - 廖雪峰的官方网站：<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1252599548343744">https://www.liaoxuefeng.com/wiki/1252599548343744</a></li>
<li>Java 反序列化漏洞与JNDI注入(上)：<a target="_blank" rel="noopener" href="https://lzwgiter.github.io/Java%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E4%B8%8EJNDI%E6%B3%A8%E5%85%A5(%E4%B8%8A)/">https://lzwgiter.github.io/Java%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E4%B8%8EJNDI%E6%B3%A8%E5%85%A5(%E4%B8%8A)/</a></li>
<li>【原创】（译）Java 序列化魔法方法及使用示例：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903936672038920#heading-0">https://juejin.cn/post/6844903936672038920#heading-0</a></li>
<li>Jedis存储Java对象–Java序列化为byte数组方式：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/linjiqin/archive/2013/05/29/3105608.html">https://www.cnblogs.com/linjiqin/archive/2013/05/29/3105608.html</a></li>
<li>Java基础：IO流之字节流和字符流：<a target="_blank" rel="noopener" href="https://blog.csdn.net/axi295309066/article/details/52820203">https://blog.csdn.net/axi295309066/article/details/52820203</a></li>
<li>你真的会用Java io流吗？：<a target="_blank" rel="noopener" href="https://www.javazhiyin.com/46874.html">https://www.javazhiyin.com/46874.html</a></li>
<li>JNDI注入入门：<a target="_blank" rel="noopener" href="https://p0rz9.github.io/2019/05/05/JNDI%E6%B3%A8%E5%85%A5%E5%85%A5%E9%97%A8/">https://p0rz9.github.io/2019/05/05/JNDI%E6%B3%A8%E5%85%A5%E5%85%A5%E9%97%A8/</a></li>
<li>java中extends和implements的区别，怎么用？：<a target="_blank" rel="noopener" href="https://my.oschina.net/yongqingfan/blog/531166">https://my.oschina.net/yongqingfan/blog/531166</a></li>
<li>java远程调用之RMI（终于可以自己写代码控制别人电脑了）：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/80686193">https://zhuanlan.zhihu.com/p/80686193</a></li>
</ol>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/3aae222bb2c3/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>上一页</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime" title="更新时间"></i>
              2021-03-25 16:25:00
            </span>
            
                  <span class="post-categories">
                    <i class="iconfont icon-bookmark" title="分类"></i>
                    
                    <span class="span--category">
                      <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" title="计算机基础">
                        <b>#</b> 计算机基础
                      </a>
                    </span>
                    
                  </span>
              
                  <span class="post-tags">
                    <i class="iconfont icon-tags" title="标签"></i>
                    
                    <span class="span--tag">
                      <a href="/tags/Java/" title="Java">
                        <b>#</b> Java
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
              <a href="/d1b122c9a430/" target="_self">
                <span>下一页</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">目录</div>
    <div class="catalog-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Java-%E5%9F%BA%E7%A1%80"><span class="toc-text">1 Java 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-Java-SE%E3%80%81Java-EE%E3%80%81Java-ME%E6%9C%89%E4%BD%95%E5%85%B3%E7%B3%BB%EF%BC%9F"><span class="toc-text">0x01 Java SE、Java EE、Java ME有何关系？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E5%A6%82%E4%BD%95%E5%AF%BB%E6%89%BE%E5%90%88%E9%80%82%E7%9A%84-Java-%E7%89%88%E6%9C%AC%EF%BC%9F"><span class="toc-text">0x02 如何寻找合适的 Java 版本？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-JDK-%E5%92%8C-JRE-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">0x03 JDK 和 JRE 是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-JDK-%E4%B8%AD%E5%8F%AF%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-text">0x04 JDK 中可用的命令行工具有哪些？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-main-%E6%96%B9%E6%B3%95%E4%B8%BA%E4%BB%80%E4%B9%88%E9%82%A3%E4%B9%88%E4%B8%91%EF%BC%9F"><span class="toc-text">0x05 main 方法为什么那么丑？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-Java-%E5%A6%82%E4%BD%95%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%9F"><span class="toc-text">0x06 Java 如何反序列化？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8-Java-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9B%E8%A1%8C%E6%94%BB%E5%87%BB%EF%BC%9F"><span class="toc-text">0x07 如何利用 Java 反序列化进行攻击？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-File-%E5%AF%B9%E8%B1%A1%E5%92%8C-ByteArrayOutputStream-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB"><span class="toc-text">0x08 File 对象和 ByteArrayOutputStream 对象的区别与联系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-java%E4%B8%ADextends%E5%92%8Cimplements%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">0x09 java中extends和implements的区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B"><span class="toc-text">2 网络编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-RMI-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">0x01 RMI 是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-LDAP-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">0x02 LDAP 是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-RMI-%E5%92%8C-LDAP-%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB"><span class="toc-text">0x03 RMI 和 LDAP 的区别和联系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-RMP-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">0x04 RMP 是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-JDNI-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">0x05 JDNI 是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-SPI%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">0x07 SPI是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-%E4%B8%BA%E4%BB%80%E4%B9%88-Java-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%97%B6%E5%92%8C%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%90%84%E7%A7%8D%E5%8D%8F%E8%AE%AE%E7%B4%A7%E5%AF%86%E5%85%B3%E8%81%94%EF%BC%9F"><span class="toc-text">0x06 为什么 Java 反序列化时和上面的各种协议紧密关联？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-marshalsec-%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">0x04 marshalsec 的原理是什么？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text"></span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-text">#附录</span></a></li></ol>
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        





      </div>
    
  </div>


        <div class="footer">
  <div class="social">
    <ul>
      
        <li>
          <a title="github" target="_blank" rel="noopener" href="https://github.com/slug01sh">
            <i class="iconfont icon-github"></i>
          </a>
        </li>
      
        <li>
          <a title="email" href="mailto:slug01sh@gmail.com">
            <i class="iconfont icon-envelope"></i>
          </a>
        </li>
      
        <li>
          <a title="rss" href="/atom.xml">
            <i class="iconfont icon-rss"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Copyright © Oranges 2021</a>
        
    </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
</div>

      </div>

      <div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



      
  <div class="search-icon" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="搜索...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>未找到search.xml文件，具体请参考：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>请求失败，尝试重新刷新页面或稍后重试。<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




    </div>
  </body>
</html>
